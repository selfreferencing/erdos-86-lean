        -- M = 39 subcases via Lemma D.6
        by_cases hp39_19 : p % 39 = 19
        · -- p ≡ 19 (mod 39): (α=5, r=2, s=1), M = 4·5·1·2 - 1 = 39
          -- offset = (p+20)/39, b = 10, c = 10·(2 * p + 1)/39
          have hdiv39a : 39 ∣ (p + 20) := by omega
          have hdiv39b : 39 ∣ (2 * p + 1) := by omega
          refine ⟨(p + 20) / 39, 10, 10 * ((2 * p + 1) / 39), ?_, by norm_num, ?_, ?_⟩
          · have : p % 312 = 97 := by omega
            have h39div : (p + 20) / 39 * 39 = p + 20 := Nat.div_mul_cancel hdiv39a
            omega
          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
          · set δ := (p + 20) / 39 with hδ_def
            set c₀ := (2 * p + 1) / 39 with hc₀_def
            have hδ_mul : δ * 39 = p + 20 := Nat.div_mul_cancel hdiv39a
            have hc₀_mul : c₀ * 39 = 2 * p + 1 := Nat.div_mul_cancel hdiv39b
            have hδ_int : (↑δ : ℤ) * 39 = ↑p + 20 := by exact_mod_cast hδ_mul
            have hc₀_int : (↑c₀ : ℤ) * 39 = 2 * ↑p + 1 := by exact_mod_cast hc₀_mul
            push_cast
            nlinarith [hδ_int, hc₀_int]
        · by_cases hp39_31 : p % 39 = 31
          · -- p ≡ 31 (mod 39): (α=2, r=5, s=1), M = 4·2·1·5 - 1 = 39
            -- offset = (p+8)/39, b = 10, c = 10·(5 * p + 1)/39
            have hdiv39a : 39 ∣ (p + 8) := by omega
            have hdiv39b : 39 ∣ (5 * p + 1) := by omega
            refine ⟨(p + 8) / 39, 10, 10 * ((5 * p + 1) / 39), ?_, by norm_num, ?_, ?_⟩
            · have : p % 312 = 265 := by omega
              have h39div : (p + 8) / 39 * 39 = p + 8 := Nat.div_mul_cancel hdiv39a
              omega
            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
            · set δ := (p + 8) / 39 with hδ_def
              set c₀ := (5 * p + 1) / 39 with hc₀_def
              have hδ_mul : δ * 39 = p + 8 := Nat.div_mul_cancel hdiv39a
              have hc₀_mul : c₀ * 39 = 5 * p + 1 := Nat.div_mul_cancel hdiv39b
              have hδ_int : (↑δ : ℤ) * 39 = ↑p + 8 := by exact_mod_cast hδ_mul
              have hc₀_int : (↑c₀ : ℤ) * 39 = 5 * ↑p + 1 := by exact_mod_cast hc₀_mul
              push_cast
              nlinarith [hδ_int, hc₀_int]
          · by_cases hp39_34 : p % 39 = 34
            · -- p ≡ 34 (mod 39): (α=2, r=1, s=5), M = 4·2·5·1 - 1 = 39
              -- offset = (p+200)/39, b = 10, c = 2·(p + 5)/39
              have hdiv39a : 39 ∣ (p + 200) := by omega
              have hdiv39b : 39 ∣ (p + 5) := by omega
              refine ⟨(p + 200) / 39, 10, 2 * ((p + 5) / 39), ?_, by norm_num, ?_, ?_⟩
              · have : p % 312 = 73 := by omega
                have h39div : (p + 200) / 39 * 39 = p + 200 := Nat.div_mul_cancel hdiv39a
                omega
              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
              · set δ := (p + 200) / 39 with hδ_def
                set c₀ := (p + 5) / 39 with hc₀_def
                have hδ_mul : δ * 39 = p + 200 := Nat.div_mul_cancel hdiv39a
                have hc₀_mul : c₀ * 39 = p + 5 := Nat.div_mul_cancel hdiv39b
                have hδ_int : (↑δ : ℤ) * 39 = ↑p + 200 := by exact_mod_cast hδ_mul
                have hc₀_int : (↑c₀ : ℤ) * 39 = ↑p + 5 := by exact_mod_cast hc₀_mul
                push_cast
                nlinarith [hδ_int, hc₀_int]
            · by_cases hp39_37 : p % 39 = 37
              · -- p ≡ 37 (mod 39): (α=5, r=1, s=2), M = 4·5·2·1 - 1 = 39
                -- offset = (p+80)/39, b = 10, c = 5·(p + 2)/39
                have hdiv39a : 39 ∣ (p + 80) := by omega
                have hdiv39b : 39 ∣ (p + 2) := by omega
                refine ⟨(p + 80) / 39, 10, 5 * ((p + 2) / 39), ?_, by norm_num, ?_, ?_⟩
                · have : p % 312 = 193 := by omega
                  have h39div : (p + 80) / 39 * 39 = p + 80 := Nat.div_mul_cancel hdiv39a
                  omega
                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                · set δ := (p + 80) / 39 with hδ_def
                  set c₀ := (p + 2) / 39 with hc₀_def
                  have hδ_mul : δ * 39 = p + 80 := Nat.div_mul_cancel hdiv39a
                  have hc₀_mul : c₀ * 39 = p + 2 := Nat.div_mul_cancel hdiv39b
                  have hδ_int : (↑δ : ℤ) * 39 = ↑p + 80 := by exact_mod_cast hδ_mul
                  have hc₀_int : (↑c₀ : ℤ) * 39 = ↑p + 2 := by exact_mod_cast hc₀_mul
                  push_cast
                  nlinarith [hδ_int, hc₀_int]
              · -- M = 47 subcases via Lemma D.6
                by_cases hp47_11 : p % 47 = 11
                · -- p ≡ 11 (mod 47): (α=1, r=4, s=3), M = 4·1·3·4 - 1 = 47
                  -- offset = (p+36)/47, b = 12, c = 4·(4 * p + 3)/47
                  have hdiv47a : 47 ∣ (p + 36) := by omega
                  have hdiv47b : 47 ∣ (4 * p + 3) := by omega
                  refine ⟨(p + 36) / 47, 12, 4 * ((4 * p + 3) / 47), ?_, by norm_num, ?_, ?_⟩
                  · have : p % 1128 = 481 := by omega
                    have h47div : (p + 36) / 47 * 47 = p + 36 := Nat.div_mul_cancel hdiv47a
                    omega
                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                  · set δ := (p + 36) / 47 with hδ_def
                    set c₀ := (4 * p + 3) / 47 with hc₀_def
                    have hδ_mul : δ * 47 = p + 36 := Nat.div_mul_cancel hdiv47a
                    have hc₀_mul : c₀ * 47 = 4 * p + 3 := Nat.div_mul_cancel hdiv47b
                    have hδ_int : (↑δ : ℤ) * 47 = ↑p + 36 := by exact_mod_cast hδ_mul
                    have hc₀_int : (↑c₀ : ℤ) * 47 = 4 * ↑p + 3 := by exact_mod_cast hc₀_mul
                    push_cast
                    nlinarith [hδ_int, hc₀_int]
                · by_cases hp47_15 : p % 47 = 15
                  · -- p ≡ 15 (mod 47): (α=2, r=3, s=2), M = 4·2·2·3 - 1 = 47
                    -- offset = (p+32)/47, b = 12, c = 6·(3 * p + 2)/47
                    have hdiv47a : 47 ∣ (p + 32) := by omega
                    have hdiv47b : 47 ∣ (3 * p + 2) := by omega
                    refine ⟨(p + 32) / 47, 12, 6 * ((3 * p + 2) / 47), ?_, by norm_num, ?_, ?_⟩
                    · have : p % 1128 = 673 := by omega
                      have h47div : (p + 32) / 47 * 47 = p + 32 := Nat.div_mul_cancel hdiv47a
                      omega
                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                    · set δ := (p + 32) / 47 with hδ_def
                      set c₀ := (3 * p + 2) / 47 with hc₀_def
                      have hδ_mul : δ * 47 = p + 32 := Nat.div_mul_cancel hdiv47a
                      have hc₀_mul : c₀ * 47 = 3 * p + 2 := Nat.div_mul_cancel hdiv47b
                      have hδ_int : (↑δ : ℤ) * 47 = ↑p + 32 := by exact_mod_cast hδ_mul
                      have hc₀_int : (↑c₀ : ℤ) * 47 = 3 * ↑p + 2 := by exact_mod_cast hc₀_mul
                      push_cast
                      nlinarith [hδ_int, hc₀_int]
                  · by_cases hp47_22 : p % 47 = 22
                    · -- p ≡ 22 (mod 47): (α=2, r=2, s=3), M = 4·2·3·2 - 1 = 47
                      -- offset = (p+72)/47, b = 12, c = 4·(2 * p + 3)/47
                      have hdiv47a : 47 ∣ (p + 72) := by omega
                      have hdiv47b : 47 ∣ (2 * p + 3) := by omega
                      refine ⟨(p + 72) / 47, 12, 4 * ((2 * p + 3) / 47), ?_, by norm_num, ?_, ?_⟩
                      · have : p % 1128 = 1009 := by omega
                        have h47div : (p + 72) / 47 * 47 = p + 72 := Nat.div_mul_cancel hdiv47a
                        omega
                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                      · set δ := (p + 72) / 47 with hδ_def
                        set c₀ := (2 * p + 3) / 47 with hc₀_def
                        have hδ_mul : δ * 47 = p + 72 := Nat.div_mul_cancel hdiv47a
                        have hc₀_mul : c₀ * 47 = 2 * p + 3 := Nat.div_mul_cancel hdiv47b
                        have hδ_int : (↑δ : ℤ) * 47 = ↑p + 72 := by exact_mod_cast hδ_mul
                        have hc₀_int : (↑c₀ : ℤ) * 47 = 2 * ↑p + 3 := by exact_mod_cast hc₀_mul
                        push_cast
                        nlinarith [hδ_int, hc₀_int]
                    · by_cases hp47_23 : p % 47 = 23
                      · -- p ≡ 23 (mod 47): (α=6, r=2, s=1), M = 4·6·1·2 - 1 = 47
                        -- offset = (p+24)/47, b = 12, c = 12·(2 * p + 1)/47
                        have hdiv47a : 47 ∣ (p + 24) := by omega
                        have hdiv47b : 47 ∣ (2 * p + 1) := by omega
                        refine ⟨(p + 24) / 47, 12, 12 * ((2 * p + 1) / 47), ?_, by norm_num, ?_, ?_⟩
                        · have : p % 1128 = 1057 := by omega
                          have h47div : (p + 24) / 47 * 47 = p + 24 := Nat.div_mul_cancel hdiv47a
                          omega
                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                        · set δ := (p + 24) / 47 with hδ_def
                          set c₀ := (2 * p + 1) / 47 with hc₀_def
                          have hδ_mul : δ * 47 = p + 24 := Nat.div_mul_cancel hdiv47a
                          have hc₀_mul : c₀ * 47 = 2 * p + 1 := Nat.div_mul_cancel hdiv47b
                          have hδ_int : (↑δ : ℤ) * 47 = ↑p + 24 := by exact_mod_cast hδ_mul
                          have hc₀_int : (↑c₀ : ℤ) * 47 = 2 * ↑p + 1 := by exact_mod_cast hc₀_mul
                          push_cast
                          nlinarith [hδ_int, hc₀_int]
                      · by_cases hp47_30 : p % 47 = 30
                        · -- p ≡ 30 (mod 47): (α=1, r=3, s=4), M = 4·1·4·3 - 1 = 47
                          -- offset = (p+64)/47, b = 12, c = 3·(3 * p + 4)/47
                          have hdiv47a : 47 ∣ (p + 64) := by omega
                          have hdiv47b : 47 ∣ (3 * p + 4) := by omega
                          refine ⟨(p + 64) / 47, 12, 3 * ((3 * p + 4) / 47), ?_, by norm_num, ?_, ?_⟩
                          · have : p % 1128 = 265 := by omega
                            have h47div : (p + 64) / 47 * 47 = p + 64 := Nat.div_mul_cancel hdiv47a
                            omega
                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                          · set δ := (p + 64) / 47 with hδ_def
                            set c₀ := (3 * p + 4) / 47 with hc₀_def
                            have hδ_mul : δ * 47 = p + 64 := Nat.div_mul_cancel hdiv47a
                            have hc₀_mul : c₀ * 47 = 3 * p + 4 := Nat.div_mul_cancel hdiv47b
                            have hδ_int : (↑δ : ℤ) * 47 = ↑p + 64 := by exact_mod_cast hδ_mul
                            have hc₀_int : (↑c₀ : ℤ) * 47 = 3 * ↑p + 4 := by exact_mod_cast hc₀_mul
                            push_cast
                            nlinarith [hδ_int, hc₀_int]
                        · by_cases hp47_31 : p % 47 = 31
                          · -- p ≡ 31 (mod 47): (α=1, r=6, s=2), M = 4·1·2·6 - 1 = 47
                            -- offset = (p+16)/47, b = 12, c = 6·(6 * p + 2)/47
                            have hdiv47a : 47 ∣ (p + 16) := by omega
                            have hdiv47b : 47 ∣ (6 * p + 2) := by omega
                            refine ⟨(p + 16) / 47, 12, 6 * ((6 * p + 2) / 47), ?_, by norm_num, ?_, ?_⟩
                            · have : p % 1128 = 313 := by omega
                              have h47div : (p + 16) / 47 * 47 = p + 16 := Nat.div_mul_cancel hdiv47a
                              omega
                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                            · set δ := (p + 16) / 47 with hδ_def
                              set c₀ := (6 * p + 2) / 47 with hc₀_def
                              have hδ_mul : δ * 47 = p + 16 := Nat.div_mul_cancel hdiv47a
                              have hc₀_mul : c₀ * 47 = 6 * p + 2 := Nat.div_mul_cancel hdiv47b
                              have hδ_int : (↑δ : ℤ) * 47 = ↑p + 16 := by exact_mod_cast hδ_mul
                              have hc₀_int : (↑c₀ : ℤ) * 47 = 6 * ↑p + 2 := by exact_mod_cast hc₀_mul
                              push_cast
                              nlinarith [hδ_int, hc₀_int]
                          · by_cases hp47_35 : p % 47 = 35
                            · -- p ≡ 35 (mod 47): (α=3, r=4, s=1), M = 4·3·1·4 - 1 = 47
                              -- offset = (p+12)/47, b = 12, c = 12·(4 * p + 1)/47
                              have hdiv47a : 47 ∣ (p + 12) := by omega
                              have hdiv47b : 47 ∣ (4 * p + 1) := by omega
                              refine ⟨(p + 12) / 47, 12, 12 * ((4 * p + 1) / 47), ?_, by norm_num, ?_, ?_⟩
                              · have : p % 1128 = 505 := by omega
                                have h47div : (p + 12) / 47 * 47 = p + 12 := Nat.div_mul_cancel hdiv47a
                                omega
                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                              · set δ := (p + 12) / 47 with hδ_def
                                set c₀ := (4 * p + 1) / 47 with hc₀_def
                                have hδ_mul : δ * 47 = p + 12 := Nat.div_mul_cancel hdiv47a
                                have hc₀_mul : c₀ * 47 = 4 * p + 1 := Nat.div_mul_cancel hdiv47b
                                have hδ_int : (↑δ : ℤ) * 47 = ↑p + 12 := by exact_mod_cast hδ_mul
                                have hc₀_int : (↑c₀ : ℤ) * 47 = 4 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                push_cast
                                nlinarith [hδ_int, hc₀_int]
                            · by_cases hp47_39 : p % 47 = 39
                              · -- p ≡ 39 (mod 47): (α=2, r=6, s=1), M = 4·2·1·6 - 1 = 47
                                -- offset = (p+8)/47, b = 12, c = 12·(6 * p + 1)/47
                                have hdiv47a : 47 ∣ (p + 8) := by omega
                                have hdiv47b : 47 ∣ (6 * p + 1) := by omega
                                refine ⟨(p + 8) / 47, 12, 12 * ((6 * p + 1) / 47), ?_, by norm_num, ?_, ?_⟩
                                · have : p % 1128 = 697 := by omega
                                  have h47div : (p + 8) / 47 * 47 = p + 8 := Nat.div_mul_cancel hdiv47a
                                  omega
                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                · set δ := (p + 8) / 47 with hδ_def
                                  set c₀ := (6 * p + 1) / 47 with hc₀_def
                                  have hδ_mul : δ * 47 = p + 8 := Nat.div_mul_cancel hdiv47a
                                  have hc₀_mul : c₀ * 47 = 6 * p + 1 := Nat.div_mul_cancel hdiv47b
                                  have hδ_int : (↑δ : ℤ) * 47 = ↑p + 8 := by exact_mod_cast hδ_mul
                                  have hc₀_int : (↑c₀ : ℤ) * 47 = 6 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                  push_cast
                                  nlinarith [hδ_int, hc₀_int]
                              · by_cases hp47_41 : p % 47 = 41
                                · -- p ≡ 41 (mod 47): (α=2, r=1, s=6), M = 4·2·6·1 - 1 = 47
                                  -- offset = (p+288)/47, b = 12, c = 2·(p + 6)/47
                                  have hdiv47a : 47 ∣ (p + 288) := by omega
                                  have hdiv47b : 47 ∣ (p + 6) := by omega
                                  refine ⟨(p + 288) / 47, 12, 2 * ((p + 6) / 47), ?_, by norm_num, ?_, ?_⟩
                                  · have : p % 1128 = 793 := by omega
                                    have h47div : (p + 288) / 47 * 47 = p + 288 := Nat.div_mul_cancel hdiv47a
                                    omega
                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                  · set δ := (p + 288) / 47 with hδ_def
                                    set c₀ := (p + 6) / 47 with hc₀_def
                                    have hδ_mul : δ * 47 = p + 288 := Nat.div_mul_cancel hdiv47a
                                    have hc₀_mul : c₀ * 47 = p + 6 := Nat.div_mul_cancel hdiv47b
                                    have hδ_int : (↑δ : ℤ) * 47 = ↑p + 288 := by exact_mod_cast hδ_mul
                                    have hc₀_int : (↑c₀ : ℤ) * 47 = ↑p + 6 := by exact_mod_cast hc₀_mul
                                    push_cast
                                    nlinarith [hδ_int, hc₀_int]
                                · by_cases hp47_43 : p % 47 = 43
                                  · -- p ≡ 43 (mod 47): (α=1, r=12, s=1), M = 4·1·1·12 - 1 = 47
                                    -- offset = (p+4)/47, b = 12, c = 12·(12 * p + 1)/47
                                    have hdiv47a : 47 ∣ (p + 4) := by omega
                                    have hdiv47b : 47 ∣ (12 * p + 1) := by omega
                                    refine ⟨(p + 4) / 47, 12, 12 * ((12 * p + 1) / 47), ?_, by norm_num, ?_, ?_⟩
                                    · have : p % 1128 = 889 := by omega
                                      have h47div : (p + 4) / 47 * 47 = p + 4 := Nat.div_mul_cancel hdiv47a
                                      omega
                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                    · set δ := (p + 4) / 47 with hδ_def
                                      set c₀ := (12 * p + 1) / 47 with hc₀_def
                                      have hδ_mul : δ * 47 = p + 4 := Nat.div_mul_cancel hdiv47a
                                      have hc₀_mul : c₀ * 47 = 12 * p + 1 := Nat.div_mul_cancel hdiv47b
                                      have hδ_int : (↑δ : ℤ) * 47 = ↑p + 4 := by exact_mod_cast hδ_mul
                                      have hc₀_int : (↑c₀ : ℤ) * 47 = 12 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                      push_cast
                                      nlinarith [hδ_int, hc₀_int]
                                  · by_cases hp47_44 : p % 47 = 44
                                    · -- p ≡ 44 (mod 47): (α=1, r=2, s=6), M = 4·1·6·2 - 1 = 47
                                      -- offset = (p+144)/47, b = 12, c = 2·(2 * p + 6)/47
                                      have hdiv47a : 47 ∣ (p + 144) := by omega
                                      have hdiv47b : 47 ∣ (2 * p + 6) := by omega
                                      refine ⟨(p + 144) / 47, 12, 2 * ((2 * p + 6) / 47), ?_, by norm_num, ?_, ?_⟩
                                      · have : p % 1128 = 937 := by omega
                                        have h47div : (p + 144) / 47 * 47 = p + 144 := Nat.div_mul_cancel hdiv47a
                                        omega
                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                      · set δ := (p + 144) / 47 with hδ_def
                                        set c₀ := (2 * p + 6) / 47 with hc₀_def
                                        have hδ_mul : δ * 47 = p + 144 := Nat.div_mul_cancel hdiv47a
                                        have hc₀_mul : c₀ * 47 = 2 * p + 6 := Nat.div_mul_cancel hdiv47b
                                        have hδ_int : (↑δ : ℤ) * 47 = ↑p + 144 := by exact_mod_cast hδ_mul
                                        have hc₀_int : (↑c₀ : ℤ) * 47 = 2 * ↑p + 6 := by exact_mod_cast hc₀_mul
                                        push_cast
                                        nlinarith [hδ_int, hc₀_int]
                                    · by_cases hp47_45 : p % 47 = 45
                                      · -- p ≡ 45 (mod 47): (α=6, r=1, s=2), M = 4·6·2·1 - 1 = 47
                                        -- offset = (p+96)/47, b = 12, c = 6·(p + 2)/47
                                        have hdiv47a : 47 ∣ (p + 96) := by omega
                                        have hdiv47b : 47 ∣ (p + 2) := by omega
                                        refine ⟨(p + 96) / 47, 12, 6 * ((p + 2) / 47), ?_, by norm_num, ?_, ?_⟩
                                        · have : p % 1128 = 985 := by omega
                                          have h47div : (p + 96) / 47 * 47 = p + 96 := Nat.div_mul_cancel hdiv47a
                                          omega
                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                        · set δ := (p + 96) / 47 with hδ_def
                                          set c₀ := (p + 2) / 47 with hc₀_def
                                          have hδ_mul : δ * 47 = p + 96 := Nat.div_mul_cancel hdiv47a
                                          have hc₀_mul : c₀ * 47 = p + 2 := Nat.div_mul_cancel hdiv47b
                                          have hδ_int : (↑δ : ℤ) * 47 = ↑p + 96 := by exact_mod_cast hδ_mul
                                          have hc₀_int : (↑c₀ : ℤ) * 47 = ↑p + 2 := by exact_mod_cast hc₀_mul
                                          push_cast
                                          nlinarith [hδ_int, hc₀_int]
                                      · by_cases hp47_46 : p % 47 = 46
                                        · -- p ≡ 46 (mod 47): (α=3, r=2, s=2), M = 4·3·2·2 - 1 = 47
                                          -- offset = (p+48)/47, b = 12, c = 6·(2 * p + 2)/47
                                          have hdiv47a : 47 ∣ (p + 48) := by omega
                                          have hdiv47b : 47 ∣ (2 * p + 2) := by omega
                                          refine ⟨(p + 48) / 47, 12, 6 * ((2 * p + 2) / 47), ?_, by norm_num, ?_, ?_⟩
                                          · have : p % 1128 = 1033 := by omega
                                            have h47div : (p + 48) / 47 * 47 = p + 48 := Nat.div_mul_cancel hdiv47a
                                            omega
                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                          · set δ := (p + 48) / 47 with hδ_def
                                            set c₀ := (2 * p + 2) / 47 with hc₀_def
                                            have hδ_mul : δ * 47 = p + 48 := Nat.div_mul_cancel hdiv47a
                                            have hc₀_mul : c₀ * 47 = 2 * p + 2 := Nat.div_mul_cancel hdiv47b
                                            have hδ_int : (↑δ : ℤ) * 47 = ↑p + 48 := by exact_mod_cast hδ_mul
                                            have hc₀_int : (↑c₀ : ℤ) * 47 = 2 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                            push_cast
                                            nlinarith [hδ_int, hc₀_int]
                                        · -- M = 119 subcases via Lemma D.6
                                          by_cases hp119_19 : p % 119 = 19
                                          · -- p ≡ 19 (mod 119): (α=1, r=6, s=5), M = 4·1·5·6 - 1 = 119
                                            -- offset = (p+100)/119, b = 30, c = 6·(6 * p + 5)/119
                                            have hdiv119a : 119 ∣ (p + 100) := by omega
                                            have hdiv119b : 119 ∣ (6 * p + 5) := by omega
                                            refine ⟨(p + 100) / 119, 30, 6 * ((6 * p + 5) / 119), ?_, by norm_num, ?_, ?_⟩
                                            · have : p % 2856 = 2161 := by omega
                                              have h119div : (p + 100) / 119 * 119 = p + 100 := Nat.div_mul_cancel hdiv119a
                                              omega
                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                            · set δ := (p + 100) / 119 with hδ_def
                                              set c₀ := (6 * p + 5) / 119 with hc₀_def
                                              have hδ_mul : δ * 119 = p + 100 := Nat.div_mul_cancel hdiv119a
                                              have hc₀_mul : c₀ * 119 = 6 * p + 5 := Nat.div_mul_cancel hdiv119b
                                              have hδ_int : (↑δ : ℤ) * 119 = ↑p + 100 := by exact_mod_cast hδ_mul
                                              have hc₀_int : (↑c₀ : ℤ) * 119 = 6 * ↑p + 5 := by exact_mod_cast hc₀_mul
                                              push_cast
                                              nlinarith [hδ_int, hc₀_int]
                                          · by_cases hp119_38 : p % 119 = 38
                                            · -- p ≡ 38 (mod 119): (α=2, r=3, s=5), M = 4·2·5·3 - 1 = 119
                                              -- offset = (p+200)/119, b = 30, c = 6·(3 * p + 5)/119
                                              have hdiv119a : 119 ∣ (p + 200) := by omega
                                              have hdiv119b : 119 ∣ (3 * p + 5) := by omega
                                              refine ⟨(p + 200) / 119, 30, 6 * ((3 * p + 5) / 119), ?_, by norm_num, ?_, ?_⟩
                                              · have : p % 2856 = 1585 := by omega
                                                have h119div : (p + 200) / 119 * 119 = p + 200 := Nat.div_mul_cancel hdiv119a
                                                omega
                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                              · set δ := (p + 200) / 119 with hδ_def
                                                set c₀ := (3 * p + 5) / 119 with hc₀_def
                                                have hδ_mul : δ * 119 = p + 200 := Nat.div_mul_cancel hdiv119a
                                                have hc₀_mul : c₀ * 119 = 3 * p + 5 := Nat.div_mul_cancel hdiv119b
                                                have hδ_int : (↑δ : ℤ) * 119 = ↑p + 200 := by exact_mod_cast hδ_mul
                                                have hc₀_int : (↑c₀ : ℤ) * 119 = 3 * ↑p + 5 := by exact_mod_cast hc₀_mul
                                                push_cast
                                                nlinarith [hδ_int, hc₀_int]
                                            · by_cases hp119_39 : p % 119 = 39
                                              · -- p ≡ 39 (mod 119): (α=5, r=3, s=2), M = 4·5·2·3 - 1 = 119
                                                -- offset = (p+80)/119, b = 30, c = 15·(3 * p + 2)/119
                                                have hdiv119a : 119 ∣ (p + 80) := by omega
                                                have hdiv119b : 119 ∣ (3 * p + 2) := by omega
                                                refine ⟨(p + 80) / 119, 30, 15 * ((3 * p + 2) / 119), ?_, by norm_num, ?_, ?_⟩
                                                · have : p % 2856 = 1705 := by omega
                                                  have h119div : (p + 80) / 119 * 119 = p + 80 := Nat.div_mul_cancel hdiv119a
                                                  omega
                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                · set δ := (p + 80) / 119 with hδ_def
                                                  set c₀ := (3 * p + 2) / 119 with hc₀_def
                                                  have hδ_mul : δ * 119 = p + 80 := Nat.div_mul_cancel hdiv119a
                                                  have hc₀_mul : c₀ * 119 = 3 * p + 2 := Nat.div_mul_cancel hdiv119b
                                                  have hδ_int : (↑δ : ℤ) * 119 = ↑p + 80 := by exact_mod_cast hδ_mul
                                                  have hc₀_int : (↑c₀ : ℤ) * 119 = 3 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                  push_cast
                                                  nlinarith [hδ_int, hc₀_int]
                                              · by_cases hp119_47 : p % 119 = 47
                                                · -- p ≡ 47 (mod 119): (α=2, r=5, s=3), M = 4·2·3·5 - 1 = 119
                                                  -- offset = (p+72)/119, b = 30, c = 10·(5 * p + 3)/119
                                                  have hdiv119a : 119 ∣ (p + 72) := by omega
                                                  have hdiv119b : 119 ∣ (5 * p + 3) := by omega
                                                  refine ⟨(p + 72) / 119, 30, 10 * ((5 * p + 3) / 119), ?_, by norm_num, ?_, ?_⟩
                                                  · have : p % 2856 = 2665 := by omega
                                                    have h119div : (p + 72) / 119 * 119 = p + 72 := Nat.div_mul_cancel hdiv119a
                                                    omega
                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                  · set δ := (p + 72) / 119 with hδ_def
                                                    set c₀ := (5 * p + 3) / 119 with hc₀_def
                                                    have hδ_mul : δ * 119 = p + 72 := Nat.div_mul_cancel hdiv119a
                                                    have hc₀_mul : c₀ * 119 = 5 * p + 3 := Nat.div_mul_cancel hdiv119b
                                                    have hδ_int : (↑δ : ℤ) * 119 = ↑p + 72 := by exact_mod_cast hδ_mul
                                                    have hc₀_int : (↑c₀ : ℤ) * 119 = 5 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                    push_cast
                                                    nlinarith [hδ_int, hc₀_int]
                                                · by_cases hp119_52 : p % 119 = 52
                                                  · -- p ≡ 52 (mod 119): (α=1, r=2, s=15), M = 4·1·15·2 - 1 = 119
                                                    -- offset = (p+900)/119, b = 30, c = 2·(2 * p + 15)/119
                                                    have hdiv119a : 119 ∣ (p + 900) := by omega
                                                    have hdiv119b : 119 ∣ (2 * p + 15) := by omega
                                                    refine ⟨(p + 900) / 119, 30, 2 * ((2 * p + 15) / 119), ?_, by norm_num, ?_, ?_⟩
                                                    · have : p % 2856 = 409 := by omega
                                                      have h119div : (p + 900) / 119 * 119 = p + 900 := Nat.div_mul_cancel hdiv119a
                                                      omega
                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                    · set δ := (p + 900) / 119 with hδ_def
                                                      set c₀ := (2 * p + 15) / 119 with hc₀_def
                                                      have hδ_mul : δ * 119 = p + 900 := Nat.div_mul_cancel hdiv119a
                                                      have hc₀_mul : c₀ * 119 = 2 * p + 15 := Nat.div_mul_cancel hdiv119b
                                                      have hδ_int : (↑δ : ℤ) * 119 = ↑p + 900 := by exact_mod_cast hδ_mul
                                                      have hc₀_int : (↑c₀ : ℤ) * 119 = 2 * ↑p + 15 := by exact_mod_cast hc₀_mul
                                                      push_cast
                                                      nlinarith [hδ_int, hc₀_int]
                                                  · by_cases hp119_57 : p % 119 = 57
                                                    · -- p ≡ 57 (mod 119): (α=3, r=2, s=5), M = 4·3·5·2 - 1 = 119
                                                      -- offset = (p+300)/119, b = 30, c = 6·(2 * p + 5)/119
                                                      have hdiv119a : 119 ∣ (p + 300) := by omega
                                                      have hdiv119b : 119 ∣ (2 * p + 5) := by omega
                                                      refine ⟨(p + 300) / 119, 30, 6 * ((2 * p + 5) / 119), ?_, by norm_num, ?_, ?_⟩
                                                      · have : p % 2856 = 1009 := by omega
                                                        have h119div : (p + 300) / 119 * 119 = p + 300 := Nat.div_mul_cancel hdiv119a
                                                        omega
                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                      · set δ := (p + 300) / 119 with hδ_def
                                                        set c₀ := (2 * p + 5) / 119 with hc₀_def
                                                        have hδ_mul : δ * 119 = p + 300 := Nat.div_mul_cancel hdiv119a
                                                        have hc₀_mul : c₀ * 119 = 2 * p + 5 := Nat.div_mul_cancel hdiv119b
                                                        have hδ_int : (↑δ : ℤ) * 119 = ↑p + 300 := by exact_mod_cast hδ_mul
                                                        have hc₀_int : (↑c₀ : ℤ) * 119 = 2 * ↑p + 5 := by exact_mod_cast hc₀_mul
                                                        push_cast
                                                        nlinarith [hδ_int, hc₀_int]
                                                    · by_cases hp119_58 : p % 119 = 58
                                                      · -- p ≡ 58 (mod 119): (α=5, r=2, s=3), M = 4·5·3·2 - 1 = 119
                                                        -- offset = (p+180)/119, b = 30, c = 10·(2 * p + 3)/119
                                                        have hdiv119a : 119 ∣ (p + 180) := by omega
                                                        have hdiv119b : 119 ∣ (2 * p + 3) := by omega
                                                        refine ⟨(p + 180) / 119, 30, 10 * ((2 * p + 3) / 119), ?_, by norm_num, ?_, ?_⟩
                                                        · have : p % 2856 = 1129 := by omega
                                                          have h119div : (p + 180) / 119 * 119 = p + 180 := Nat.div_mul_cancel hdiv119a
                                                          omega
                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                        · set δ := (p + 180) / 119 with hδ_def
                                                          set c₀ := (2 * p + 3) / 119 with hc₀_def
                                                          have hδ_mul : δ * 119 = p + 180 := Nat.div_mul_cancel hdiv119a
                                                          have hc₀_mul : c₀ * 119 = 2 * p + 3 := Nat.div_mul_cancel hdiv119b
                                                          have hδ_int : (↑δ : ℤ) * 119 = ↑p + 180 := by exact_mod_cast hδ_mul
                                                          have hc₀_int : (↑c₀ : ℤ) * 119 = 2 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                          push_cast
                                                          nlinarith [hδ_int, hc₀_int]
                                                      · by_cases hp119_59 : p % 119 = 59
                                                        · -- p ≡ 59 (mod 119): (α=15, r=2, s=1), M = 4·15·1·2 - 1 = 119
                                                          -- offset = (p+60)/119, b = 30, c = 30·(2 * p + 1)/119
                                                          have hdiv119a : 119 ∣ (p + 60) := by omega
                                                          have hdiv119b : 119 ∣ (2 * p + 1) := by omega
                                                          refine ⟨(p + 60) / 119, 30, 30 * ((2 * p + 1) / 119), ?_, by norm_num, ?_, ?_⟩
                                                          · have : p % 2856 = 1249 := by omega
                                                            have h119div : (p + 60) / 119 * 119 = p + 60 := Nat.div_mul_cancel hdiv119a
                                                            omega
                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                          · set δ := (p + 60) / 119 with hδ_def
                                                            set c₀ := (2 * p + 1) / 119 with hc₀_def
                                                            have hδ_mul : δ * 119 = p + 60 := Nat.div_mul_cancel hdiv119a
                                                            have hc₀_mul : c₀ * 119 = 2 * p + 1 := Nat.div_mul_cancel hdiv119b
                                                            have hδ_int : (↑δ : ℤ) * 119 = ↑p + 60 := by exact_mod_cast hδ_mul
                                                            have hc₀_int : (↑c₀ : ℤ) * 119 = 2 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                            push_cast
                                                            nlinarith [hδ_int, hc₀_int]
                                                        · by_cases hp119_71 : p % 119 = 71
                                                          · -- p ≡ 71 (mod 119): (α=3, r=5, s=2), M = 4·3·2·5 - 1 = 119
                                                            -- offset = (p+48)/119, b = 30, c = 15·(5 * p + 2)/119
                                                            have hdiv119a : 119 ∣ (p + 48) := by omega
                                                            have hdiv119b : 119 ∣ (5 * p + 2) := by omega
                                                            refine ⟨(p + 48) / 119, 30, 15 * ((5 * p + 2) / 119), ?_, by norm_num, ?_, ?_⟩
                                                            · have : p % 2856 = 2689 := by omega
                                                              have h119div : (p + 48) / 119 * 119 = p + 48 := Nat.div_mul_cancel hdiv119a
                                                              omega
                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                            · set δ := (p + 48) / 119 with hδ_def
                                                              set c₀ := (5 * p + 2) / 119 with hc₀_def
                                                              have hδ_mul : δ * 119 = p + 48 := Nat.div_mul_cancel hdiv119a
                                                              have hc₀_mul : c₀ * 119 = 5 * p + 2 := Nat.div_mul_cancel hdiv119b
                                                              have hδ_int : (↑δ : ℤ) * 119 = ↑p + 48 := by exact_mod_cast hδ_mul
                                                              have hc₀_int : (↑c₀ : ℤ) * 119 = 5 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                              push_cast
                                                              nlinarith [hδ_int, hc₀_int]
                                                          · by_cases hp119_76 : p % 119 = 76
                                                            · -- p ≡ 76 (mod 119): (α=1, r=3, s=10), M = 4·1·10·3 - 1 = 119
                                                              -- offset = (p+400)/119, b = 30, c = 3·(3 * p + 10)/119
                                                              have hdiv119a : 119 ∣ (p + 400) := by omega
                                                              have hdiv119b : 119 ∣ (3 * p + 10) := by omega
                                                              refine ⟨(p + 400) / 119, 30, 3 * ((3 * p + 10) / 119), ?_, by norm_num, ?_, ?_⟩
                                                              · have : p % 2856 = 433 := by omega
                                                                have h119div : (p + 400) / 119 * 119 = p + 400 := Nat.div_mul_cancel hdiv119a
                                                                omega
                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                              · set δ := (p + 400) / 119 with hδ_def
                                                                set c₀ := (3 * p + 10) / 119 with hc₀_def
                                                                have hδ_mul : δ * 119 = p + 400 := Nat.div_mul_cancel hdiv119a
                                                                have hc₀_mul : c₀ * 119 = 3 * p + 10 := Nat.div_mul_cancel hdiv119b
                                                                have hδ_int : (↑δ : ℤ) * 119 = ↑p + 400 := by exact_mod_cast hδ_mul
                                                                have hc₀_int : (↑c₀ : ℤ) * 119 = 3 * ↑p + 10 := by exact_mod_cast hc₀_mul
                                                                push_cast
                                                                nlinarith [hδ_int, hc₀_int]
                                                            · by_cases hp119_79 : p % 119 = 79
                                                              · -- p ≡ 79 (mod 119): (α=10, r=3, s=1), M = 4·10·1·3 - 1 = 119
                                                                -- offset = (p+40)/119, b = 30, c = 30·(3 * p + 1)/119
                                                                have hdiv119a : 119 ∣ (p + 40) := by omega
                                                                have hdiv119b : 119 ∣ (3 * p + 1) := by omega
                                                                refine ⟨(p + 40) / 119, 30, 30 * ((3 * p + 1) / 119), ?_, by norm_num, ?_, ?_⟩
                                                                · have : p % 2856 = 793 := by omega
                                                                  have h119div : (p + 40) / 119 * 119 = p + 40 := Nat.div_mul_cancel hdiv119a
                                                                  omega
                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                · set δ := (p + 40) / 119 with hδ_def
                                                                  set c₀ := (3 * p + 1) / 119 with hc₀_def
                                                                  have hδ_mul : δ * 119 = p + 40 := Nat.div_mul_cancel hdiv119a
                                                                  have hc₀_mul : c₀ * 119 = 3 * p + 1 := Nat.div_mul_cancel hdiv119b
                                                                  have hδ_int : (↑δ : ℤ) * 119 = ↑p + 40 := by exact_mod_cast hδ_mul
                                                                  have hc₀_int : (↑c₀ : ℤ) * 119 = 3 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                  push_cast
                                                                  nlinarith [hδ_int, hc₀_int]
                                                              · by_cases hp119_83 : p % 119 = 83
                                                                · -- p ≡ 83 (mod 119): (α=1, r=10, s=3), M = 4·1·3·10 - 1 = 119
                                                                  -- offset = (p+36)/119, b = 30, c = 10·(10 * p + 3)/119
                                                                  have hdiv119a : 119 ∣ (p + 36) := by omega
                                                                  have hdiv119b : 119 ∣ (10 * p + 3) := by omega
                                                                  refine ⟨(p + 36) / 119, 30, 10 * ((10 * p + 3) / 119), ?_, by norm_num, ?_, ?_⟩
                                                                  · have : p % 2856 = 1273 := by omega
                                                                    have h119div : (p + 36) / 119 * 119 = p + 36 := Nat.div_mul_cancel hdiv119a
                                                                    omega
                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                  · set δ := (p + 36) / 119 with hδ_def
                                                                    set c₀ := (10 * p + 3) / 119 with hc₀_def
                                                                    have hδ_mul : δ * 119 = p + 36 := Nat.div_mul_cancel hdiv119a
                                                                    have hc₀_mul : c₀ * 119 = 10 * p + 3 := Nat.div_mul_cancel hdiv119b
                                                                    have hδ_int : (↑δ : ℤ) * 119 = ↑p + 36 := by exact_mod_cast hδ_mul
                                                                    have hc₀_int : (↑c₀ : ℤ) * 119 = 10 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                    push_cast
                                                                    nlinarith [hδ_int, hc₀_int]
                                                                · by_cases hp119_89 : p % 119 = 89
                                                                  · -- p ≡ 89 (mod 119): (α=1, r=1, s=30), M = 4·1·30·1 - 1 = 119
                                                                    -- offset = (p+3600)/119, b = 30, c = (p + 30)/119
                                                                    have hdiv119a : 119 ∣ (p + 3600) := by omega
                                                                    have hdiv119b : 119 ∣ (p + 30) := by omega
                                                                    refine ⟨(p + 3600) / 119, 30, (p + 30) / 119, ?_, by norm_num, ?_, ?_⟩
                                                                    · have : p % 2856 = 1993 := by omega
                                                                      have h119div : (p + 3600) / 119 * 119 = p + 3600 := Nat.div_mul_cancel hdiv119a
                                                                      omega
                                                                    · exact Nat.div_pos (by omega) (by norm_num)
                                                                    · set δ := (p + 3600) / 119 with hδ_def
                                                                      set c₀ := (p + 30) / 119 with hc₀_def
                                                                      have hδ_mul : δ * 119 = p + 3600 := Nat.div_mul_cancel hdiv119a
                                                                      have hc₀_mul : c₀ * 119 = p + 30 := Nat.div_mul_cancel hdiv119b
                                                                      have hδ_int : (↑δ : ℤ) * 119 = ↑p + 3600 := by exact_mod_cast hδ_mul
                                                                      have hc₀_int : (↑c₀ : ℤ) * 119 = ↑p + 30 := by exact_mod_cast hc₀_mul
                                                                      push_cast
                                                                      nlinarith [hδ_int, hc₀_int]
                                                                  · by_cases hp119_94 : p % 119 = 94
                                                                    · -- p ≡ 94 (mod 119): (α=1, r=5, s=6), M = 4·1·6·5 - 1 = 119
                                                                      -- offset = (p+144)/119, b = 30, c = 5·(5 * p + 6)/119
                                                                      have hdiv119a : 119 ∣ (p + 144) := by omega
                                                                      have hdiv119b : 119 ∣ (5 * p + 6) := by omega
                                                                      refine ⟨(p + 144) / 119, 30, 5 * ((5 * p + 6) / 119), ?_, by norm_num, ?_, ?_⟩
                                                                      · have : p % 2856 = 2593 := by omega
                                                                        have h119div : (p + 144) / 119 * 119 = p + 144 := Nat.div_mul_cancel hdiv119a
                                                                        omega
                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                      · set δ := (p + 144) / 119 with hδ_def
                                                                        set c₀ := (5 * p + 6) / 119 with hc₀_def
                                                                        have hδ_mul : δ * 119 = p + 144 := Nat.div_mul_cancel hdiv119a
                                                                        have hc₀_mul : c₀ * 119 = 5 * p + 6 := Nat.div_mul_cancel hdiv119b
                                                                        have hδ_int : (↑δ : ℤ) * 119 = ↑p + 144 := by exact_mod_cast hδ_mul
                                                                        have hc₀_int : (↑c₀ : ℤ) * 119 = 5 * ↑p + 6 := by exact_mod_cast hc₀_mul
                                                                        push_cast
                                                                        nlinarith [hδ_int, hc₀_int]
                                                                    · by_cases hp119_95 : p % 119 = 95
                                                                      · -- p ≡ 95 (mod 119): (α=6, r=5, s=1), M = 4·6·1·5 - 1 = 119
                                                                        -- offset = (p+24)/119, b = 30, c = 30·(5 * p + 1)/119
                                                                        have hdiv119a : 119 ∣ (p + 24) := by omega
                                                                        have hdiv119b : 119 ∣ (5 * p + 1) := by omega
                                                                        refine ⟨(p + 24) / 119, 30, 30 * ((5 * p + 1) / 119), ?_, by norm_num, ?_, ?_⟩
                                                                        · have : p % 2856 = 2713 := by omega
                                                                          have h119div : (p + 24) / 119 * 119 = p + 24 := Nat.div_mul_cancel hdiv119a
                                                                          omega
                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                        · set δ := (p + 24) / 119 with hδ_def
                                                                          set c₀ := (5 * p + 1) / 119 with hc₀_def
                                                                          have hδ_mul : δ * 119 = p + 24 := Nat.div_mul_cancel hdiv119a
                                                                          have hc₀_mul : c₀ * 119 = 5 * p + 1 := Nat.div_mul_cancel hdiv119b
                                                                          have hδ_int : (↑δ : ℤ) * 119 = ↑p + 24 := by exact_mod_cast hδ_mul
                                                                          have hc₀_int : (↑c₀ : ℤ) * 119 = 5 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                          push_cast
                                                                          nlinarith [hδ_int, hc₀_int]
                                                                      · by_cases hp119_99 : p % 119 = 99
                                                                        · -- p ≡ 99 (mod 119): (α=5, r=6, s=1), M = 4·5·1·6 - 1 = 119
                                                                          -- offset = (p+20)/119, b = 30, c = 30·(6 * p + 1)/119
                                                                          have hdiv119a : 119 ∣ (p + 20) := by omega
                                                                          have hdiv119b : 119 ∣ (6 * p + 1) := by omega
                                                                          refine ⟨(p + 20) / 119, 30, 30 * ((6 * p + 1) / 119), ?_, by norm_num, ?_, ?_⟩
                                                                          · have : p % 2856 = 337 := by omega
                                                                            have h119div : (p + 20) / 119 * 119 = p + 20 := Nat.div_mul_cancel hdiv119a
                                                                            omega
                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                          · set δ := (p + 20) / 119 with hδ_def
                                                                            set c₀ := (6 * p + 1) / 119 with hc₀_def
                                                                            have hδ_mul : δ * 119 = p + 20 := Nat.div_mul_cancel hdiv119a
                                                                            have hc₀_mul : c₀ * 119 = 6 * p + 1 := Nat.div_mul_cancel hdiv119b
                                                                            have hδ_int : (↑δ : ℤ) * 119 = ↑p + 20 := by exact_mod_cast hδ_mul
                                                                            have hc₀_int : (↑c₀ : ℤ) * 119 = 6 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                            push_cast
                                                                            nlinarith [hδ_int, hc₀_int]
                                                                        · by_cases hp119_103 : p % 119 = 103
                                                                          · -- p ≡ 103 (mod 119): (α=1, r=15, s=2), M = 4·1·2·15 - 1 = 119
                                                                            -- offset = (p+16)/119, b = 30, c = 15·(15 * p + 2)/119
                                                                            have hdiv119a : 119 ∣ (p + 16) := by omega
                                                                            have hdiv119b : 119 ∣ (15 * p + 2) := by omega
                                                                            refine ⟨(p + 16) / 119, 30, 15 * ((15 * p + 2) / 119), ?_, by norm_num, ?_, ?_⟩
                                                                            · have : p % 2856 = 817 := by omega
                                                                              have h119div : (p + 16) / 119 * 119 = p + 16 := Nat.div_mul_cancel hdiv119a
                                                                              omega
                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                            · set δ := (p + 16) / 119 with hδ_def
                                                                              set c₀ := (15 * p + 2) / 119 with hc₀_def
                                                                              have hδ_mul : δ * 119 = p + 16 := Nat.div_mul_cancel hdiv119a
                                                                              have hc₀_mul : c₀ * 119 = 15 * p + 2 := Nat.div_mul_cancel hdiv119b
                                                                              have hδ_int : (↑δ : ℤ) * 119 = ↑p + 16 := by exact_mod_cast hδ_mul
                                                                              have hc₀_int : (↑c₀ : ℤ) * 119 = 15 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                              push_cast
                                                                              nlinarith [hδ_int, hc₀_int]
                                                                          · by_cases hp119_104 : p % 119 = 104
                                                                            · -- p ≡ 104 (mod 119): (α=2, r=1, s=15), M = 4·2·15·1 - 1 = 119
                                                                              -- offset = (p+1800)/119, b = 30, c = 2·(p + 15)/119
                                                                              have hdiv119a : 119 ∣ (p + 1800) := by omega
                                                                              have hdiv119b : 119 ∣ (p + 15) := by omega
                                                                              refine ⟨(p + 1800) / 119, 30, 2 * ((p + 15) / 119), ?_, by norm_num, ?_, ?_⟩
                                                                              · have : p % 2856 = 937 := by omega
                                                                                have h119div : (p + 1800) / 119 * 119 = p + 1800 := Nat.div_mul_cancel hdiv119a
                                                                                omega
                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                              · set δ := (p + 1800) / 119 with hδ_def
                                                                                set c₀ := (p + 15) / 119 with hc₀_def
                                                                                have hδ_mul : δ * 119 = p + 1800 := Nat.div_mul_cancel hdiv119a
                                                                                have hc₀_mul : c₀ * 119 = p + 15 := Nat.div_mul_cancel hdiv119b
                                                                                have hδ_int : (↑δ : ℤ) * 119 = ↑p + 1800 := by exact_mod_cast hδ_mul
                                                                                have hc₀_int : (↑c₀ : ℤ) * 119 = ↑p + 15 := by exact_mod_cast hc₀_mul
                                                                                push_cast
                                                                                nlinarith [hδ_int, hc₀_int]
                                                                            · by_cases hp119_107 : p % 119 = 107
                                                                              · -- p ≡ 107 (mod 119): (α=3, r=10, s=1), M = 4·3·1·10 - 1 = 119
                                                                                -- offset = (p+12)/119, b = 30, c = 30·(10 * p + 1)/119
                                                                                have hdiv119a : 119 ∣ (p + 12) := by omega
                                                                                have hdiv119b : 119 ∣ (10 * p + 1) := by omega
                                                                                refine ⟨(p + 12) / 119, 30, 30 * ((10 * p + 1) / 119), ?_, by norm_num, ?_, ?_⟩
                                                                                · have : p % 2856 = 1297 := by omega
                                                                                  have h119div : (p + 12) / 119 * 119 = p + 12 := Nat.div_mul_cancel hdiv119a
                                                                                  omega
                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                · set δ := (p + 12) / 119 with hδ_def
                                                                                  set c₀ := (10 * p + 1) / 119 with hc₀_def
                                                                                  have hδ_mul : δ * 119 = p + 12 := Nat.div_mul_cancel hdiv119a
                                                                                  have hc₀_mul : c₀ * 119 = 10 * p + 1 := Nat.div_mul_cancel hdiv119b
                                                                                  have hδ_int : (↑δ : ℤ) * 119 = ↑p + 12 := by exact_mod_cast hδ_mul
                                                                                  have hc₀_int : (↑c₀ : ℤ) * 119 = 10 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                  push_cast
                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                              · by_cases hp119_109 : p % 119 = 109
                                                                                · -- p ≡ 109 (mod 119): (α=3, r=1, s=10), M = 4·3·10·1 - 1 = 119
                                                                                  -- offset = (p+1200)/119, b = 30, c = 3·(p + 10)/119
                                                                                  have hdiv119a : 119 ∣ (p + 1200) := by omega
                                                                                  have hdiv119b : 119 ∣ (p + 10) := by omega
                                                                                  refine ⟨(p + 1200) / 119, 30, 3 * ((p + 10) / 119), ?_, by norm_num, ?_, ?_⟩
                                                                                  · have : p % 2856 = 1537 := by omega
                                                                                    have h119div : (p + 1200) / 119 * 119 = p + 1200 := Nat.div_mul_cancel hdiv119a
                                                                                    omega
                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                  · set δ := (p + 1200) / 119 with hδ_def
                                                                                    set c₀ := (p + 10) / 119 with hc₀_def
                                                                                    have hδ_mul : δ * 119 = p + 1200 := Nat.div_mul_cancel hdiv119a
                                                                                    have hc₀_mul : c₀ * 119 = p + 10 := Nat.div_mul_cancel hdiv119b
                                                                                    have hδ_int : (↑δ : ℤ) * 119 = ↑p + 1200 := by exact_mod_cast hδ_mul
                                                                                    have hc₀_int : (↑c₀ : ℤ) * 119 = ↑p + 10 := by exact_mod_cast hc₀_mul
                                                                                    push_cast
                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                · by_cases hp119_111 : p % 119 = 111
                                                                                  · -- p ≡ 111 (mod 119): (α=2, r=15, s=1), M = 4·2·1·15 - 1 = 119
                                                                                    -- offset = (p+8)/119, b = 30, c = 30·(15 * p + 1)/119
                                                                                    have hdiv119a : 119 ∣ (p + 8) := by omega
                                                                                    have hdiv119b : 119 ∣ (15 * p + 1) := by omega
                                                                                    refine ⟨(p + 8) / 119, 30, 30 * ((15 * p + 1) / 119), ?_, by norm_num, ?_, ?_⟩
                                                                                    · have : p % 2856 = 1777 := by omega
                                                                                      have h119div : (p + 8) / 119 * 119 = p + 8 := Nat.div_mul_cancel hdiv119a
                                                                                      omega
                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                    · set δ := (p + 8) / 119 with hδ_def
                                                                                      set c₀ := (15 * p + 1) / 119 with hc₀_def
                                                                                      have hδ_mul : δ * 119 = p + 8 := Nat.div_mul_cancel hdiv119a
                                                                                      have hc₀_mul : c₀ * 119 = 15 * p + 1 := Nat.div_mul_cancel hdiv119b
                                                                                      have hδ_int : (↑δ : ℤ) * 119 = ↑p + 8 := by exact_mod_cast hδ_mul
                                                                                      have hc₀_int : (↑c₀ : ℤ) * 119 = 15 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                      push_cast
                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                  · by_cases hp119_113 : p % 119 = 113
                                                                                    · -- p ≡ 113 (mod 119): (α=5, r=1, s=6), M = 4·5·6·1 - 1 = 119
                                                                                      -- offset = (p+720)/119, b = 30, c = 5·(p + 6)/119
                                                                                      have hdiv119a : 119 ∣ (p + 720) := by omega
                                                                                      have hdiv119b : 119 ∣ (p + 6) := by omega
                                                                                      refine ⟨(p + 720) / 119, 30, 5 * ((p + 6) / 119), ?_, by norm_num, ?_, ?_⟩
                                                                                      · have : p % 2856 = 2017 := by omega
                                                                                        have h119div : (p + 720) / 119 * 119 = p + 720 := Nat.div_mul_cancel hdiv119a
                                                                                        omega
                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                      · set δ := (p + 720) / 119 with hδ_def
                                                                                        set c₀ := (p + 6) / 119 with hc₀_def
                                                                                        have hδ_mul : δ * 119 = p + 720 := Nat.div_mul_cancel hdiv119a
                                                                                        have hc₀_mul : c₀ * 119 = p + 6 := Nat.div_mul_cancel hdiv119b
                                                                                        have hδ_int : (↑δ : ℤ) * 119 = ↑p + 720 := by exact_mod_cast hδ_mul
                                                                                        have hc₀_int : (↑c₀ : ℤ) * 119 = ↑p + 6 := by exact_mod_cast hc₀_mul
                                                                                        push_cast
                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                    · by_cases hp119_114 : p % 119 = 114
                                                                                      · -- p ≡ 114 (mod 119): (α=6, r=1, s=5), M = 4·6·5·1 - 1 = 119
                                                                                        -- offset = (p+600)/119, b = 30, c = 6·(p + 5)/119
                                                                                        have hdiv119a : 119 ∣ (p + 600) := by omega
                                                                                        have hdiv119b : 119 ∣ (p + 5) := by omega
                                                                                        refine ⟨(p + 600) / 119, 30, 6 * ((p + 5) / 119), ?_, by norm_num, ?_, ?_⟩
                                                                                        · have : p % 2856 = 2137 := by omega
                                                                                          have h119div : (p + 600) / 119 * 119 = p + 600 := Nat.div_mul_cancel hdiv119a
                                                                                          omega
                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                        · set δ := (p + 600) / 119 with hδ_def
                                                                                          set c₀ := (p + 5) / 119 with hc₀_def
                                                                                          have hδ_mul : δ * 119 = p + 600 := Nat.div_mul_cancel hdiv119a
                                                                                          have hc₀_mul : c₀ * 119 = p + 5 := Nat.div_mul_cancel hdiv119b
                                                                                          have hδ_int : (↑δ : ℤ) * 119 = ↑p + 600 := by exact_mod_cast hδ_mul
                                                                                          have hc₀_int : (↑c₀ : ℤ) * 119 = ↑p + 5 := by exact_mod_cast hc₀_mul
                                                                                          push_cast
                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                      · by_cases hp119_115 : p % 119 = 115
                                                                                        · -- p ≡ 115 (mod 119): (α=1, r=30, s=1), M = 4·1·1·30 - 1 = 119
                                                                                          -- offset = (p+4)/119, b = 30, c = 30·(30 * p + 1)/119
                                                                                          have hdiv119a : 119 ∣ (p + 4) := by omega
                                                                                          have hdiv119b : 119 ∣ (30 * p + 1) := by omega
                                                                                          refine ⟨(p + 4) / 119, 30, 30 * ((30 * p + 1) / 119), ?_, by norm_num, ?_, ?_⟩
                                                                                          · have : p % 2856 = 2257 := by omega
                                                                                            have h119div : (p + 4) / 119 * 119 = p + 4 := Nat.div_mul_cancel hdiv119a
                                                                                            omega
                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                          · set δ := (p + 4) / 119 with hδ_def
                                                                                            set c₀ := (30 * p + 1) / 119 with hc₀_def
                                                                                            have hδ_mul : δ * 119 = p + 4 := Nat.div_mul_cancel hdiv119a
                                                                                            have hc₀_mul : c₀ * 119 = 30 * p + 1 := Nat.div_mul_cancel hdiv119b
                                                                                            have hδ_int : (↑δ : ℤ) * 119 = ↑p + 4 := by exact_mod_cast hδ_mul
                                                                                            have hc₀_int : (↑c₀ : ℤ) * 119 = 30 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                            push_cast
                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                        · by_cases hp119_116 : p % 119 = 116
                                                                                          · -- p ≡ 116 (mod 119): (α=10, r=1, s=3), M = 4·10·3·1 - 1 = 119
                                                                                            -- offset = (p+360)/119, b = 30, c = 10·(p + 3)/119
                                                                                            have hdiv119a : 119 ∣ (p + 360) := by omega
                                                                                            have hdiv119b : 119 ∣ (p + 3) := by omega
                                                                                            refine ⟨(p + 360) / 119, 30, 10 * ((p + 3) / 119), ?_, by norm_num, ?_, ?_⟩
                                                                                            · have : p % 2856 = 2377 := by omega
                                                                                              have h119div : (p + 360) / 119 * 119 = p + 360 := Nat.div_mul_cancel hdiv119a
                                                                                              omega
                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                            · set δ := (p + 360) / 119 with hδ_def
                                                                                              set c₀ := (p + 3) / 119 with hc₀_def
                                                                                              have hδ_mul : δ * 119 = p + 360 := Nat.div_mul_cancel hdiv119a
                                                                                              have hc₀_mul : c₀ * 119 = p + 3 := Nat.div_mul_cancel hdiv119b
                                                                                              have hδ_int : (↑δ : ℤ) * 119 = ↑p + 360 := by exact_mod_cast hδ_mul
                                                                                              have hc₀_int : (↑c₀ : ℤ) * 119 = ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                              push_cast
                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                          · by_cases hp119_117 : p % 119 = 117
                                                                                            · -- p ≡ 117 (mod 119): (α=15, r=1, s=2), M = 4·15·2·1 - 1 = 119
                                                                                              -- offset = (p+240)/119, b = 30, c = 15·(p + 2)/119
                                                                                              have hdiv119a : 119 ∣ (p + 240) := by omega
                                                                                              have hdiv119b : 119 ∣ (p + 2) := by omega
                                                                                              refine ⟨(p + 240) / 119, 30, 15 * ((p + 2) / 119), ?_, by norm_num, ?_, ?_⟩
                                                                                              · have : p % 2856 = 2497 := by omega
                                                                                                have h119div : (p + 240) / 119 * 119 = p + 240 := Nat.div_mul_cancel hdiv119a
                                                                                                omega
                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                              · set δ := (p + 240) / 119 with hδ_def
                                                                                                set c₀ := (p + 2) / 119 with hc₀_def
                                                                                                have hδ_mul : δ * 119 = p + 240 := Nat.div_mul_cancel hdiv119a
                                                                                                have hc₀_mul : c₀ * 119 = p + 2 := Nat.div_mul_cancel hdiv119b
                                                                                                have hδ_int : (↑δ : ℤ) * 119 = ↑p + 240 := by exact_mod_cast hδ_mul
                                                                                                have hc₀_int : (↑c₀ : ℤ) * 119 = ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                push_cast
                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                            · by_cases hp119_118 : p % 119 = 118
                                                                                              · -- p ≡ 118 (mod 119): (α=30, r=1, s=1), M = 4·30·1·1 - 1 = 119
                                                                                                -- offset = (p+120)/119, b = 30, c = 30·(p + 1)/119
                                                                                                have hdiv119a : 119 ∣ (p + 120) := by omega
                                                                                                have hdiv119b : 119 ∣ (p + 1) := by omega
                                                                                                refine ⟨(p + 120) / 119, 30, 30 * ((p + 1) / 119), ?_, by norm_num, ?_, ?_⟩
                                                                                                · have : p % 2856 = 2617 := by omega
                                                                                                  have h119div : (p + 120) / 119 * 119 = p + 120 := Nat.div_mul_cancel hdiv119a
                                                                                                  omega
                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                · set δ := (p + 120) / 119 with hδ_def
                                                                                                  set c₀ := (p + 1) / 119 with hc₀_def
                                                                                                  have hδ_mul : δ * 119 = p + 120 := Nat.div_mul_cancel hdiv119a
                                                                                                  have hc₀_mul : c₀ * 119 = p + 1 := Nat.div_mul_cancel hdiv119b
                                                                                                  have hδ_int : (↑δ : ℤ) * 119 = ↑p + 120 := by exact_mod_cast hδ_mul
                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 119 = ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                  push_cast
                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                              · -- M = 159 subcases via Lemma D.6
                                                                                                by_cases hp159_31 : p % 159 = 31
                                                                                                · -- p ≡ 31 (mod 159): (α=2, r=5, s=4), M = 4·2·4·5 - 1 = 159
                                                                                                  -- offset = (p+128)/159, b = 40, c = 10·(5 * p + 4)/159
                                                                                                  have hdiv159a : 159 ∣ (p + 128) := by omega
                                                                                                  have hdiv159b : 159 ∣ (5 * p + 4) := by omega
                                                                                                  refine ⟨(p + 128) / 159, 40, 10 * ((5 * p + 4) / 159), ?_, by norm_num, ?_, ?_⟩
                                                                                                  · have : p % 1272 = 985 := by omega
                                                                                                    have h159div : (p + 128) / 159 * 159 = p + 128 := Nat.div_mul_cancel hdiv159a
                                                                                                    omega
                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                  · set δ := (p + 128) / 159 with hδ_def
                                                                                                    set c₀ := (5 * p + 4) / 159 with hc₀_def
                                                                                                    have hδ_mul : δ * 159 = p + 128 := Nat.div_mul_cancel hdiv159a
                                                                                                    have hc₀_mul : c₀ * 159 = 5 * p + 4 := Nat.div_mul_cancel hdiv159b
                                                                                                    have hδ_int : (↑δ : ℤ) * 159 = ↑p + 128 := by exact_mod_cast hδ_mul
                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 159 = 5 * ↑p + 4 := by exact_mod_cast hc₀_mul
                                                                                                    push_cast
                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                · by_cases hp159_79 : p % 159 = 79
                                                                                                  · -- p ≡ 79 (mod 159): (α=5, r=4, s=2), M = 4·5·2·4 - 1 = 159
                                                                                                    -- offset = (p+80)/159, b = 40, c = 20·(4 * p + 2)/159
                                                                                                    have hdiv159a : 159 ∣ (p + 80) := by omega
                                                                                                    have hdiv159b : 159 ∣ (4 * p + 2) := by omega
                                                                                                    refine ⟨(p + 80) / 159, 40, 20 * ((4 * p + 2) / 159), ?_, by norm_num, ?_, ?_⟩
                                                                                                    · have : p % 1272 = 1033 := by omega
                                                                                                      have h159div : (p + 80) / 159 * 159 = p + 80 := Nat.div_mul_cancel hdiv159a
                                                                                                      omega
                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                    · set δ := (p + 80) / 159 with hδ_def
                                                                                                      set c₀ := (4 * p + 2) / 159 with hc₀_def
                                                                                                      have hδ_mul : δ * 159 = p + 80 := Nat.div_mul_cancel hdiv159a
                                                                                                      have hc₀_mul : c₀ * 159 = 4 * p + 2 := Nat.div_mul_cancel hdiv159b
                                                                                                      have hδ_int : (↑δ : ℤ) * 159 = ↑p + 80 := by exact_mod_cast hδ_mul
                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 159 = 4 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                      push_cast
                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                  · by_cases hp159_118 : p % 159 = 118
                                                                                                    · -- p ≡ 118 (mod 159): (α=2, r=4, s=5), M = 4·2·5·4 - 1 = 159
                                                                                                      -- offset = (p+200)/159, b = 40, c = 8·(4 * p + 5)/159
                                                                                                      have hdiv159a : 159 ∣ (p + 200) := by omega
                                                                                                      have hdiv159b : 159 ∣ (4 * p + 5) := by omega
                                                                                                      refine ⟨(p + 200) / 159, 40, 8 * ((4 * p + 5) / 159), ?_, by norm_num, ?_, ?_⟩
                                                                                                      · have : p % 1272 = 913 := by omega
                                                                                                        have h159div : (p + 200) / 159 * 159 = p + 200 := Nat.div_mul_cancel hdiv159a
                                                                                                        omega
                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                      · set δ := (p + 200) / 159 with hδ_def
                                                                                                        set c₀ := (4 * p + 5) / 159 with hc₀_def
                                                                                                        have hδ_mul : δ * 159 = p + 200 := Nat.div_mul_cancel hdiv159a
                                                                                                        have hc₀_mul : c₀ * 159 = 4 * p + 5 := Nat.div_mul_cancel hdiv159b
                                                                                                        have hδ_int : (↑δ : ℤ) * 159 = ↑p + 200 := by exact_mod_cast hδ_mul
                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 159 = 4 * ↑p + 5 := by exact_mod_cast hc₀_mul
                                                                                                        push_cast
                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                    · by_cases hp159_127 : p % 159 = 127
                                                                                                      · -- p ≡ 127 (mod 159): (α=2, r=10, s=2), M = 4·2·2·10 - 1 = 159
                                                                                                        -- offset = (p+32)/159, b = 40, c = 20·(10 * p + 2)/159
                                                                                                        have hdiv159a : 159 ∣ (p + 32) := by omega
                                                                                                        have hdiv159b : 159 ∣ (10 * p + 2) := by omega
                                                                                                        refine ⟨(p + 32) / 159, 40, 20 * ((10 * p + 2) / 159), ?_, by norm_num, ?_, ?_⟩
                                                                                                        · have : p % 1272 = 1081 := by omega
                                                                                                          have h159div : (p + 32) / 159 * 159 = p + 32 := Nat.div_mul_cancel hdiv159a
                                                                                                          omega
                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                        · set δ := (p + 32) / 159 with hδ_def
                                                                                                          set c₀ := (10 * p + 2) / 159 with hc₀_def
                                                                                                          have hδ_mul : δ * 159 = p + 32 := Nat.div_mul_cancel hdiv159a
                                                                                                          have hc₀_mul : c₀ * 159 = 10 * p + 2 := Nat.div_mul_cancel hdiv159b
                                                                                                          have hδ_int : (↑δ : ℤ) * 159 = ↑p + 32 := by exact_mod_cast hδ_mul
                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 159 = 10 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                          push_cast
                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                      · by_cases hp159_139 : p % 159 = 139
                                                                                                        · -- p ≡ 139 (mod 159): (α=5, r=8, s=1), M = 4·5·1·8 - 1 = 159
                                                                                                          -- offset = (p+20)/159, b = 40, c = 40·(8 * p + 1)/159
                                                                                                          have hdiv159a : 159 ∣ (p + 20) := by omega
                                                                                                          have hdiv159b : 159 ∣ (8 * p + 1) := by omega
                                                                                                          refine ⟨(p + 20) / 159, 40, 40 * ((8 * p + 1) / 159), ?_, by norm_num, ?_, ?_⟩
                                                                                                          · have : p % 1272 = 457 := by omega
                                                                                                            have h159div : (p + 20) / 159 * 159 = p + 20 := Nat.div_mul_cancel hdiv159a
                                                                                                            omega
                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                          · set δ := (p + 20) / 159 with hδ_def
                                                                                                            set c₀ := (8 * p + 1) / 159 with hc₀_def
                                                                                                            have hδ_mul : δ * 159 = p + 20 := Nat.div_mul_cancel hdiv159a
                                                                                                            have hc₀_mul : c₀ * 159 = 8 * p + 1 := Nat.div_mul_cancel hdiv159b
                                                                                                            have hδ_int : (↑δ : ℤ) * 159 = ↑p + 20 := by exact_mod_cast hδ_mul
                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 159 = 8 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                            push_cast
                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                        · by_cases hp159_151 : p % 159 = 151
                                                                                                          · -- p ≡ 151 (mod 159): (α=2, r=20, s=1), M = 4·2·1·20 - 1 = 159
                                                                                                            -- offset = (p+8)/159, b = 40, c = 40·(20 * p + 1)/159
                                                                                                            have hdiv159a : 159 ∣ (p + 8) := by omega
                                                                                                            have hdiv159b : 159 ∣ (20 * p + 1) := by omega
                                                                                                            refine ⟨(p + 8) / 159, 40, 40 * ((20 * p + 1) / 159), ?_, by norm_num, ?_, ?_⟩
                                                                                                            · have : p % 1272 = 1105 := by omega
                                                                                                              have h159div : (p + 8) / 159 * 159 = p + 8 := Nat.div_mul_cancel hdiv159a
                                                                                                              omega
                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                            · set δ := (p + 8) / 159 with hδ_def
                                                                                                              set c₀ := (20 * p + 1) / 159 with hc₀_def
                                                                                                              have hδ_mul : δ * 159 = p + 8 := Nat.div_mul_cancel hdiv159a
                                                                                                              have hc₀_mul : c₀ * 159 = 20 * p + 1 := Nat.div_mul_cancel hdiv159b
                                                                                                              have hδ_int : (↑δ : ℤ) * 159 = ↑p + 8 := by exact_mod_cast hδ_mul
                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 159 = 20 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                              push_cast
                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                          · by_cases hp159_154 : p % 159 = 154
                                                                                                            · -- p ≡ 154 (mod 159): (α=2, r=2, s=10), M = 4·2·10·2 - 1 = 159
                                                                                                              -- offset = (p+800)/159, b = 40, c = 4·(2 * p + 10)/159
                                                                                                              have hdiv159a : 159 ∣ (p + 800) := by omega
                                                                                                              have hdiv159b : 159 ∣ (2 * p + 10) := by omega
                                                                                                              refine ⟨(p + 800) / 159, 40, 4 * ((2 * p + 10) / 159), ?_, by norm_num, ?_, ?_⟩
                                                                                                              · have : p % 1272 = 313 := by omega
                                                                                                                have h159div : (p + 800) / 159 * 159 = p + 800 := Nat.div_mul_cancel hdiv159a
                                                                                                                omega
                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                              · set δ := (p + 800) / 159 with hδ_def
                                                                                                                set c₀ := (2 * p + 10) / 159 with hc₀_def
                                                                                                                have hδ_mul : δ * 159 = p + 800 := Nat.div_mul_cancel hdiv159a
                                                                                                                have hc₀_mul : c₀ * 159 = 2 * p + 10 := Nat.div_mul_cancel hdiv159b
                                                                                                                have hδ_int : (↑δ : ℤ) * 159 = ↑p + 800 := by exact_mod_cast hδ_mul
                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 159 = 2 * ↑p + 10 := by exact_mod_cast hc₀_mul
                                                                                                                push_cast
                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                            · by_cases hp159_157 : p % 159 = 157
                                                                                                              · -- p ≡ 157 (mod 159): (α=5, r=2, s=4), M = 4·5·4·2 - 1 = 159
                                                                                                                -- offset = (p+320)/159, b = 40, c = 10·(2 * p + 4)/159
                                                                                                                have hdiv159a : 159 ∣ (p + 320) := by omega
                                                                                                                have hdiv159b : 159 ∣ (2 * p + 4) := by omega
                                                                                                                refine ⟨(p + 320) / 159, 40, 10 * ((2 * p + 4) / 159), ?_, by norm_num, ?_, ?_⟩
                                                                                                                · have : p % 1272 = 793 := by omega
                                                                                                                  have h159div : (p + 320) / 159 * 159 = p + 320 := Nat.div_mul_cancel hdiv159a
                                                                                                                  omega
                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                · set δ := (p + 320) / 159 with hδ_def
                                                                                                                  set c₀ := (2 * p + 4) / 159 with hc₀_def
                                                                                                                  have hδ_mul : δ * 159 = p + 320 := Nat.div_mul_cancel hdiv159a
                                                                                                                  have hc₀_mul : c₀ * 159 = 2 * p + 4 := Nat.div_mul_cancel hdiv159b
                                                                                                                  have hδ_int : (↑δ : ℤ) * 159 = ↑p + 320 := by exact_mod_cast hδ_mul
                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 159 = 2 * ↑p + 4 := by exact_mod_cast hc₀_mul
                                                                                                                  push_cast
                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                              · -- M = 71 subcases via Lemma D.6
                                                                                                                by_cases hp71_23 : p % 71 = 23
                                                                                                                · -- p ≡ 23 (mod 71): (α=3, r=3, s=2), M = 4·3·2·3 - 1 = 71
                                                                                                                  -- offset = (p+48)/71, b = 18, c = 9·(3 * p + 2)/71
                                                                                                                  have hdiv71a : 71 ∣ (p + 48) := by omega
                                                                                                                  have hdiv71b : 71 ∣ (3 * p + 2) := by omega
                                                                                                                  refine ⟨(p + 48) / 71, 18, 9 * ((3 * p + 2) / 71), ?_, by norm_num, ?_, ?_⟩
                                                                                                                  · have : p % 1704 = 1585 := by omega
                                                                                                                    have h71div : (p + 48) / 71 * 71 = p + 48 := Nat.div_mul_cancel hdiv71a
                                                                                                                    omega
                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                  · set δ := (p + 48) / 71 with hδ_def
                                                                                                                    set c₀ := (3 * p + 2) / 71 with hc₀_def
                                                                                                                    have hδ_mul : δ * 71 = p + 48 := Nat.div_mul_cancel hdiv71a
                                                                                                                    have hc₀_mul : c₀ * 71 = 3 * p + 2 := Nat.div_mul_cancel hdiv71b
                                                                                                                    have hδ_int : (↑δ : ℤ) * 71 = ↑p + 48 := by exact_mod_cast hδ_mul
                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 71 = 3 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                    push_cast
                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                · by_cases hp71_31 : p % 71 = 31
                                                                                                                  · -- p ≡ 31 (mod 71): (α=1, r=2, s=9), M = 4·1·9·2 - 1 = 71
                                                                                                                    -- offset = (p+324)/71, b = 18, c = 2·(2 * p + 9)/71
                                                                                                                    have hdiv71a : 71 ∣ (p + 324) := by omega
                                                                                                                    have hdiv71b : 71 ∣ (2 * p + 9) := by omega
                                                                                                                    refine ⟨(p + 324) / 71, 18, 2 * ((2 * p + 9) / 71), ?_, by norm_num, ?_, ?_⟩
                                                                                                                    · have : p % 1704 = 457 := by omega
                                                                                                                      have h71div : (p + 324) / 71 * 71 = p + 324 := Nat.div_mul_cancel hdiv71a
                                                                                                                      omega
                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                    · set δ := (p + 324) / 71 with hδ_def
                                                                                                                      set c₀ := (2 * p + 9) / 71 with hc₀_def
                                                                                                                      have hδ_mul : δ * 71 = p + 324 := Nat.div_mul_cancel hdiv71a
                                                                                                                      have hc₀_mul : c₀ * 71 = 2 * p + 9 := Nat.div_mul_cancel hdiv71b
                                                                                                                      have hδ_int : (↑δ : ℤ) * 71 = ↑p + 324 := by exact_mod_cast hδ_mul
                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 71 = 2 * ↑p + 9 := by exact_mod_cast hc₀_mul
                                                                                                                      push_cast
                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                  · by_cases hp71_34 : p % 71 = 34
                                                                                                                    · -- p ≡ 34 (mod 71): (α=3, r=2, s=3), M = 4·3·3·2 - 1 = 71
                                                                                                                      -- offset = (p+108)/71, b = 18, c = 6·(2 * p + 3)/71
                                                                                                                      have hdiv71a : 71 ∣ (p + 108) := by omega
                                                                                                                      have hdiv71b : 71 ∣ (2 * p + 3) := by omega
                                                                                                                      refine ⟨(p + 108) / 71, 18, 6 * ((2 * p + 3) / 71), ?_, by norm_num, ?_, ?_⟩
                                                                                                                      · have : p % 1704 = 673 := by omega
                                                                                                                        have h71div : (p + 108) / 71 * 71 = p + 108 := Nat.div_mul_cancel hdiv71a
                                                                                                                        omega
                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                      · set δ := (p + 108) / 71 with hδ_def
                                                                                                                        set c₀ := (2 * p + 3) / 71 with hc₀_def
                                                                                                                        have hδ_mul : δ * 71 = p + 108 := Nat.div_mul_cancel hdiv71a
                                                                                                                        have hc₀_mul : c₀ * 71 = 2 * p + 3 := Nat.div_mul_cancel hdiv71b
                                                                                                                        have hδ_int : (↑δ : ℤ) * 71 = ↑p + 108 := by exact_mod_cast hδ_mul
                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 71 = 2 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                        push_cast
                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                    · by_cases hp71_35 : p % 71 = 35
                                                                                                                      · -- p ≡ 35 (mod 71): (α=1, r=6, s=3), M = 4·1·3·6 - 1 = 71
                                                                                                                        -- offset = (p+36)/71, b = 18, c = 6·(6 * p + 3)/71
                                                                                                                        have hdiv71a : 71 ∣ (p + 36) := by omega
                                                                                                                        have hdiv71b : 71 ∣ (6 * p + 3) := by omega
                                                                                                                        refine ⟨(p + 36) / 71, 18, 6 * ((6 * p + 3) / 71), ?_, by norm_num, ?_, ?_⟩
                                                                                                                        · have : p % 1704 = 745 := by omega
                                                                                                                          have h71div : (p + 36) / 71 * 71 = p + 36 := Nat.div_mul_cancel hdiv71a
                                                                                                                          omega
                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                        · set δ := (p + 36) / 71 with hδ_def
                                                                                                                          set c₀ := (6 * p + 3) / 71 with hc₀_def
                                                                                                                          have hδ_mul : δ * 71 = p + 36 := Nat.div_mul_cancel hdiv71a
                                                                                                                          have hc₀_mul : c₀ * 71 = 6 * p + 3 := Nat.div_mul_cancel hdiv71b
                                                                                                                          have hδ_int : (↑δ : ℤ) * 71 = ↑p + 36 := by exact_mod_cast hδ_mul
                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 71 = 6 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                          push_cast
                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                      · by_cases hp71_47 : p % 71 = 47
                                                                                                                        · -- p ≡ 47 (mod 71): (α=6, r=3, s=1), M = 4·6·1·3 - 1 = 71
                                                                                                                          -- offset = (p+24)/71, b = 18, c = 18·(3 * p + 1)/71
                                                                                                                          have hdiv71a : 71 ∣ (p + 24) := by omega
                                                                                                                          have hdiv71b : 71 ∣ (3 * p + 1) := by omega
                                                                                                                          refine ⟨(p + 24) / 71, 18, 18 * ((3 * p + 1) / 71), ?_, by norm_num, ?_, ?_⟩
                                                                                                                          · have : p % 1704 = 1609 := by omega
                                                                                                                            have h71div : (p + 24) / 71 * 71 = p + 24 := Nat.div_mul_cancel hdiv71a
                                                                                                                            omega
                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                          · set δ := (p + 24) / 71 with hδ_def
                                                                                                                            set c₀ := (3 * p + 1) / 71 with hc₀_def
                                                                                                                            have hδ_mul : δ * 71 = p + 24 := Nat.div_mul_cancel hdiv71a
                                                                                                                            have hc₀_mul : c₀ * 71 = 3 * p + 1 := Nat.div_mul_cancel hdiv71b
                                                                                                                            have hδ_int : (↑δ : ℤ) * 71 = ↑p + 24 := by exact_mod_cast hδ_mul
                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 71 = 3 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                            push_cast
                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                        · by_cases hp71_53 : p % 71 = 53
                                                                                                                          · -- p ≡ 53 (mod 71): (α=1, r=1, s=18), M = 4·1·18·1 - 1 = 71
                                                                                                                            -- offset = (p+1296)/71, b = 18, c = (p + 18)/71
                                                                                                                            have hdiv71a : 71 ∣ (p + 1296) := by omega
                                                                                                                            have hdiv71b : 71 ∣ (p + 18) := by omega
                                                                                                                            refine ⟨(p + 1296) / 71, 18, (p + 18) / 71, ?_, by norm_num, ?_, ?_⟩
                                                                                                                            · have : p % 1704 = 337 := by omega
                                                                                                                              have h71div : (p + 1296) / 71 * 71 = p + 1296 := Nat.div_mul_cancel hdiv71a
                                                                                                                              omega
                                                                                                                            · exact Nat.div_pos (by omega) (by norm_num)
                                                                                                                            · set δ := (p + 1296) / 71 with hδ_def
                                                                                                                              set c₀ := (p + 18) / 71 with hc₀_def
                                                                                                                              have hδ_mul : δ * 71 = p + 1296 := Nat.div_mul_cancel hdiv71a
                                                                                                                              have hc₀_mul : c₀ * 71 = p + 18 := Nat.div_mul_cancel hdiv71b
                                                                                                                              have hδ_int : (↑δ : ℤ) * 71 = ↑p + 1296 := by exact_mod_cast hδ_mul
                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 71 = ↑p + 18 := by exact_mod_cast hc₀_mul
                                                                                                                              push_cast
                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                          · by_cases hp71_55 : p % 71 = 55
                                                                                                                            · -- p ≡ 55 (mod 71): (α=1, r=9, s=2), M = 4·1·2·9 - 1 = 71
                                                                                                                              -- offset = (p+16)/71, b = 18, c = 9·(9 * p + 2)/71
                                                                                                                              have hdiv71a : 71 ∣ (p + 16) := by omega
                                                                                                                              have hdiv71b : 71 ∣ (9 * p + 2) := by omega
                                                                                                                              refine ⟨(p + 16) / 71, 18, 9 * ((9 * p + 2) / 71), ?_, by norm_num, ?_, ?_⟩
                                                                                                                              · have : p % 1704 = 481 := by omega
                                                                                                                                have h71div : (p + 16) / 71 * 71 = p + 16 := Nat.div_mul_cancel hdiv71a
                                                                                                                                omega
                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                              · set δ := (p + 16) / 71 with hδ_def
                                                                                                                                set c₀ := (9 * p + 2) / 71 with hc₀_def
                                                                                                                                have hδ_mul : δ * 71 = p + 16 := Nat.div_mul_cancel hdiv71a
                                                                                                                                have hc₀_mul : c₀ * 71 = 9 * p + 2 := Nat.div_mul_cancel hdiv71b
                                                                                                                                have hδ_int : (↑δ : ℤ) * 71 = ↑p + 16 := by exact_mod_cast hδ_mul
                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 71 = 9 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                push_cast
                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                            · by_cases hp71_59 : p % 71 = 59
                                                                                                                              · -- p ≡ 59 (mod 71): (α=3, r=6, s=1), M = 4·3·1·6 - 1 = 71
                                                                                                                                -- offset = (p+12)/71, b = 18, c = 18·(6 * p + 1)/71
                                                                                                                                have hdiv71a : 71 ∣ (p + 12) := by omega
                                                                                                                                have hdiv71b : 71 ∣ (6 * p + 1) := by omega
                                                                                                                                refine ⟨(p + 12) / 71, 18, 18 * ((6 * p + 1) / 71), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                · have : p % 1704 = 769 := by omega
                                                                                                                                  have h71div : (p + 12) / 71 * 71 = p + 12 := Nat.div_mul_cancel hdiv71a
                                                                                                                                  omega
                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                · set δ := (p + 12) / 71 with hδ_def
                                                                                                                                  set c₀ := (6 * p + 1) / 71 with hc₀_def
                                                                                                                                  have hδ_mul : δ * 71 = p + 12 := Nat.div_mul_cancel hdiv71a
                                                                                                                                  have hc₀_mul : c₀ * 71 = 6 * p + 1 := Nat.div_mul_cancel hdiv71b
                                                                                                                                  have hδ_int : (↑δ : ℤ) * 71 = ↑p + 12 := by exact_mod_cast hδ_mul
                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 71 = 6 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                  push_cast
                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                              · by_cases hp71_62 : p % 71 = 62
                                                                                                                                · -- p ≡ 62 (mod 71): (α=2, r=1, s=9), M = 4·2·9·1 - 1 = 71
                                                                                                                                  -- offset = (p+648)/71, b = 18, c = 2·(p + 9)/71
                                                                                                                                  have hdiv71a : 71 ∣ (p + 648) := by omega
                                                                                                                                  have hdiv71b : 71 ∣ (p + 9) := by omega
                                                                                                                                  refine ⟨(p + 648) / 71, 18, 2 * ((p + 9) / 71), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                  · have : p % 1704 = 985 := by omega
                                                                                                                                    have h71div : (p + 648) / 71 * 71 = p + 648 := Nat.div_mul_cancel hdiv71a
                                                                                                                                    omega
                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                  · set δ := (p + 648) / 71 with hδ_def
                                                                                                                                    set c₀ := (p + 9) / 71 with hc₀_def
                                                                                                                                    have hδ_mul : δ * 71 = p + 648 := Nat.div_mul_cancel hdiv71a
                                                                                                                                    have hc₀_mul : c₀ * 71 = p + 9 := Nat.div_mul_cancel hdiv71b
                                                                                                                                    have hδ_int : (↑δ : ℤ) * 71 = ↑p + 648 := by exact_mod_cast hδ_mul
                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 71 = ↑p + 9 := by exact_mod_cast hc₀_mul
                                                                                                                                    push_cast
                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                · by_cases hp71_63 : p % 71 = 63
                                                                                                                                  · -- p ≡ 63 (mod 71): (α=2, r=9, s=1), M = 4·2·1·9 - 1 = 71
                                                                                                                                    -- offset = (p+8)/71, b = 18, c = 18·(9 * p + 1)/71
                                                                                                                                    have hdiv71a : 71 ∣ (p + 8) := by omega
                                                                                                                                    have hdiv71b : 71 ∣ (9 * p + 1) := by omega
                                                                                                                                    refine ⟨(p + 8) / 71, 18, 18 * ((9 * p + 1) / 71), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                    · have : p % 1704 = 1057 := by omega
                                                                                                                                      have h71div : (p + 8) / 71 * 71 = p + 8 := Nat.div_mul_cancel hdiv71a
                                                                                                                                      omega
                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                    · set δ := (p + 8) / 71 with hδ_def
                                                                                                                                      set c₀ := (9 * p + 1) / 71 with hc₀_def
                                                                                                                                      have hδ_mul : δ * 71 = p + 8 := Nat.div_mul_cancel hdiv71a
                                                                                                                                      have hc₀_mul : c₀ * 71 = 9 * p + 1 := Nat.div_mul_cancel hdiv71b
                                                                                                                                      have hδ_int : (↑δ : ℤ) * 71 = ↑p + 8 := by exact_mod_cast hδ_mul
                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 71 = 9 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                      push_cast
                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                  · by_cases hp71_65 : p % 71 = 65
                                                                                                                                    · -- p ≡ 65 (mod 71): (α=3, r=1, s=6), M = 4·3·6·1 - 1 = 71
                                                                                                                                      -- offset = (p+432)/71, b = 18, c = 3·(p + 6)/71
                                                                                                                                      have hdiv71a : 71 ∣ (p + 432) := by omega
                                                                                                                                      have hdiv71b : 71 ∣ (p + 6) := by omega
                                                                                                                                      refine ⟨(p + 432) / 71, 18, 3 * ((p + 6) / 71), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                      · have : p % 1704 = 1201 := by omega
                                                                                                                                        have h71div : (p + 432) / 71 * 71 = p + 432 := Nat.div_mul_cancel hdiv71a
                                                                                                                                        omega
                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                      · set δ := (p + 432) / 71 with hδ_def
                                                                                                                                        set c₀ := (p + 6) / 71 with hc₀_def
                                                                                                                                        have hδ_mul : δ * 71 = p + 432 := Nat.div_mul_cancel hdiv71a
                                                                                                                                        have hc₀_mul : c₀ * 71 = p + 6 := Nat.div_mul_cancel hdiv71b
                                                                                                                                        have hδ_int : (↑δ : ℤ) * 71 = ↑p + 432 := by exact_mod_cast hδ_mul
                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 71 = ↑p + 6 := by exact_mod_cast hc₀_mul
                                                                                                                                        push_cast
                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                    · by_cases hp71_67 : p % 71 = 67
                                                                                                                                      · -- p ≡ 67 (mod 71): (α=1, r=18, s=1), M = 4·1·1·18 - 1 = 71
                                                                                                                                        -- offset = (p+4)/71, b = 18, c = 18·(18 * p + 1)/71
                                                                                                                                        have hdiv71a : 71 ∣ (p + 4) := by omega
                                                                                                                                        have hdiv71b : 71 ∣ (18 * p + 1) := by omega
                                                                                                                                        refine ⟨(p + 4) / 71, 18, 18 * ((18 * p + 1) / 71), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                        · have : p % 1704 = 1345 := by omega
                                                                                                                                          have h71div : (p + 4) / 71 * 71 = p + 4 := Nat.div_mul_cancel hdiv71a
                                                                                                                                          omega
                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                        · set δ := (p + 4) / 71 with hδ_def
                                                                                                                                          set c₀ := (18 * p + 1) / 71 with hc₀_def
                                                                                                                                          have hδ_mul : δ * 71 = p + 4 := Nat.div_mul_cancel hdiv71a
                                                                                                                                          have hc₀_mul : c₀ * 71 = 18 * p + 1 := Nat.div_mul_cancel hdiv71b
                                                                                                                                          have hδ_int : (↑δ : ℤ) * 71 = ↑p + 4 := by exact_mod_cast hδ_mul
                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 71 = 18 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                          push_cast
                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                      · by_cases hp71_68 : p % 71 = 68
                                                                                                                                        · -- p ≡ 68 (mod 71): (α=6, r=1, s=3), M = 4·6·3·1 - 1 = 71
                                                                                                                                          -- offset = (p+216)/71, b = 18, c = 6·(p + 3)/71
                                                                                                                                          have hdiv71a : 71 ∣ (p + 216) := by omega
                                                                                                                                          have hdiv71b : 71 ∣ (p + 3) := by omega
                                                                                                                                          refine ⟨(p + 216) / 71, 18, 6 * ((p + 3) / 71), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                          · have : p % 1704 = 1417 := by omega
                                                                                                                                            have h71div : (p + 216) / 71 * 71 = p + 216 := Nat.div_mul_cancel hdiv71a
                                                                                                                                            omega
                                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                          · set δ := (p + 216) / 71 with hδ_def
                                                                                                                                            set c₀ := (p + 3) / 71 with hc₀_def
                                                                                                                                            have hδ_mul : δ * 71 = p + 216 := Nat.div_mul_cancel hdiv71a
                                                                                                                                            have hc₀_mul : c₀ * 71 = p + 3 := Nat.div_mul_cancel hdiv71b
                                                                                                                                            have hδ_int : (↑δ : ℤ) * 71 = ↑p + 216 := by exact_mod_cast hδ_mul
                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 71 = ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                            push_cast
                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                        · by_cases hp71_69 : p % 71 = 69
                                                                                                                                          · -- p ≡ 69 (mod 71): (α=1, r=3, s=6), M = 4·1·6·3 - 1 = 71
                                                                                                                                            -- offset = (p+144)/71, b = 18, c = 3·(3 * p + 6)/71
                                                                                                                                            have hdiv71a : 71 ∣ (p + 144) := by omega
                                                                                                                                            have hdiv71b : 71 ∣ (3 * p + 6) := by omega
                                                                                                                                            refine ⟨(p + 144) / 71, 18, 3 * ((3 * p + 6) / 71), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                            · have : p % 1704 = 1489 := by omega
                                                                                                                                              have h71div : (p + 144) / 71 * 71 = p + 144 := Nat.div_mul_cancel hdiv71a
                                                                                                                                              omega
                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                            · set δ := (p + 144) / 71 with hδ_def
                                                                                                                                              set c₀ := (3 * p + 6) / 71 with hc₀_def
                                                                                                                                              have hδ_mul : δ * 71 = p + 144 := Nat.div_mul_cancel hdiv71a
                                                                                                                                              have hc₀_mul : c₀ * 71 = 3 * p + 6 := Nat.div_mul_cancel hdiv71b
                                                                                                                                              have hδ_int : (↑δ : ℤ) * 71 = ↑p + 144 := by exact_mod_cast hδ_mul
                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 71 = 3 * ↑p + 6 := by exact_mod_cast hc₀_mul
                                                                                                                                              push_cast
                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                          · by_cases hp71_70 : p % 71 = 70
                                                                                                                                            · -- p ≡ 70 (mod 71): (α=2, r=3, s=3), M = 4·2·3·3 - 1 = 71
                                                                                                                                              -- offset = (p+72)/71, b = 18, c = 6·(3 * p + 3)/71
                                                                                                                                              have hdiv71a : 71 ∣ (p + 72) := by omega
                                                                                                                                              have hdiv71b : 71 ∣ (3 * p + 3) := by omega
                                                                                                                                              refine ⟨(p + 72) / 71, 18, 6 * ((3 * p + 3) / 71), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                              · have : p % 1704 = 1561 := by omega
                                                                                                                                                have h71div : (p + 72) / 71 * 71 = p + 72 := Nat.div_mul_cancel hdiv71a
                                                                                                                                                omega
                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                              · set δ := (p + 72) / 71 with hδ_def
                                                                                                                                                set c₀ := (3 * p + 3) / 71 with hc₀_def
                                                                                                                                                have hδ_mul : δ * 71 = p + 72 := Nat.div_mul_cancel hdiv71a
                                                                                                                                                have hc₀_mul : c₀ * 71 = 3 * p + 3 := Nat.div_mul_cancel hdiv71b
                                                                                                                                                have hδ_int : (↑δ : ℤ) * 71 = ↑p + 72 := by exact_mod_cast hδ_mul
                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 71 = 3 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                push_cast
                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                            · -- M = 95 subcases via Lemma D.6
                                                                                                                                              by_cases hp95_23 : p % 95 = 23
                                                                                                                                              · -- p ≡ 23 (mod 95): (α=2, r=4, s=3), M = 4·2·3·4 - 1 = 95
                                                                                                                                                -- offset = (p+72)/95, b = 24, c = 8·(4 * p + 3)/95
                                                                                                                                                have hdiv95a : 95 ∣ (p + 72) := by omega
                                                                                                                                                have hdiv95b : 95 ∣ (4 * p + 3) := by omega
                                                                                                                                                refine ⟨(p + 72) / 95, 24, 8 * ((4 * p + 3) / 95), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                · have : p % 2280 = 2113 := by omega
                                                                                                                                                  have h95div : (p + 72) / 95 * 95 = p + 72 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                  omega
                                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                · set δ := (p + 72) / 95 with hδ_def
                                                                                                                                                  set c₀ := (4 * p + 3) / 95 with hc₀_def
                                                                                                                                                  have hδ_mul : δ * 95 = p + 72 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                  have hc₀_mul : c₀ * 95 = 4 * p + 3 := Nat.div_mul_cancel hdiv95b
                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 95 = ↑p + 72 := by exact_mod_cast hδ_mul
                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 95 = 4 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                  push_cast
                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                              · by_cases hp95_29 : p % 95 = 29
                                                                                                                                                · -- p ≡ 29 (mod 95): (α=1, r=3, s=8), M = 4·1·8·3 - 1 = 95
                                                                                                                                                  -- offset = (p+256)/95, b = 24, c = 3·(3 * p + 8)/95
                                                                                                                                                  have hdiv95a : 95 ∣ (p + 256) := by omega
                                                                                                                                                  have hdiv95b : 95 ∣ (3 * p + 8) := by omega
                                                                                                                                                  refine ⟨(p + 256) / 95, 24, 3 * ((3 * p + 8) / 95), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                  · have : p % 2280 = 409 := by omega
                                                                                                                                                    have h95div : (p + 256) / 95 * 95 = p + 256 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                    omega
                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                  · set δ := (p + 256) / 95 with hδ_def
                                                                                                                                                    set c₀ := (3 * p + 8) / 95 with hc₀_def
                                                                                                                                                    have hδ_mul : δ * 95 = p + 256 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                    have hc₀_mul : c₀ * 95 = 3 * p + 8 := Nat.div_mul_cancel hdiv95b
                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 95 = ↑p + 256 := by exact_mod_cast hδ_mul
                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 95 = 3 * ↑p + 8 := by exact_mod_cast hc₀_mul
                                                                                                                                                    push_cast
                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                · by_cases hp95_31 : p % 95 = 31
                                                                                                                                                  · -- p ≡ 31 (mod 95): (α=1, r=6, s=4), M = 4·1·4·6 - 1 = 95
                                                                                                                                                    -- offset = (p+64)/95, b = 24, c = 6·(6 * p + 4)/95
                                                                                                                                                    have hdiv95a : 95 ∣ (p + 64) := by omega
                                                                                                                                                    have hdiv95b : 95 ∣ (6 * p + 4) := by omega
                                                                                                                                                    refine ⟨(p + 64) / 95, 24, 6 * ((6 * p + 4) / 95), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                    · have : p % 2280 = 601 := by omega
                                                                                                                                                      have h95div : (p + 64) / 95 * 95 = p + 64 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                      omega
                                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                    · set δ := (p + 64) / 95 with hδ_def
                                                                                                                                                      set c₀ := (6 * p + 4) / 95 with hc₀_def
                                                                                                                                                      have hδ_mul : δ * 95 = p + 64 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                      have hc₀_mul : c₀ * 95 = 6 * p + 4 := Nat.div_mul_cancel hdiv95b
                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 95 = ↑p + 64 := by exact_mod_cast hδ_mul
                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 95 = 6 * ↑p + 4 := by exact_mod_cast hc₀_mul
                                                                                                                                                      push_cast
                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                  · by_cases hp95_46 : p % 95 = 46
                                                                                                                                                    · -- p ≡ 46 (mod 95): (α=1, r=4, s=6), M = 4·1·6·4 - 1 = 95
                                                                                                                                                      -- offset = (p+144)/95, b = 24, c = 4·(4 * p + 6)/95
                                                                                                                                                      have hdiv95a : 95 ∣ (p + 144) := by omega
                                                                                                                                                      have hdiv95b : 95 ∣ (4 * p + 6) := by omega
                                                                                                                                                      refine ⟨(p + 144) / 95, 24, 4 * ((4 * p + 6) / 95), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                      · have : p % 2280 = 2041 := by omega
                                                                                                                                                        have h95div : (p + 144) / 95 * 95 = p + 144 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                        omega
                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                      · set δ := (p + 144) / 95 with hδ_def
                                                                                                                                                        set c₀ := (4 * p + 6) / 95 with hc₀_def
                                                                                                                                                        have hδ_mul : δ * 95 = p + 144 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                        have hc₀_mul : c₀ * 95 = 4 * p + 6 := Nat.div_mul_cancel hdiv95b
                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 95 = ↑p + 144 := by exact_mod_cast hδ_mul
                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 95 = 4 * ↑p + 6 := by exact_mod_cast hc₀_mul
                                                                                                                                                        push_cast
                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                    · by_cases hp95_47 : p % 95 = 47
                                                                                                                                                      · -- p ≡ 47 (mod 95): (α=3, r=4, s=2), M = 4·3·2·4 - 1 = 95
                                                                                                                                                        -- offset = (p+48)/95, b = 24, c = 12·(4 * p + 2)/95
                                                                                                                                                        have hdiv95a : 95 ∣ (p + 48) := by omega
                                                                                                                                                        have hdiv95b : 95 ∣ (4 * p + 2) := by omega
                                                                                                                                                        refine ⟨(p + 48) / 95, 24, 12 * ((4 * p + 2) / 95), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                        · have : p % 2280 = 2137 := by omega
                                                                                                                                                          have h95div : (p + 48) / 95 * 95 = p + 48 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                          omega
                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                        · set δ := (p + 48) / 95 with hδ_def
                                                                                                                                                          set c₀ := (4 * p + 2) / 95 with hc₀_def
                                                                                                                                                          have hδ_mul : δ * 95 = p + 48 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                          have hc₀_mul : c₀ * 95 = 4 * p + 2 := Nat.div_mul_cancel hdiv95b
                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 95 = ↑p + 48 := by exact_mod_cast hδ_mul
                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 95 = 4 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                          push_cast
                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                      · by_cases hp95_59 : p % 95 = 59
                                                                                                                                                        · -- p ≡ 59 (mod 95): (α=1, r=8, s=3), M = 4·1·3·8 - 1 = 95
                                                                                                                                                          -- offset = (p+36)/95, b = 24, c = 8·(8 * p + 3)/95
                                                                                                                                                          have hdiv95a : 95 ∣ (p + 36) := by omega
                                                                                                                                                          have hdiv95b : 95 ∣ (8 * p + 3) := by omega
                                                                                                                                                          refine ⟨(p + 36) / 95, 24, 8 * ((8 * p + 3) / 95), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                          · have : p % 2280 = 1009 := by omega
                                                                                                                                                            have h95div : (p + 36) / 95 * 95 = p + 36 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                            omega
                                                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                          · set δ := (p + 36) / 95 with hδ_def
                                                                                                                                                            set c₀ := (8 * p + 3) / 95 with hc₀_def
                                                                                                                                                            have hδ_mul : δ * 95 = p + 36 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                            have hc₀_mul : c₀ * 95 = 8 * p + 3 := Nat.div_mul_cancel hdiv95b
                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 95 = ↑p + 36 := by exact_mod_cast hδ_mul
                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 95 = 8 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                            push_cast
                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                        · by_cases hp95_62 : p % 95 = 62
                                                                                                                                                          · -- p ≡ 62 (mod 95): (α=2, r=3, s=4), M = 4·2·4·3 - 1 = 95
                                                                                                                                                            -- offset = (p+128)/95, b = 24, c = 6·(3 * p + 4)/95
                                                                                                                                                            have hdiv95a : 95 ∣ (p + 128) := by omega
                                                                                                                                                            have hdiv95b : 95 ∣ (3 * p + 4) := by omega
                                                                                                                                                            refine ⟨(p + 128) / 95, 24, 6 * ((3 * p + 4) / 95), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                            · have : p % 2280 = 1297 := by omega
                                                                                                                                                              have h95div : (p + 128) / 95 * 95 = p + 128 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                              omega
                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                            · set δ := (p + 128) / 95 with hδ_def
                                                                                                                                                              set c₀ := (3 * p + 4) / 95 with hc₀_def
                                                                                                                                                              have hδ_mul : δ * 95 = p + 128 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                              have hc₀_mul : c₀ * 95 = 3 * p + 4 := Nat.div_mul_cancel hdiv95b
                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 95 = ↑p + 128 := by exact_mod_cast hδ_mul
                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 95 = 3 * ↑p + 4 := by exact_mod_cast hc₀_mul
                                                                                                                                                              push_cast
                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                          · by_cases hp95_63 : p % 95 = 63
                                                                                                                                                            · -- p ≡ 63 (mod 95): (α=2, r=6, s=2), M = 4·2·2·6 - 1 = 95
                                                                                                                                                              -- offset = (p+32)/95, b = 24, c = 12·(6 * p + 2)/95
                                                                                                                                                              have hdiv95a : 95 ∣ (p + 32) := by omega
                                                                                                                                                              have hdiv95b : 95 ∣ (6 * p + 2) := by omega
                                                                                                                                                              refine ⟨(p + 32) / 95, 24, 12 * ((6 * p + 2) / 95), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                              · have : p % 2280 = 1393 := by omega
                                                                                                                                                                have h95div : (p + 32) / 95 * 95 = p + 32 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                                omega
                                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                              · set δ := (p + 32) / 95 with hδ_def
                                                                                                                                                                set c₀ := (6 * p + 2) / 95 with hc₀_def
                                                                                                                                                                have hδ_mul : δ * 95 = p + 32 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                                have hc₀_mul : c₀ * 95 = 6 * p + 2 := Nat.div_mul_cancel hdiv95b
                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 95 = ↑p + 32 := by exact_mod_cast hδ_mul
                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 95 = 6 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                push_cast
                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                            · by_cases hp95_71 : p % 95 = 71
                                                                                                                                                              · -- p ≡ 71 (mod 95): (α=6, r=4, s=1), M = 4·6·1·4 - 1 = 95
                                                                                                                                                                -- offset = (p+24)/95, b = 24, c = 24·(4 * p + 1)/95
                                                                                                                                                                have hdiv95a : 95 ∣ (p + 24) := by omega
                                                                                                                                                                have hdiv95b : 95 ∣ (4 * p + 1) := by omega
                                                                                                                                                                refine ⟨(p + 24) / 95, 24, 24 * ((4 * p + 1) / 95), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                · have : p % 2280 = 2161 := by omega
                                                                                                                                                                  have h95div : (p + 24) / 95 * 95 = p + 24 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                                  omega
                                                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                · set δ := (p + 24) / 95 with hδ_def
                                                                                                                                                                  set c₀ := (4 * p + 1) / 95 with hc₀_def
                                                                                                                                                                  have hδ_mul : δ * 95 = p + 24 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                                  have hc₀_mul : c₀ * 95 = 4 * p + 1 := Nat.div_mul_cancel hdiv95b
                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 95 = ↑p + 24 := by exact_mod_cast hδ_mul
                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 95 = 4 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                  push_cast
                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                              · by_cases hp95_79 : p % 95 = 79
                                                                                                                                                                · -- p ≡ 79 (mod 95): (α=1, r=12, s=2), M = 4·1·2·12 - 1 = 95
                                                                                                                                                                  -- offset = (p+16)/95, b = 24, c = 12·(12 * p + 2)/95
                                                                                                                                                                  have hdiv95a : 95 ∣ (p + 16) := by omega
                                                                                                                                                                  have hdiv95b : 95 ∣ (12 * p + 2) := by omega
                                                                                                                                                                  refine ⟨(p + 16) / 95, 24, 12 * ((12 * p + 2) / 95), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                  · have : p % 2280 = 649 := by omega
                                                                                                                                                                    have h95div : (p + 16) / 95 * 95 = p + 16 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                                    omega
                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                  · set δ := (p + 16) / 95 with hδ_def
                                                                                                                                                                    set c₀ := (12 * p + 2) / 95 with hc₀_def
                                                                                                                                                                    have hδ_mul : δ * 95 = p + 16 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                                    have hc₀_mul : c₀ * 95 = 12 * p + 2 := Nat.div_mul_cancel hdiv95b
                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 95 = ↑p + 16 := by exact_mod_cast hδ_mul
                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 95 = 12 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                    push_cast
                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                · by_cases hp95_83 : p % 95 = 83
                                                                                                                                                                  · -- p ≡ 83 (mod 95): (α=3, r=8, s=1), M = 4·3·1·8 - 1 = 95
                                                                                                                                                                    -- offset = (p+12)/95, b = 24, c = 24·(8 * p + 1)/95
                                                                                                                                                                    have hdiv95a : 95 ∣ (p + 12) := by omega
                                                                                                                                                                    have hdiv95b : 95 ∣ (8 * p + 1) := by omega
                                                                                                                                                                    refine ⟨(p + 12) / 95, 24, 24 * ((8 * p + 1) / 95), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                    · have : p % 2280 = 1033 := by omega
                                                                                                                                                                      have h95div : (p + 12) / 95 * 95 = p + 12 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                                      omega
                                                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                    · set δ := (p + 12) / 95 with hδ_def
                                                                                                                                                                      set c₀ := (8 * p + 1) / 95 with hc₀_def
                                                                                                                                                                      have hδ_mul : δ * 95 = p + 12 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                                      have hc₀_mul : c₀ * 95 = 8 * p + 1 := Nat.div_mul_cancel hdiv95b
                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 95 = ↑p + 12 := by exact_mod_cast hδ_mul
                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 95 = 8 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                      push_cast
                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                  · by_cases hp95_87 : p % 95 = 87
                                                                                                                                                                    · -- p ≡ 87 (mod 95): (α=2, r=12, s=1), M = 4·2·1·12 - 1 = 95
                                                                                                                                                                      -- offset = (p+8)/95, b = 24, c = 24·(12 * p + 1)/95
                                                                                                                                                                      have hdiv95a : 95 ∣ (p + 8) := by omega
                                                                                                                                                                      have hdiv95b : 95 ∣ (12 * p + 1) := by omega
                                                                                                                                                                      refine ⟨(p + 8) / 95, 24, 24 * ((12 * p + 1) / 95), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                      · have : p % 2280 = 1417 := by omega
                                                                                                                                                                        have h95div : (p + 8) / 95 * 95 = p + 8 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                                        omega
                                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                      · set δ := (p + 8) / 95 with hδ_def
                                                                                                                                                                        set c₀ := (12 * p + 1) / 95 with hc₀_def
                                                                                                                                                                        have hδ_mul : δ * 95 = p + 8 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                                        have hc₀_mul : c₀ * 95 = 12 * p + 1 := Nat.div_mul_cancel hdiv95b
                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 95 = ↑p + 8 := by exact_mod_cast hδ_mul
                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 95 = 12 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                        push_cast
                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                    · by_cases hp95_89 : p % 95 = 89
                                                                                                                                                                      · -- p ≡ 89 (mod 95): (α=1, r=2, s=12), M = 4·1·12·2 - 1 = 95
                                                                                                                                                                        -- offset = (p+576)/95, b = 24, c = 2·(2 * p + 12)/95
                                                                                                                                                                        have hdiv95a : 95 ∣ (p + 576) := by omega
                                                                                                                                                                        have hdiv95b : 95 ∣ (2 * p + 12) := by omega
                                                                                                                                                                        refine ⟨(p + 576) / 95, 24, 2 * ((2 * p + 12) / 95), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                        · have : p % 2280 = 1609 := by omega
                                                                                                                                                                          have h95div : (p + 576) / 95 * 95 = p + 576 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                                          omega
                                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                        · set δ := (p + 576) / 95 with hδ_def
                                                                                                                                                                          set c₀ := (2 * p + 12) / 95 with hc₀_def
                                                                                                                                                                          have hδ_mul : δ * 95 = p + 576 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                                          have hc₀_mul : c₀ * 95 = 2 * p + 12 := Nat.div_mul_cancel hdiv95b
                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 95 = ↑p + 576 := by exact_mod_cast hδ_mul
                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 95 = 2 * ↑p + 12 := by exact_mod_cast hc₀_mul
                                                                                                                                                                          push_cast
                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                      · by_cases hp95_91 : p % 95 = 91
                                                                                                                                                                        · -- p ≡ 91 (mod 95): (α=1, r=24, s=1), M = 4·1·1·24 - 1 = 95
                                                                                                                                                                          -- offset = (p+4)/95, b = 24, c = 24·(24 * p + 1)/95
                                                                                                                                                                          have hdiv95a : 95 ∣ (p + 4) := by omega
                                                                                                                                                                          have hdiv95b : 95 ∣ (24 * p + 1) := by omega
                                                                                                                                                                          refine ⟨(p + 4) / 95, 24, 24 * ((24 * p + 1) / 95), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                          · have : p % 2280 = 1801 := by omega
                                                                                                                                                                            have h95div : (p + 4) / 95 * 95 = p + 4 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                                            omega
                                                                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                          · set δ := (p + 4) / 95 with hδ_def
                                                                                                                                                                            set c₀ := (24 * p + 1) / 95 with hc₀_def
                                                                                                                                                                            have hδ_mul : δ * 95 = p + 4 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                                            have hc₀_mul : c₀ * 95 = 24 * p + 1 := Nat.div_mul_cancel hdiv95b
                                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 95 = ↑p + 4 := by exact_mod_cast hδ_mul
                                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 95 = 24 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                            push_cast
                                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                        · by_cases hp95_92 : p % 95 = 92
                                                                                                                                                                          · -- p ≡ 92 (mod 95): (α=2, r=2, s=6), M = 4·2·6·2 - 1 = 95
                                                                                                                                                                            -- offset = (p+288)/95, b = 24, c = 4·(2 * p + 6)/95
                                                                                                                                                                            have hdiv95a : 95 ∣ (p + 288) := by omega
                                                                                                                                                                            have hdiv95b : 95 ∣ (2 * p + 6) := by omega
                                                                                                                                                                            refine ⟨(p + 288) / 95, 24, 4 * ((2 * p + 6) / 95), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                            · have : p % 2280 = 1897 := by omega
                                                                                                                                                                              have h95div : (p + 288) / 95 * 95 = p + 288 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                                              omega
                                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                            · set δ := (p + 288) / 95 with hδ_def
                                                                                                                                                                              set c₀ := (2 * p + 6) / 95 with hc₀_def
                                                                                                                                                                              have hδ_mul : δ * 95 = p + 288 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                                              have hc₀_mul : c₀ * 95 = 2 * p + 6 := Nat.div_mul_cancel hdiv95b
                                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 95 = ↑p + 288 := by exact_mod_cast hδ_mul
                                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 95 = 2 * ↑p + 6 := by exact_mod_cast hc₀_mul
                                                                                                                                                                              push_cast
                                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                          · by_cases hp95_93 : p % 95 = 93
                                                                                                                                                                            · -- p ≡ 93 (mod 95): (α=3, r=2, s=4), M = 4·3·4·2 - 1 = 95
                                                                                                                                                                              -- offset = (p+192)/95, b = 24, c = 6·(2 * p + 4)/95
                                                                                                                                                                              have hdiv95a : 95 ∣ (p + 192) := by omega
                                                                                                                                                                              have hdiv95b : 95 ∣ (2 * p + 4) := by omega
                                                                                                                                                                              refine ⟨(p + 192) / 95, 24, 6 * ((2 * p + 4) / 95), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                              · have : p % 2280 = 1993 := by omega
                                                                                                                                                                                have h95div : (p + 192) / 95 * 95 = p + 192 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                                                omega
                                                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                              · set δ := (p + 192) / 95 with hδ_def
                                                                                                                                                                                set c₀ := (2 * p + 4) / 95 with hc₀_def
                                                                                                                                                                                have hδ_mul : δ * 95 = p + 192 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                                                have hc₀_mul : c₀ * 95 = 2 * p + 4 := Nat.div_mul_cancel hdiv95b
                                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 95 = ↑p + 192 := by exact_mod_cast hδ_mul
                                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 95 = 2 * ↑p + 4 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                push_cast
                                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                            · by_cases hp95_94 : p % 95 = 94
                                                                                                                                                                              · -- p ≡ 94 (mod 95): (α=6, r=2, s=2), M = 4·6·2·2 - 1 = 95
                                                                                                                                                                                -- offset = (p+96)/95, b = 24, c = 12·(2 * p + 2)/95
                                                                                                                                                                                have hdiv95a : 95 ∣ (p + 96) := by omega
                                                                                                                                                                                have hdiv95b : 95 ∣ (2 * p + 2) := by omega
                                                                                                                                                                                refine ⟨(p + 96) / 95, 24, 12 * ((2 * p + 2) / 95), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                · have : p % 2280 = 2089 := by omega
                                                                                                                                                                                  have h95div : (p + 96) / 95 * 95 = p + 96 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                                                  omega
                                                                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                · set δ := (p + 96) / 95 with hδ_def
                                                                                                                                                                                  set c₀ := (2 * p + 2) / 95 with hc₀_def
                                                                                                                                                                                  have hδ_mul : δ * 95 = p + 96 := Nat.div_mul_cancel hdiv95a
                                                                                                                                                                                  have hc₀_mul : c₀ * 95 = 2 * p + 2 := Nat.div_mul_cancel hdiv95b
                                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 95 = ↑p + 96 := by exact_mod_cast hδ_mul
                                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 95 = 2 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                  push_cast
                                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                              · -- M = 111 subcases via Lemma D.6
                                                                                                                                                                                by_cases hp111_52 : p % 111 = 52
                                                                                                                                                                                · -- p ≡ 52 (mod 111): (α=2, r=2, s=7), M = 4·2·7·2 - 1 = 111
                                                                                                                                                                                  -- offset = (p+392)/111, b = 28, c = 4·(2 * p + 7)/111
                                                                                                                                                                                  have hdiv111a : 111 ∣ (p + 392) := by omega
                                                                                                                                                                                  have hdiv111b : 111 ∣ (2 * p + 7) := by omega
                                                                                                                                                                                  refine ⟨(p + 392) / 111, 28, 4 * ((2 * p + 7) / 111), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                  · have : p % 888 = 385 := by omega
                                                                                                                                                                                    have h111div : (p + 392) / 111 * 111 = p + 392 := Nat.div_mul_cancel hdiv111a
                                                                                                                                                                                    omega
                                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                  · set δ := (p + 392) / 111 with hδ_def
                                                                                                                                                                                    set c₀ := (2 * p + 7) / 111 with hc₀_def
                                                                                                                                                                                    have hδ_mul : δ * 111 = p + 392 := Nat.div_mul_cancel hdiv111a
                                                                                                                                                                                    have hc₀_mul : c₀ * 111 = 2 * p + 7 := Nat.div_mul_cancel hdiv111b
                                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 111 = ↑p + 392 := by exact_mod_cast hδ_mul
                                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 111 = 2 * ↑p + 7 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                    push_cast
                                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                · by_cases hp111_55 : p % 111 = 55
                                                                                                                                                                                  · -- p ≡ 55 (mod 111): (α=14, r=2, s=1), M = 4·14·1·2 - 1 = 111
                                                                                                                                                                                    -- offset = (p+56)/111, b = 28, c = 28·(2 * p + 1)/111
                                                                                                                                                                                    have hdiv111a : 111 ∣ (p + 56) := by omega
                                                                                                                                                                                    have hdiv111b : 111 ∣ (2 * p + 1) := by omega
                                                                                                                                                                                    refine ⟨(p + 56) / 111, 28, 28 * ((2 * p + 1) / 111), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                    · have : p % 888 = 721 := by omega
                                                                                                                                                                                      have h111div : (p + 56) / 111 * 111 = p + 56 := Nat.div_mul_cancel hdiv111a
                                                                                                                                                                                      omega
                                                                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                    · set δ := (p + 56) / 111 with hδ_def
                                                                                                                                                                                      set c₀ := (2 * p + 1) / 111 with hc₀_def
                                                                                                                                                                                      have hδ_mul : δ * 111 = p + 56 := Nat.div_mul_cancel hdiv111a
                                                                                                                                                                                      have hc₀_mul : c₀ * 111 = 2 * p + 1 := Nat.div_mul_cancel hdiv111b
                                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 111 = ↑p + 56 := by exact_mod_cast hδ_mul
                                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 111 = 2 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                      push_cast
                                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                  · by_cases hp111_79 : p % 111 = 79
                                                                                                                                                                                    · -- p ≡ 79 (mod 111): (α=2, r=7, s=2), M = 4·2·2·7 - 1 = 111
                                                                                                                                                                                      -- offset = (p+32)/111, b = 28, c = 14·(7 * p + 2)/111
                                                                                                                                                                                      have hdiv111a : 111 ∣ (p + 32) := by omega
                                                                                                                                                                                      have hdiv111b : 111 ∣ (7 * p + 2) := by omega
                                                                                                                                                                                      refine ⟨(p + 32) / 111, 28, 14 * ((7 * p + 2) / 111), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                      · have : p % 888 = 745 := by omega
                                                                                                                                                                                        have h111div : (p + 32) / 111 * 111 = p + 32 := Nat.div_mul_cancel hdiv111a
                                                                                                                                                                                        omega
                                                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                      · set δ := (p + 32) / 111 with hδ_def
                                                                                                                                                                                        set c₀ := (7 * p + 2) / 111 with hc₀_def
                                                                                                                                                                                        have hδ_mul : δ * 111 = p + 32 := Nat.div_mul_cancel hdiv111a
                                                                                                                                                                                        have hc₀_mul : c₀ * 111 = 7 * p + 2 := Nat.div_mul_cancel hdiv111b
                                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 111 = ↑p + 32 := by exact_mod_cast hδ_mul
                                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 111 = 7 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                        push_cast
                                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                    · by_cases hp111_97 : p % 111 = 97
                                                                                                                                                                                      · -- p ≡ 97 (mod 111): (α=2, r=1, s=14), M = 4·2·14·1 - 1 = 111
                                                                                                                                                                                        -- offset = (p+1568)/111, b = 28, c = 2·(p + 14)/111
                                                                                                                                                                                        have hdiv111a : 111 ∣ (p + 1568) := by omega
                                                                                                                                                                                        have hdiv111b : 111 ∣ (p + 14) := by omega
                                                                                                                                                                                        refine ⟨(p + 1568) / 111, 28, 2 * ((p + 14) / 111), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                        · have : p % 888 = 97 := by omega
                                                                                                                                                                                          have h111div : (p + 1568) / 111 * 111 = p + 1568 := Nat.div_mul_cancel hdiv111a
                                                                                                                                                                                          omega
                                                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                        · set δ := (p + 1568) / 111 with hδ_def
                                                                                                                                                                                          set c₀ := (p + 14) / 111 with hc₀_def
                                                                                                                                                                                          have hδ_mul : δ * 111 = p + 1568 := Nat.div_mul_cancel hdiv111a
                                                                                                                                                                                          have hc₀_mul : c₀ * 111 = p + 14 := Nat.div_mul_cancel hdiv111b
                                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 111 = ↑p + 1568 := by exact_mod_cast hδ_mul
                                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 111 = ↑p + 14 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                          push_cast
                                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                      · by_cases hp111_103 : p % 111 = 103
                                                                                                                                                                                        · -- p ≡ 103 (mod 111): (α=2, r=14, s=1), M = 4·2·1·14 - 1 = 111
                                                                                                                                                                                          -- offset = (p+8)/111, b = 28, c = 28·(14 * p + 1)/111
                                                                                                                                                                                          have hdiv111a : 111 ∣ (p + 8) := by omega
                                                                                                                                                                                          have hdiv111b : 111 ∣ (14 * p + 1) := by omega
                                                                                                                                                                                          refine ⟨(p + 8) / 111, 28, 28 * ((14 * p + 1) / 111), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                          · have : p % 888 = 769 := by omega
                                                                                                                                                                                            have h111div : (p + 8) / 111 * 111 = p + 8 := Nat.div_mul_cancel hdiv111a
                                                                                                                                                                                            omega
                                                                                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                          · set δ := (p + 8) / 111 with hδ_def
                                                                                                                                                                                            set c₀ := (14 * p + 1) / 111 with hc₀_def
                                                                                                                                                                                            have hδ_mul : δ * 111 = p + 8 := Nat.div_mul_cancel hdiv111a
                                                                                                                                                                                            have hc₀_mul : c₀ * 111 = 14 * p + 1 := Nat.div_mul_cancel hdiv111b
                                                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 111 = ↑p + 8 := by exact_mod_cast hδ_mul
                                                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 111 = 14 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                            push_cast
                                                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                        · by_cases hp111_109 : p % 111 = 109
                                                                                                                                                                                          · -- p ≡ 109 (mod 111): (α=14, r=1, s=2), M = 4·14·2·1 - 1 = 111
                                                                                                                                                                                            -- offset = (p+224)/111, b = 28, c = 14·(p + 2)/111
                                                                                                                                                                                            have hdiv111a : 111 ∣ (p + 224) := by omega
                                                                                                                                                                                            have hdiv111b : 111 ∣ (p + 2) := by omega
                                                                                                                                                                                            refine ⟨(p + 224) / 111, 28, 14 * ((p + 2) / 111), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                            · have : p % 888 = 553 := by omega
                                                                                                                                                                                              have h111div : (p + 224) / 111 * 111 = p + 224 := Nat.div_mul_cancel hdiv111a
                                                                                                                                                                                              omega
                                                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                            · set δ := (p + 224) / 111 with hδ_def
                                                                                                                                                                                              set c₀ := (p + 2) / 111 with hc₀_def
                                                                                                                                                                                              have hδ_mul : δ * 111 = p + 224 := Nat.div_mul_cancel hdiv111a
                                                                                                                                                                                              have hc₀_mul : c₀ * 111 = p + 2 := Nat.div_mul_cancel hdiv111b
                                                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 111 = ↑p + 224 := by exact_mod_cast hδ_mul
                                                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 111 = ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                              push_cast
                                                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                          · -- M = 143 subcases via Lemma D.6
                                                                                                                                                                                            by_cases hp143_35 : p % 143 = 35
                                                                                                                                                                                            · -- p ≡ 35 (mod 143): (α=3, r=4, s=3), M = 4·3·3·4 - 1 = 143
                                                                                                                                                                                              -- offset = (p+108)/143, b = 36, c = 12·(4 * p + 3)/143
                                                                                                                                                                                              have hdiv143a : 143 ∣ (p + 108) := by omega
                                                                                                                                                                                              have hdiv143b : 143 ∣ (4 * p + 3) := by omega
                                                                                                                                                                                              refine ⟨(p + 108) / 143, 36, 12 * ((4 * p + 3) / 143), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                              · have : p % 3432 = 1465 := by omega
                                                                                                                                                                                                have h143div : (p + 108) / 143 * 143 = p + 108 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                omega
                                                                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                              · set δ := (p + 108) / 143 with hδ_def
                                                                                                                                                                                                set c₀ := (4 * p + 3) / 143 with hc₀_def
                                                                                                                                                                                                have hδ_mul : δ * 143 = p + 108 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                have hc₀_mul : c₀ * 143 = 4 * p + 3 := Nat.div_mul_cancel hdiv143b
                                                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 143 = ↑p + 108 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 143 = 4 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                push_cast
                                                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                            · by_cases hp143_47 : p % 143 = 47
                                                                                                                                                                                              · -- p ≡ 47 (mod 143): (α=6, r=3, s=2), M = 4·6·2·3 - 1 = 143
                                                                                                                                                                                                -- offset = (p+96)/143, b = 36, c = 18·(3 * p + 2)/143
                                                                                                                                                                                                have hdiv143a : 143 ∣ (p + 96) := by omega
                                                                                                                                                                                                have hdiv143b : 143 ∣ (3 * p + 2) := by omega
                                                                                                                                                                                                refine ⟨(p + 96) / 143, 36, 18 * ((3 * p + 2) / 143), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                · have : p % 3432 = 3193 := by omega
                                                                                                                                                                                                  have h143div : (p + 96) / 143 * 143 = p + 96 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                  omega
                                                                                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                · set δ := (p + 96) / 143 with hδ_def
                                                                                                                                                                                                  set c₀ := (3 * p + 2) / 143 with hc₀_def
                                                                                                                                                                                                  have hδ_mul : δ * 143 = p + 96 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                  have hc₀_mul : c₀ * 143 = 3 * p + 2 := Nat.div_mul_cancel hdiv143b
                                                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 143 = ↑p + 96 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 143 = 3 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                  push_cast
                                                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                              · by_cases hp143_67 : p % 143 = 67
                                                                                                                                                                                                · -- p ≡ 67 (mod 143): (α=2, r=2, s=9), M = 4·2·9·2 - 1 = 143
                                                                                                                                                                                                  -- offset = (p+648)/143, b = 36, c = 4·(2 * p + 9)/143
                                                                                                                                                                                                  have hdiv143a : 143 ∣ (p + 648) := by omega
                                                                                                                                                                                                  have hdiv143b : 143 ∣ (2 * p + 9) := by omega
                                                                                                                                                                                                  refine ⟨(p + 648) / 143, 36, 4 * ((2 * p + 9) / 143), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                  · have : p % 3432 = 2641 := by omega
                                                                                                                                                                                                    have h143div : (p + 648) / 143 * 143 = p + 648 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                    omega
                                                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                  · set δ := (p + 648) / 143 with hδ_def
                                                                                                                                                                                                    set c₀ := (2 * p + 9) / 143 with hc₀_def
                                                                                                                                                                                                    have hδ_mul : δ * 143 = p + 648 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                    have hc₀_mul : c₀ * 143 = 2 * p + 9 := Nat.div_mul_cancel hdiv143b
                                                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 143 = ↑p + 648 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 143 = 2 * ↑p + 9 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                    push_cast
                                                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                · by_cases hp143_70 : p % 143 = 70
                                                                                                                                                                                                  · -- p ≡ 70 (mod 143): (α=6, r=2, s=3), M = 4·6·3·2 - 1 = 143
                                                                                                                                                                                                    -- offset = (p+216)/143, b = 36, c = 12·(2 * p + 3)/143
                                                                                                                                                                                                    have hdiv143a : 143 ∣ (p + 216) := by omega
                                                                                                                                                                                                    have hdiv143b : 143 ∣ (2 * p + 3) := by omega
                                                                                                                                                                                                    refine ⟨(p + 216) / 143, 36, 12 * ((2 * p + 3) / 143), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                    · have : p % 3432 = 3073 := by omega
                                                                                                                                                                                                      have h143div : (p + 216) / 143 * 143 = p + 216 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                      omega
                                                                                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                    · set δ := (p + 216) / 143 with hδ_def
                                                                                                                                                                                                      set c₀ := (2 * p + 3) / 143 with hc₀_def
                                                                                                                                                                                                      have hδ_mul : δ * 143 = p + 216 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                      have hc₀_mul : c₀ * 143 = 2 * p + 3 := Nat.div_mul_cancel hdiv143b
                                                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 143 = ↑p + 216 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 143 = 2 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                      push_cast
                                                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                  · by_cases hp143_71 : p % 143 = 71
                                                                                                                                                                                                    · -- p ≡ 71 (mod 143): (α=2, r=6, s=3), M = 4·2·3·6 - 1 = 143
                                                                                                                                                                                                      -- offset = (p+72)/143, b = 36, c = 12·(6 * p + 3)/143
                                                                                                                                                                                                      have hdiv143a : 143 ∣ (p + 72) := by omega
                                                                                                                                                                                                      have hdiv143b : 143 ∣ (6 * p + 3) := by omega
                                                                                                                                                                                                      refine ⟨(p + 72) / 143, 36, 12 * ((6 * p + 3) / 143), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                      · have : p % 3432 = 3217 := by omega
                                                                                                                                                                                                        have h143div : (p + 72) / 143 * 143 = p + 72 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                        omega
                                                                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                      · set δ := (p + 72) / 143 with hδ_def
                                                                                                                                                                                                        set c₀ := (6 * p + 3) / 143 with hc₀_def
                                                                                                                                                                                                        have hδ_mul : δ * 143 = p + 72 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                        have hc₀_mul : c₀ * 143 = 6 * p + 3 := Nat.div_mul_cancel hdiv143b
                                                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 143 = ↑p + 72 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 143 = 6 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                        push_cast
                                                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                    · by_cases hp143_79 : p % 143 = 79
                                                                                                                                                                                                      · -- p ≡ 79 (mod 143): (α=1, r=9, s=4), M = 4·1·4·9 - 1 = 143
                                                                                                                                                                                                        -- offset = (p+64)/143, b = 36, c = 9·(9 * p + 4)/143
                                                                                                                                                                                                        have hdiv143a : 143 ∣ (p + 64) := by omega
                                                                                                                                                                                                        have hdiv143b : 143 ∣ (9 * p + 4) := by omega
                                                                                                                                                                                                        refine ⟨(p + 64) / 143, 36, 9 * ((9 * p + 4) / 143), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                        · have : p % 3432 = 937 := by omega
                                                                                                                                                                                                          have h143div : (p + 64) / 143 * 143 = p + 64 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                          omega
                                                                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                        · set δ := (p + 64) / 143 with hδ_def
                                                                                                                                                                                                          set c₀ := (9 * p + 4) / 143 with hc₀_def
                                                                                                                                                                                                          have hδ_mul : δ * 143 = p + 64 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                          have hc₀_mul : c₀ * 143 = 9 * p + 4 := Nat.div_mul_cancel hdiv143b
                                                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 143 = ↑p + 64 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 143 = 9 * ↑p + 4 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                          push_cast
                                                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                      · by_cases hp143_94 : p % 143 = 94
                                                                                                                                                                                                        · -- p ≡ 94 (mod 143): (α=3, r=3, s=4), M = 4·3·4·3 - 1 = 143
                                                                                                                                                                                                          -- offset = (p+192)/143, b = 36, c = 9·(3 * p + 4)/143
                                                                                                                                                                                                          have hdiv143a : 143 ∣ (p + 192) := by omega
                                                                                                                                                                                                          have hdiv143b : 143 ∣ (3 * p + 4) := by omega
                                                                                                                                                                                                          refine ⟨(p + 192) / 143, 36, 9 * ((3 * p + 4) / 143), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                          · have : p % 3432 = 3097 := by omega
                                                                                                                                                                                                            have h143div : (p + 192) / 143 * 143 = p + 192 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                            omega
                                                                                                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                          · set δ := (p + 192) / 143 with hδ_def
                                                                                                                                                                                                            set c₀ := (3 * p + 4) / 143 with hc₀_def
                                                                                                                                                                                                            have hδ_mul : δ * 143 = p + 192 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                            have hc₀_mul : c₀ * 143 = 3 * p + 4 := Nat.div_mul_cancel hdiv143b
                                                                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 143 = ↑p + 192 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 143 = 3 * ↑p + 4 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                            push_cast
                                                                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                        · by_cases hp143_95 : p % 143 = 95
                                                                                                                                                                                                          · -- p ≡ 95 (mod 143): (α=3, r=6, s=2), M = 4·3·2·6 - 1 = 143
                                                                                                                                                                                                            -- offset = (p+48)/143, b = 36, c = 18·(6 * p + 2)/143
                                                                                                                                                                                                            have hdiv143a : 143 ∣ (p + 48) := by omega
                                                                                                                                                                                                            have hdiv143b : 143 ∣ (6 * p + 2) := by omega
                                                                                                                                                                                                            refine ⟨(p + 48) / 143, 36, 18 * ((6 * p + 2) / 143), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                            · have : p % 3432 = 3241 := by omega
                                                                                                                                                                                                              have h143div : (p + 48) / 143 * 143 = p + 48 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                              omega
                                                                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                            · set δ := (p + 48) / 143 with hδ_def
                                                                                                                                                                                                              set c₀ := (6 * p + 2) / 143 with hc₀_def
                                                                                                                                                                                                              have hδ_mul : δ * 143 = p + 48 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                              have hc₀_mul : c₀ * 143 = 6 * p + 2 := Nat.div_mul_cancel hdiv143b
                                                                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 143 = ↑p + 48 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 143 = 6 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                              push_cast
                                                                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                          · by_cases hp143_105 : p % 143 = 105
                                                                                                                                                                                                            · -- p ≡ 105 (mod 143): (α=1, r=4, s=9), M = 4·1·9·4 - 1 = 143
                                                                                                                                                                                                              -- offset = (p+324)/143, b = 36, c = 4·(4 * p + 9)/143
                                                                                                                                                                                                              have hdiv143a : 143 ∣ (p + 324) := by omega
                                                                                                                                                                                                              have hdiv143b : 143 ∣ (4 * p + 9) := by omega
                                                                                                                                                                                                              refine ⟨(p + 324) / 143, 36, 4 * ((4 * p + 9) / 143), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                              · have : p % 3432 = 1249 := by omega
                                                                                                                                                                                                                have h143div : (p + 324) / 143 * 143 = p + 324 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                omega
                                                                                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                              · set δ := (p + 324) / 143 with hδ_def
                                                                                                                                                                                                                set c₀ := (4 * p + 9) / 143 with hc₀_def
                                                                                                                                                                                                                have hδ_mul : δ * 143 = p + 324 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                have hc₀_mul : c₀ * 143 = 4 * p + 9 := Nat.div_mul_cancel hdiv143b
                                                                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 143 = ↑p + 324 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 143 = 4 * ↑p + 9 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                push_cast
                                                                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                            · by_cases hp143_107 : p % 143 = 107
                                                                                                                                                                                                              · -- p ≡ 107 (mod 143): (α=1, r=12, s=3), M = 4·1·3·12 - 1 = 143
                                                                                                                                                                                                                -- offset = (p+36)/143, b = 36, c = 12·(12 * p + 3)/143
                                                                                                                                                                                                                have hdiv143a : 143 ∣ (p + 36) := by omega
                                                                                                                                                                                                                have hdiv143b : 143 ∣ (12 * p + 3) := by omega
                                                                                                                                                                                                                refine ⟨(p + 36) / 143, 36, 12 * ((12 * p + 3) / 143), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                · have : p % 3432 = 1537 := by omega
                                                                                                                                                                                                                  have h143div : (p + 36) / 143 * 143 = p + 36 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                  omega
                                                                                                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                · set δ := (p + 36) / 143 with hδ_def
                                                                                                                                                                                                                  set c₀ := (12 * p + 3) / 143 with hc₀_def
                                                                                                                                                                                                                  have hδ_mul : δ * 143 = p + 36 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                  have hc₀_mul : c₀ * 143 = 12 * p + 3 := Nat.div_mul_cancel hdiv143b
                                                                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 143 = ↑p + 36 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 143 = 12 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                  push_cast
                                                                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                              · by_cases hp143_111 : p % 143 = 111
                                                                                                                                                                                                                · -- p ≡ 111 (mod 143): (α=2, r=9, s=2), M = 4·2·2·9 - 1 = 143
                                                                                                                                                                                                                  -- offset = (p+32)/143, b = 36, c = 18·(9 * p + 2)/143
                                                                                                                                                                                                                  have hdiv143a : 143 ∣ (p + 32) := by omega
                                                                                                                                                                                                                  have hdiv143b : 143 ∣ (9 * p + 2) := by omega
                                                                                                                                                                                                                  refine ⟨(p + 32) / 143, 36, 18 * ((9 * p + 2) / 143), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                  · have : p % 3432 = 2113 := by omega
                                                                                                                                                                                                                    have h143div : (p + 32) / 143 * 143 = p + 32 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                    omega
                                                                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                  · set δ := (p + 32) / 143 with hδ_def
                                                                                                                                                                                                                    set c₀ := (9 * p + 2) / 143 with hc₀_def
                                                                                                                                                                                                                    have hδ_mul : δ * 143 = p + 32 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                    have hc₀_mul : c₀ * 143 = 9 * p + 2 := Nat.div_mul_cancel hdiv143b
                                                                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 143 = ↑p + 32 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 143 = 9 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                    push_cast
                                                                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                · by_cases hp143_119 : p % 143 = 119
                                                                                                                                                                                                                  · -- p ≡ 119 (mod 143): (α=6, r=6, s=1), M = 4·6·1·6 - 1 = 143
                                                                                                                                                                                                                    -- offset = (p+24)/143, b = 36, c = 36·(6 * p + 1)/143
                                                                                                                                                                                                                    have hdiv143a : 143 ∣ (p + 24) := by omega
                                                                                                                                                                                                                    have hdiv143b : 143 ∣ (6 * p + 1) := by omega
                                                                                                                                                                                                                    refine ⟨(p + 24) / 143, 36, 36 * ((6 * p + 1) / 143), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                    · have : p % 3432 = 3265 := by omega
                                                                                                                                                                                                                      have h143div : (p + 24) / 143 * 143 = p + 24 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                      omega
                                                                                                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                    · set δ := (p + 24) / 143 with hδ_def
                                                                                                                                                                                                                      set c₀ := (6 * p + 1) / 143 with hc₀_def
                                                                                                                                                                                                                      have hδ_mul : δ * 143 = p + 24 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                      have hc₀_mul : c₀ * 143 = 6 * p + 1 := Nat.div_mul_cancel hdiv143b
                                                                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 143 = ↑p + 24 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 143 = 6 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                      push_cast
                                                                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                  · by_cases hp143_125 : p % 143 = 125
                                                                                                                                                                                                                    · -- p ≡ 125 (mod 143): (α=2, r=1, s=18), M = 4·2·18·1 - 1 = 143
                                                                                                                                                                                                                      -- offset = (p+2592)/143, b = 36, c = 2·(p + 18)/143
                                                                                                                                                                                                                      have hdiv143a : 143 ∣ (p + 2592) := by omega
                                                                                                                                                                                                                      have hdiv143b : 143 ∣ (p + 18) := by omega
                                                                                                                                                                                                                      refine ⟨(p + 2592) / 143, 36, 2 * ((p + 18) / 143), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                      · have : p % 3432 = 697 := by omega
                                                                                                                                                                                                                        have h143div : (p + 2592) / 143 * 143 = p + 2592 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                        omega
                                                                                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                      · set δ := (p + 2592) / 143 with hδ_def
                                                                                                                                                                                                                        set c₀ := (p + 18) / 143 with hc₀_def
                                                                                                                                                                                                                        have hδ_mul : δ * 143 = p + 2592 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                        have hc₀_mul : c₀ * 143 = p + 18 := Nat.div_mul_cancel hdiv143b
                                                                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 143 = ↑p + 2592 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 143 = ↑p + 18 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                        push_cast
                                                                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                    · by_cases hp143_127 : p % 143 = 127
                                                                                                                                                                                                                      · -- p ≡ 127 (mod 143): (α=1, r=18, s=2), M = 4·1·2·18 - 1 = 143
                                                                                                                                                                                                                        -- offset = (p+16)/143, b = 36, c = 18·(18 * p + 2)/143
                                                                                                                                                                                                                        have hdiv143a : 143 ∣ (p + 16) := by omega
                                                                                                                                                                                                                        have hdiv143b : 143 ∣ (18 * p + 2) := by omega
                                                                                                                                                                                                                        refine ⟨(p + 16) / 143, 36, 18 * ((18 * p + 2) / 143), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                        · have : p % 3432 = 985 := by omega
                                                                                                                                                                                                                          have h143div : (p + 16) / 143 * 143 = p + 16 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                          omega
                                                                                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                        · set δ := (p + 16) / 143 with hδ_def
                                                                                                                                                                                                                          set c₀ := (18 * p + 2) / 143 with hc₀_def
                                                                                                                                                                                                                          have hδ_mul : δ * 143 = p + 16 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                          have hc₀_mul : c₀ * 143 = 18 * p + 2 := Nat.div_mul_cancel hdiv143b
                                                                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 143 = ↑p + 16 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 143 = 18 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                          push_cast
                                                                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                      · by_cases hp143_131 : p % 143 = 131
                                                                                                                                                                                                                        · -- p ≡ 131 (mod 143): (α=3, r=12, s=1), M = 4·3·1·12 - 1 = 143
                                                                                                                                                                                                                          -- offset = (p+12)/143, b = 36, c = 36·(12 * p + 1)/143
                                                                                                                                                                                                                          have hdiv143a : 143 ∣ (p + 12) := by omega
                                                                                                                                                                                                                          have hdiv143b : 143 ∣ (12 * p + 1) := by omega
                                                                                                                                                                                                                          refine ⟨(p + 12) / 143, 36, 36 * ((12 * p + 1) / 143), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                          · have : p % 3432 = 1561 := by omega
                                                                                                                                                                                                                            have h143div : (p + 12) / 143 * 143 = p + 12 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                            omega
                                                                                                                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                          · set δ := (p + 12) / 143 with hδ_def
                                                                                                                                                                                                                            set c₀ := (12 * p + 1) / 143 with hc₀_def
                                                                                                                                                                                                                            have hδ_mul : δ * 143 = p + 12 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                            have hc₀_mul : c₀ * 143 = 12 * p + 1 := Nat.div_mul_cancel hdiv143b
                                                                                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 143 = ↑p + 12 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 143 = 12 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                            push_cast
                                                                                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                        · by_cases hp143_134 : p % 143 = 134
                                                                                                                                                                                                                          · -- p ≡ 134 (mod 143): (α=1, r=2, s=18), M = 4·1·18·2 - 1 = 143
                                                                                                                                                                                                                            -- offset = (p+1296)/143, b = 36, c = 2·(2 * p + 18)/143
                                                                                                                                                                                                                            have hdiv143a : 143 ∣ (p + 1296) := by omega
                                                                                                                                                                                                                            have hdiv143b : 143 ∣ (2 * p + 18) := by omega
                                                                                                                                                                                                                            refine ⟨(p + 1296) / 143, 36, 2 * ((2 * p + 18) / 143), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                            · have : p % 3432 = 1993 := by omega
                                                                                                                                                                                                                              have h143div : (p + 1296) / 143 * 143 = p + 1296 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                              omega
                                                                                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                            · set δ := (p + 1296) / 143 with hδ_def
                                                                                                                                                                                                                              set c₀ := (2 * p + 18) / 143 with hc₀_def
                                                                                                                                                                                                                              have hδ_mul : δ * 143 = p + 1296 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                              have hc₀_mul : c₀ * 143 = 2 * p + 18 := Nat.div_mul_cancel hdiv143b
                                                                                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 143 = ↑p + 1296 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 143 = 2 * ↑p + 18 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                              push_cast
                                                                                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                          · by_cases hp143_135 : p % 143 = 135
                                                                                                                                                                                                                            · -- p ≡ 135 (mod 143): (α=2, r=18, s=1), M = 4·2·1·18 - 1 = 143
                                                                                                                                                                                                                              -- offset = (p+8)/143, b = 36, c = 36·(18 * p + 1)/143
                                                                                                                                                                                                                              have hdiv143a : 143 ∣ (p + 8) := by omega
                                                                                                                                                                                                                              have hdiv143b : 143 ∣ (18 * p + 1) := by omega
                                                                                                                                                                                                                              refine ⟨(p + 8) / 143, 36, 36 * ((18 * p + 1) / 143), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                              · have : p % 3432 = 2137 := by omega
                                                                                                                                                                                                                                have h143div : (p + 8) / 143 * 143 = p + 8 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                                omega
                                                                                                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                              · set δ := (p + 8) / 143 with hδ_def
                                                                                                                                                                                                                                set c₀ := (18 * p + 1) / 143 with hc₀_def
                                                                                                                                                                                                                                have hδ_mul : δ * 143 = p + 8 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                                have hc₀_mul : c₀ * 143 = 18 * p + 1 := Nat.div_mul_cancel hdiv143b
                                                                                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 143 = ↑p + 8 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 143 = 18 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                push_cast
                                                                                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                            · by_cases hp143_137 : p % 143 = 137
                                                                                                                                                                                                                              · -- p ≡ 137 (mod 143): (α=6, r=1, s=6), M = 4·6·6·1 - 1 = 143
                                                                                                                                                                                                                                -- offset = (p+864)/143, b = 36, c = 6·(p + 6)/143
                                                                                                                                                                                                                                have hdiv143a : 143 ∣ (p + 864) := by omega
                                                                                                                                                                                                                                have hdiv143b : 143 ∣ (p + 6) := by omega
                                                                                                                                                                                                                                refine ⟨(p + 864) / 143, 36, 6 * ((p + 6) / 143), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                · have : p % 3432 = 2425 := by omega
                                                                                                                                                                                                                                  have h143div : (p + 864) / 143 * 143 = p + 864 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                                  omega
                                                                                                                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                · set δ := (p + 864) / 143 with hδ_def
                                                                                                                                                                                                                                  set c₀ := (p + 6) / 143 with hc₀_def
                                                                                                                                                                                                                                  have hδ_mul : δ * 143 = p + 864 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                                  have hc₀_mul : c₀ * 143 = p + 6 := Nat.div_mul_cancel hdiv143b
                                                                                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 143 = ↑p + 864 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 143 = ↑p + 6 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                  push_cast
                                                                                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                              · by_cases hp143_139 : p % 143 = 139
                                                                                                                                                                                                                                · -- p ≡ 139 (mod 143): (α=1, r=36, s=1), M = 4·1·1·36 - 1 = 143
                                                                                                                                                                                                                                  -- offset = (p+4)/143, b = 36, c = 36·(36 * p + 1)/143
                                                                                                                                                                                                                                  have hdiv143a : 143 ∣ (p + 4) := by omega
                                                                                                                                                                                                                                  have hdiv143b : 143 ∣ (36 * p + 1) := by omega
                                                                                                                                                                                                                                  refine ⟨(p + 4) / 143, 36, 36 * ((36 * p + 1) / 143), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                  · have : p % 3432 = 2713 := by omega
                                                                                                                                                                                                                                    have h143div : (p + 4) / 143 * 143 = p + 4 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                                    omega
                                                                                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                  · set δ := (p + 4) / 143 with hδ_def
                                                                                                                                                                                                                                    set c₀ := (36 * p + 1) / 143 with hc₀_def
                                                                                                                                                                                                                                    have hδ_mul : δ * 143 = p + 4 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                                    have hc₀_mul : c₀ * 143 = 36 * p + 1 := Nat.div_mul_cancel hdiv143b
                                                                                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 143 = ↑p + 4 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 143 = 36 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                    push_cast
                                                                                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                · by_cases hp143_140 : p % 143 = 140
                                                                                                                                                                                                                                  · -- p ≡ 140 (mod 143): (α=3, r=2, s=6), M = 4·3·6·2 - 1 = 143
                                                                                                                                                                                                                                    -- offset = (p+432)/143, b = 36, c = 6·(2 * p + 6)/143
                                                                                                                                                                                                                                    have hdiv143a : 143 ∣ (p + 432) := by omega
                                                                                                                                                                                                                                    have hdiv143b : 143 ∣ (2 * p + 6) := by omega
                                                                                                                                                                                                                                    refine ⟨(p + 432) / 143, 36, 6 * ((2 * p + 6) / 143), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                    · have : p % 3432 = 2857 := by omega
                                                                                                                                                                                                                                      have h143div : (p + 432) / 143 * 143 = p + 432 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                                      omega
                                                                                                                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                    · set δ := (p + 432) / 143 with hδ_def
                                                                                                                                                                                                                                      set c₀ := (2 * p + 6) / 143 with hc₀_def
                                                                                                                                                                                                                                      have hδ_mul : δ * 143 = p + 432 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                                      have hc₀_mul : c₀ * 143 = 2 * p + 6 := Nat.div_mul_cancel hdiv143b
                                                                                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 143 = ↑p + 432 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 143 = 2 * ↑p + 6 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                      push_cast
                                                                                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                  · by_cases hp143_141 : p % 143 = 141
                                                                                                                                                                                                                                    · -- p ≡ 141 (mod 143): (α=2, r=3, s=6), M = 4·2·6·3 - 1 = 143
                                                                                                                                                                                                                                      -- offset = (p+288)/143, b = 36, c = 6·(3 * p + 6)/143
                                                                                                                                                                                                                                      have hdiv143a : 143 ∣ (p + 288) := by omega
                                                                                                                                                                                                                                      have hdiv143b : 143 ∣ (3 * p + 6) := by omega
                                                                                                                                                                                                                                      refine ⟨(p + 288) / 143, 36, 6 * ((3 * p + 6) / 143), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                      · have : p % 3432 = 3001 := by omega
                                                                                                                                                                                                                                        have h143div : (p + 288) / 143 * 143 = p + 288 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                                        omega
                                                                                                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                      · set δ := (p + 288) / 143 with hδ_def
                                                                                                                                                                                                                                        set c₀ := (3 * p + 6) / 143 with hc₀_def
                                                                                                                                                                                                                                        have hδ_mul : δ * 143 = p + 288 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                                        have hc₀_mul : c₀ * 143 = 3 * p + 6 := Nat.div_mul_cancel hdiv143b
                                                                                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 143 = ↑p + 288 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 143 = 3 * ↑p + 6 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                        push_cast
                                                                                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                    · by_cases hp143_142 : p % 143 = 142
                                                                                                                                                                                                                                      · -- p ≡ 142 (mod 143): (α=1, r=6, s=6), M = 4·1·6·6 - 1 = 143
                                                                                                                                                                                                                                        -- offset = (p+144)/143, b = 36, c = 6·(6 * p + 6)/143
                                                                                                                                                                                                                                        have hdiv143a : 143 ∣ (p + 144) := by omega
                                                                                                                                                                                                                                        have hdiv143b : 143 ∣ (6 * p + 6) := by omega
                                                                                                                                                                                                                                        refine ⟨(p + 144) / 143, 36, 6 * ((6 * p + 6) / 143), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                        · have : p % 3432 = 3145 := by omega
                                                                                                                                                                                                                                          have h143div : (p + 144) / 143 * 143 = p + 144 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                                          omega
                                                                                                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                        · set δ := (p + 144) / 143 with hδ_def
                                                                                                                                                                                                                                          set c₀ := (6 * p + 6) / 143 with hc₀_def
                                                                                                                                                                                                                                          have hδ_mul : δ * 143 = p + 144 := Nat.div_mul_cancel hdiv143a
                                                                                                                                                                                                                                          have hc₀_mul : c₀ * 143 = 6 * p + 6 := Nat.div_mul_cancel hdiv143b
                                                                                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 143 = ↑p + 144 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 143 = 6 * ↑p + 6 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                          push_cast
                                                                                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                      · -- M = 79 subcases via Lemma D.6
                                                                                                                                                                                                                                        by_cases hp79_15 : p % 79 = 15
                                                                                                                                                                                                                                        · -- p ≡ 15 (mod 79): (α=1, r=5, s=4), M = 4·1·4·5 - 1 = 79
                                                                                                                                                                                                                                          -- offset = (p+64)/79, b = 20, c = 5·(5 * p + 4)/79
                                                                                                                                                                                                                                          have hdiv79a : 79 ∣ (p + 64) := by omega
                                                                                                                                                                                                                                          have hdiv79b : 79 ∣ (5 * p + 4) := by omega
                                                                                                                                                                                                                                          refine ⟨(p + 64) / 79, 20, 5 * ((5 * p + 4) / 79), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                          · have : p % 1896 = 1753 := by omega
                                                                                                                                                                                                                                            have h79div : (p + 64) / 79 * 79 = p + 64 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                            omega
                                                                                                                                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                          · set δ := (p + 64) / 79 with hδ_def
                                                                                                                                                                                                                                            set c₀ := (5 * p + 4) / 79 with hc₀_def
                                                                                                                                                                                                                                            have hδ_mul : δ * 79 = p + 64 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                            have hc₀_mul : c₀ * 79 = 5 * p + 4 := Nat.div_mul_cancel hdiv79b
                                                                                                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 79 = ↑p + 64 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 79 = 5 * ↑p + 4 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                            push_cast
                                                                                                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                        · by_cases hp79_37 : p % 79 = 37
                                                                                                                                                                                                                                          · -- p ≡ 37 (mod 79): (α=2, r=2, s=5), M = 4·2·5·2 - 1 = 79
                                                                                                                                                                                                                                            -- offset = (p+200)/79, b = 20, c = 4·(2 * p + 5)/79
                                                                                                                                                                                                                                            have hdiv79a : 79 ∣ (p + 200) := by omega
                                                                                                                                                                                                                                            have hdiv79b : 79 ∣ (2 * p + 5) := by omega
                                                                                                                                                                                                                                            refine ⟨(p + 200) / 79, 20, 4 * ((2 * p + 5) / 79), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                            · have : p % 1896 = 985 := by omega
                                                                                                                                                                                                                                              have h79div : (p + 200) / 79 * 79 = p + 200 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                              omega
                                                                                                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                            · set δ := (p + 200) / 79 with hδ_def
                                                                                                                                                                                                                                              set c₀ := (2 * p + 5) / 79 with hc₀_def
                                                                                                                                                                                                                                              have hδ_mul : δ * 79 = p + 200 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                              have hc₀_mul : c₀ * 79 = 2 * p + 5 := Nat.div_mul_cancel hdiv79b
                                                                                                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 79 = ↑p + 200 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 79 = 2 * ↑p + 5 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                              push_cast
                                                                                                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                          · by_cases hp79_39 : p % 79 = 39
                                                                                                                                                                                                                                            · -- p ≡ 39 (mod 79): (α=10, r=2, s=1), M = 4·10·1·2 - 1 = 79
                                                                                                                                                                                                                                              -- offset = (p+40)/79, b = 20, c = 20·(2 * p + 1)/79
                                                                                                                                                                                                                                              have hdiv79a : 79 ∣ (p + 40) := by omega
                                                                                                                                                                                                                                              have hdiv79b : 79 ∣ (2 * p + 1) := by omega
                                                                                                                                                                                                                                              refine ⟨(p + 40) / 79, 20, 20 * ((2 * p + 1) / 79), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                              · have : p % 1896 = 1777 := by omega
                                                                                                                                                                                                                                                have h79div : (p + 40) / 79 * 79 = p + 40 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                                omega
                                                                                                                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                              · set δ := (p + 40) / 79 with hδ_def
                                                                                                                                                                                                                                                set c₀ := (2 * p + 1) / 79 with hc₀_def
                                                                                                                                                                                                                                                have hδ_mul : δ * 79 = p + 40 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                                have hc₀_mul : c₀ * 79 = 2 * p + 1 := Nat.div_mul_cancel hdiv79b
                                                                                                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 79 = ↑p + 40 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 79 = 2 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                push_cast
                                                                                                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                            · by_cases hp79_47 : p % 79 = 47
                                                                                                                                                                                                                                              · -- p ≡ 47 (mod 79): (α=2, r=5, s=2), M = 4·2·2·5 - 1 = 79
                                                                                                                                                                                                                                                -- offset = (p+32)/79, b = 20, c = 10·(5 * p + 2)/79
                                                                                                                                                                                                                                                have hdiv79a : 79 ∣ (p + 32) := by omega
                                                                                                                                                                                                                                                have hdiv79b : 79 ∣ (5 * p + 2) := by omega
                                                                                                                                                                                                                                                refine ⟨(p + 32) / 79, 20, 10 * ((5 * p + 2) / 79), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                · have : p % 1896 = 1153 := by omega
                                                                                                                                                                                                                                                  have h79div : (p + 32) / 79 * 79 = p + 32 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                                  omega
                                                                                                                                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                · set δ := (p + 32) / 79 with hδ_def
                                                                                                                                                                                                                                                  set c₀ := (5 * p + 2) / 79 with hc₀_def
                                                                                                                                                                                                                                                  have hδ_mul : δ * 79 = p + 32 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                                  have hc₀_mul : c₀ * 79 = 5 * p + 2 := Nat.div_mul_cancel hdiv79b
                                                                                                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 79 = ↑p + 32 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 79 = 5 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                  push_cast
                                                                                                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                              · by_cases hp79_58 : p % 79 = 58
                                                                                                                                                                                                                                                · -- p ≡ 58 (mod 79): (α=1, r=4, s=5), M = 4·1·5·4 - 1 = 79
                                                                                                                                                                                                                                                  -- offset = (p+100)/79, b = 20, c = 4·(4 * p + 5)/79
                                                                                                                                                                                                                                                  have hdiv79a : 79 ∣ (p + 100) := by omega
                                                                                                                                                                                                                                                  have hdiv79b : 79 ∣ (4 * p + 5) := by omega
                                                                                                                                                                                                                                                  refine ⟨(p + 100) / 79, 20, 4 * ((4 * p + 5) / 79), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                  · have : p % 1896 = 769 := by omega
                                                                                                                                                                                                                                                    have h79div : (p + 100) / 79 * 79 = p + 100 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                                    omega
                                                                                                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                  · set δ := (p + 100) / 79 with hδ_def
                                                                                                                                                                                                                                                    set c₀ := (4 * p + 5) / 79 with hc₀_def
                                                                                                                                                                                                                                                    have hδ_mul : δ * 79 = p + 100 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                                    have hc₀_mul : c₀ * 79 = 4 * p + 5 := Nat.div_mul_cancel hdiv79b
                                                                                                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 79 = ↑p + 100 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 79 = 4 * ↑p + 5 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                    push_cast
                                                                                                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                · by_cases hp79_59 : p % 79 = 59
                                                                                                                                                                                                                                                  · -- p ≡ 59 (mod 79): (α=5, r=4, s=1), M = 4·5·1·4 - 1 = 79
                                                                                                                                                                                                                                                    -- offset = (p+20)/79, b = 20, c = 20·(4 * p + 1)/79
                                                                                                                                                                                                                                                    have hdiv79a : 79 ∣ (p + 20) := by omega
                                                                                                                                                                                                                                                    have hdiv79b : 79 ∣ (4 * p + 1) := by omega
                                                                                                                                                                                                                                                    refine ⟨(p + 20) / 79, 20, 20 * ((4 * p + 1) / 79), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                    · have : p % 1896 = 217 := by omega
                                                                                                                                                                                                                                                      have h79div : (p + 20) / 79 * 79 = p + 20 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                                      omega
                                                                                                                                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                    · set δ := (p + 20) / 79 with hδ_def
                                                                                                                                                                                                                                                      set c₀ := (4 * p + 1) / 79 with hc₀_def
                                                                                                                                                                                                                                                      have hδ_mul : δ * 79 = p + 20 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                                      have hc₀_mul : c₀ * 79 = 4 * p + 1 := Nat.div_mul_cancel hdiv79b
                                                                                                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 79 = ↑p + 20 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 79 = 4 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                      push_cast
                                                                                                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                  · by_cases hp79_63 : p % 79 = 63
                                                                                                                                                                                                                                                    · -- p ≡ 63 (mod 79): (α=1, r=10, s=2), M = 4·1·2·10 - 1 = 79
                                                                                                                                                                                                                                                      -- offset = (p+16)/79, b = 20, c = 10·(10 * p + 2)/79
                                                                                                                                                                                                                                                      have hdiv79a : 79 ∣ (p + 16) := by omega
                                                                                                                                                                                                                                                      have hdiv79b : 79 ∣ (10 * p + 2) := by omega
                                                                                                                                                                                                                                                      refine ⟨(p + 16) / 79, 20, 10 * ((10 * p + 2) / 79), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                      · have : p % 1896 = 1801 := by omega
                                                                                                                                                                                                                                                        have h79div : (p + 16) / 79 * 79 = p + 16 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                                        omega
                                                                                                                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                      · set δ := (p + 16) / 79 with hδ_def
                                                                                                                                                                                                                                                        set c₀ := (10 * p + 2) / 79 with hc₀_def
                                                                                                                                                                                                                                                        have hδ_mul : δ * 79 = p + 16 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                                        have hc₀_mul : c₀ * 79 = 10 * p + 2 := Nat.div_mul_cancel hdiv79b
                                                                                                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 79 = ↑p + 16 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 79 = 10 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                        push_cast
                                                                                                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                    · by_cases hp79_69 : p % 79 = 69
                                                                                                                                                                                                                                                      · -- p ≡ 69 (mod 79): (α=2, r=1, s=10), M = 4·2·10·1 - 1 = 79
                                                                                                                                                                                                                                                        -- offset = (p+800)/79, b = 20, c = 2·(p + 10)/79
                                                                                                                                                                                                                                                        have hdiv79a : 79 ∣ (p + 800) := by omega
                                                                                                                                                                                                                                                        have hdiv79b : 79 ∣ (p + 10) := by omega
                                                                                                                                                                                                                                                        refine ⟨(p + 800) / 79, 20, 2 * ((p + 10) / 79), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                        · have : p % 1896 = 385 := by omega
                                                                                                                                                                                                                                                          have h79div : (p + 800) / 79 * 79 = p + 800 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                                          omega
                                                                                                                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                        · set δ := (p + 800) / 79 with hδ_def
                                                                                                                                                                                                                                                          set c₀ := (p + 10) / 79 with hc₀_def
                                                                                                                                                                                                                                                          have hδ_mul : δ * 79 = p + 800 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                                          have hc₀_mul : c₀ * 79 = p + 10 := Nat.div_mul_cancel hdiv79b
                                                                                                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 79 = ↑p + 800 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 79 = ↑p + 10 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                          push_cast
                                                                                                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                      · by_cases hp79_71 : p % 79 = 71
                                                                                                                                                                                                                                                        · -- p ≡ 71 (mod 79): (α=2, r=10, s=1), M = 4·2·1·10 - 1 = 79
                                                                                                                                                                                                                                                          -- offset = (p+8)/79, b = 20, c = 20·(10 * p + 1)/79
                                                                                                                                                                                                                                                          have hdiv79a : 79 ∣ (p + 8) := by omega
                                                                                                                                                                                                                                                          have hdiv79b : 79 ∣ (10 * p + 1) := by omega
                                                                                                                                                                                                                                                          refine ⟨(p + 8) / 79, 20, 20 * ((10 * p + 1) / 79), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                          · have : p % 1896 = 1177 := by omega
                                                                                                                                                                                                                                                            have h79div : (p + 8) / 79 * 79 = p + 8 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                                            omega
                                                                                                                                                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                          · set δ := (p + 8) / 79 with hδ_def
                                                                                                                                                                                                                                                            set c₀ := (10 * p + 1) / 79 with hc₀_def
                                                                                                                                                                                                                                                            have hδ_mul : δ * 79 = p + 8 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                                            have hc₀_mul : c₀ * 79 = 10 * p + 1 := Nat.div_mul_cancel hdiv79b
                                                                                                                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 79 = ↑p + 8 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 79 = 10 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                            push_cast
                                                                                                                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                        · by_cases hp79_74 : p % 79 = 74
                                                                                                                                                                                                                                                          · -- p ≡ 74 (mod 79): (α=1, r=2, s=10), M = 4·1·10·2 - 1 = 79
                                                                                                                                                                                                                                                            -- offset = (p+400)/79, b = 20, c = 2·(2 * p + 10)/79
                                                                                                                                                                                                                                                            have hdiv79a : 79 ∣ (p + 400) := by omega
                                                                                                                                                                                                                                                            have hdiv79b : 79 ∣ (2 * p + 10) := by omega
                                                                                                                                                                                                                                                            refine ⟨(p + 400) / 79, 20, 2 * ((2 * p + 10) / 79), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                            · have : p % 1896 = 1417 := by omega
                                                                                                                                                                                                                                                              have h79div : (p + 400) / 79 * 79 = p + 400 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                                              omega
                                                                                                                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                            · set δ := (p + 400) / 79 with hδ_def
                                                                                                                                                                                                                                                              set c₀ := (2 * p + 10) / 79 with hc₀_def
                                                                                                                                                                                                                                                              have hδ_mul : δ * 79 = p + 400 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                                              have hc₀_mul : c₀ * 79 = 2 * p + 10 := Nat.div_mul_cancel hdiv79b
                                                                                                                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 79 = ↑p + 400 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 79 = 2 * ↑p + 10 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                              push_cast
                                                                                                                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                          · by_cases hp79_75 : p % 79 = 75
                                                                                                                                                                                                                                                            · -- p ≡ 75 (mod 79): (α=1, r=20, s=1), M = 4·1·1·20 - 1 = 79
                                                                                                                                                                                                                                                              -- offset = (p+4)/79, b = 20, c = 20·(20 * p + 1)/79
                                                                                                                                                                                                                                                              have hdiv79a : 79 ∣ (p + 4) := by omega
                                                                                                                                                                                                                                                              have hdiv79b : 79 ∣ (20 * p + 1) := by omega
                                                                                                                                                                                                                                                              refine ⟨(p + 4) / 79, 20, 20 * ((20 * p + 1) / 79), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                              · have : p % 1896 = 865 := by omega
                                                                                                                                                                                                                                                                have h79div : (p + 4) / 79 * 79 = p + 4 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                                                omega
                                                                                                                                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                              · set δ := (p + 4) / 79 with hδ_def
                                                                                                                                                                                                                                                                set c₀ := (20 * p + 1) / 79 with hc₀_def
                                                                                                                                                                                                                                                                have hδ_mul : δ * 79 = p + 4 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                                                have hc₀_mul : c₀ * 79 = 20 * p + 1 := Nat.div_mul_cancel hdiv79b
                                                                                                                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 79 = ↑p + 4 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 79 = 20 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                push_cast
                                                                                                                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                            · by_cases hp79_77 : p % 79 = 77
                                                                                                                                                                                                                                                              · -- p ≡ 77 (mod 79): (α=10, r=1, s=2), M = 4·10·2·1 - 1 = 79
                                                                                                                                                                                                                                                                -- offset = (p+160)/79, b = 20, c = 10·(p + 2)/79
                                                                                                                                                                                                                                                                have hdiv79a : 79 ∣ (p + 160) := by omega
                                                                                                                                                                                                                                                                have hdiv79b : 79 ∣ (p + 2) := by omega
                                                                                                                                                                                                                                                                refine ⟨(p + 160) / 79, 20, 10 * ((p + 2) / 79), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                · have : p % 1896 = 1657 := by omega
                                                                                                                                                                                                                                                                  have h79div : (p + 160) / 79 * 79 = p + 160 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                                                  omega
                                                                                                                                                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                · set δ := (p + 160) / 79 with hδ_def
                                                                                                                                                                                                                                                                  set c₀ := (p + 2) / 79 with hc₀_def
                                                                                                                                                                                                                                                                  have hδ_mul : δ * 79 = p + 160 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                                                  have hc₀_mul : c₀ * 79 = p + 2 := Nat.div_mul_cancel hdiv79b
                                                                                                                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 79 = ↑p + 160 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 79 = ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                  push_cast
                                                                                                                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                              · by_cases hp79_78 : p % 79 = 78
                                                                                                                                                                                                                                                                · -- p ≡ 78 (mod 79): (α=5, r=2, s=2), M = 4·5·2·2 - 1 = 79
                                                                                                                                                                                                                                                                  -- offset = (p+80)/79, b = 20, c = 10·(2 * p + 2)/79
                                                                                                                                                                                                                                                                  have hdiv79a : 79 ∣ (p + 80) := by omega
                                                                                                                                                                                                                                                                  have hdiv79b : 79 ∣ (2 * p + 2) := by omega
                                                                                                                                                                                                                                                                  refine ⟨(p + 80) / 79, 20, 10 * ((2 * p + 2) / 79), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                  · have : p % 1896 = 1105 := by omega
                                                                                                                                                                                                                                                                    have h79div : (p + 80) / 79 * 79 = p + 80 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                                                    omega
                                                                                                                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                  · set δ := (p + 80) / 79 with hδ_def
                                                                                                                                                                                                                                                                    set c₀ := (2 * p + 2) / 79 with hc₀_def
                                                                                                                                                                                                                                                                    have hδ_mul : δ * 79 = p + 80 := Nat.div_mul_cancel hdiv79a
                                                                                                                                                                                                                                                                    have hc₀_mul : c₀ * 79 = 2 * p + 2 := Nat.div_mul_cancel hdiv79b
                                                                                                                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 79 = ↑p + 80 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 79 = 2 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                    push_cast
                                                                                                                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                · -- M = 87 subcases via Lemma D.6
                                                                                                                                                                                                                                                                  by_cases hp87_43 : p % 87 = 43
                                                                                                                                                                                                                                                                  · -- p ≡ 43 (mod 87): (α=11, r=2, s=1), M = 4·11·1·2 - 1 = 87
                                                                                                                                                                                                                                                                    -- offset = (p+44)/87, b = 22, c = 22·(2 * p + 1)/87
                                                                                                                                                                                                                                                                    have hdiv87a : 87 ∣ (p + 44) := by omega
                                                                                                                                                                                                                                                                    have hdiv87b : 87 ∣ (2 * p + 1) := by omega
                                                                                                                                                                                                                                                                    refine ⟨(p + 44) / 87, 22, 22 * ((2 * p + 1) / 87), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                    · have : p % 696 = 217 := by omega
                                                                                                                                                                                                                                                                      have h87div : (p + 44) / 87 * 87 = p + 44 := Nat.div_mul_cancel hdiv87a
                                                                                                                                                                                                                                                                      omega
                                                                                                                                                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                    · set δ := (p + 44) / 87 with hδ_def
                                                                                                                                                                                                                                                                      set c₀ := (2 * p + 1) / 87 with hc₀_def
                                                                                                                                                                                                                                                                      have hδ_mul : δ * 87 = p + 44 := Nat.div_mul_cancel hdiv87a
                                                                                                                                                                                                                                                                      have hc₀_mul : c₀ * 87 = 2 * p + 1 := Nat.div_mul_cancel hdiv87b
                                                                                                                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 87 = ↑p + 44 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 87 = 2 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                      push_cast
                                                                                                                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                  · by_cases hp87_76 : p % 87 = 76
                                                                                                                                                                                                                                                                    · -- p ≡ 76 (mod 87): (α=2, r=1, s=11), M = 4·2·11·1 - 1 = 87
                                                                                                                                                                                                                                                                      -- offset = (p+968)/87, b = 22, c = 2·(p + 11)/87
                                                                                                                                                                                                                                                                      have hdiv87a : 87 ∣ (p + 968) := by omega
                                                                                                                                                                                                                                                                      have hdiv87b : 87 ∣ (p + 11) := by omega
                                                                                                                                                                                                                                                                      refine ⟨(p + 968) / 87, 22, 2 * ((p + 11) / 87), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                      · have : p % 696 = 337 := by omega
                                                                                                                                                                                                                                                                        have h87div : (p + 968) / 87 * 87 = p + 968 := Nat.div_mul_cancel hdiv87a
                                                                                                                                                                                                                                                                        omega
                                                                                                                                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                      · set δ := (p + 968) / 87 with hδ_def
                                                                                                                                                                                                                                                                        set c₀ := (p + 11) / 87 with hc₀_def
                                                                                                                                                                                                                                                                        have hδ_mul : δ * 87 = p + 968 := Nat.div_mul_cancel hdiv87a
                                                                                                                                                                                                                                                                        have hc₀_mul : c₀ * 87 = p + 11 := Nat.div_mul_cancel hdiv87b
                                                                                                                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 87 = ↑p + 968 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 87 = ↑p + 11 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                        push_cast
                                                                                                                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                    · by_cases hp87_79 : p % 87 = 79
                                                                                                                                                                                                                                                                      · -- p ≡ 79 (mod 87): (α=2, r=11, s=1), M = 4·2·1·11 - 1 = 87
                                                                                                                                                                                                                                                                        -- offset = (p+8)/87, b = 22, c = 22·(11 * p + 1)/87
                                                                                                                                                                                                                                                                        have hdiv87a : 87 ∣ (p + 8) := by omega
                                                                                                                                                                                                                                                                        have hdiv87b : 87 ∣ (11 * p + 1) := by omega
                                                                                                                                                                                                                                                                        refine ⟨(p + 8) / 87, 22, 22 * ((11 * p + 1) / 87), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                        · have : p % 696 = 601 := by omega
                                                                                                                                                                                                                                                                          have h87div : (p + 8) / 87 * 87 = p + 8 := Nat.div_mul_cancel hdiv87a
                                                                                                                                                                                                                                                                          omega
                                                                                                                                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                        · set δ := (p + 8) / 87 with hδ_def
                                                                                                                                                                                                                                                                          set c₀ := (11 * p + 1) / 87 with hc₀_def
                                                                                                                                                                                                                                                                          have hδ_mul : δ * 87 = p + 8 := Nat.div_mul_cancel hdiv87a
                                                                                                                                                                                                                                                                          have hc₀_mul : c₀ * 87 = 11 * p + 1 := Nat.div_mul_cancel hdiv87b
                                                                                                                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 87 = ↑p + 8 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 87 = 11 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                          push_cast
                                                                                                                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                      · by_cases hp87_85 : p % 87 = 85
                                                                                                                                                                                                                                                                        · -- p ≡ 85 (mod 87): (α=11, r=1, s=2), M = 4·11·2·1 - 1 = 87
                                                                                                                                                                                                                                                                          -- offset = (p+176)/87, b = 22, c = 11·(p + 2)/87
                                                                                                                                                                                                                                                                          have hdiv87a : 87 ∣ (p + 176) := by omega
                                                                                                                                                                                                                                                                          have hdiv87b : 87 ∣ (p + 2) := by omega
                                                                                                                                                                                                                                                                          refine ⟨(p + 176) / 87, 22, 11 * ((p + 2) / 87), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                          · have : p % 696 = 433 := by omega
                                                                                                                                                                                                                                                                            have h87div : (p + 176) / 87 * 87 = p + 176 := Nat.div_mul_cancel hdiv87a
                                                                                                                                                                                                                                                                            omega
                                                                                                                                                                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                          · set δ := (p + 176) / 87 with hδ_def
                                                                                                                                                                                                                                                                            set c₀ := (p + 2) / 87 with hc₀_def
                                                                                                                                                                                                                                                                            have hδ_mul : δ * 87 = p + 176 := Nat.div_mul_cancel hdiv87a
                                                                                                                                                                                                                                                                            have hc₀_mul : c₀ * 87 = p + 2 := Nat.div_mul_cancel hdiv87b
                                                                                                                                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 87 = ↑p + 176 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 87 = ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                            push_cast
                                                                                                                                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                        · -- M = 151 subcases via Lemma D.6
                                                                                                                                                                                                                                                                          by_cases hp151_66 : p % 151 = 66
                                                                                                                                                                                                                                                                          · -- p ≡ 66 (mod 151): (α=1, r=2, s=19), M = 4·1·19·2 - 1 = 151
                                                                                                                                                                                                                                                                            -- offset = (p+1444)/151, b = 38, c = 2·(2 * p + 19)/151
                                                                                                                                                                                                                                                                            have hdiv151a : 151 ∣ (p + 1444) := by omega
                                                                                                                                                                                                                                                                            have hdiv151b : 151 ∣ (2 * p + 19) := by omega
                                                                                                                                                                                                                                                                            refine ⟨(p + 1444) / 151, 38, 2 * ((2 * p + 19) / 151), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                            · have : p % 3624 = 217 := by omega
                                                                                                                                                                                                                                                                              have h151div : (p + 1444) / 151 * 151 = p + 1444 := Nat.div_mul_cancel hdiv151a
                                                                                                                                                                                                                                                                              omega
                                                                                                                                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                            · set δ := (p + 1444) / 151 with hδ_def
                                                                                                                                                                                                                                                                              set c₀ := (2 * p + 19) / 151 with hc₀_def
                                                                                                                                                                                                                                                                              have hδ_mul : δ * 151 = p + 1444 := Nat.div_mul_cancel hdiv151a
                                                                                                                                                                                                                                                                              have hc₀_mul : c₀ * 151 = 2 * p + 19 := Nat.div_mul_cancel hdiv151b
                                                                                                                                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 151 = ↑p + 1444 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 151 = 2 * ↑p + 19 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                              push_cast
                                                                                                                                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                          · by_cases hp151_75 : p % 151 = 75
                                                                                                                                                                                                                                                                            · -- p ≡ 75 (mod 151): (α=19, r=2, s=1), M = 4·19·1·2 - 1 = 151
                                                                                                                                                                                                                                                                              -- offset = (p+76)/151, b = 38, c = 38·(2 * p + 1)/151
                                                                                                                                                                                                                                                                              have hdiv151a : 151 ∣ (p + 76) := by omega
                                                                                                                                                                                                                                                                              have hdiv151b : 151 ∣ (2 * p + 1) := by omega
                                                                                                                                                                                                                                                                              refine ⟨(p + 76) / 151, 38, 38 * ((2 * p + 1) / 151), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                              · have : p % 3624 = 1585 := by omega
                                                                                                                                                                                                                                                                                have h151div : (p + 76) / 151 * 151 = p + 76 := Nat.div_mul_cancel hdiv151a
                                                                                                                                                                                                                                                                                omega
                                                                                                                                                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                              · set δ := (p + 76) / 151 with hδ_def
                                                                                                                                                                                                                                                                                set c₀ := (2 * p + 1) / 151 with hc₀_def
                                                                                                                                                                                                                                                                                have hδ_mul : δ * 151 = p + 76 := Nat.div_mul_cancel hdiv151a
                                                                                                                                                                                                                                                                                have hc₀_mul : c₀ * 151 = 2 * p + 1 := Nat.div_mul_cancel hdiv151b
                                                                                                                                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 151 = ↑p + 76 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 151 = 2 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                push_cast
                                                                                                                                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                            · by_cases hp151_113 : p % 151 = 113
                                                                                                                                                                                                                                                                              · -- p ≡ 113 (mod 151): (α=1, r=1, s=38), M = 4·1·38·1 - 1 = 151
                                                                                                                                                                                                                                                                                -- offset = (p+5776)/151, b = 38, c = (p + 38)/151
                                                                                                                                                                                                                                                                                have hdiv151a : 151 ∣ (p + 5776) := by omega
                                                                                                                                                                                                                                                                                have hdiv151b : 151 ∣ (p + 38) := by omega
                                                                                                                                                                                                                                                                                refine ⟨(p + 5776) / 151, 38, (p + 38) / 151, ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                · have : p % 3624 = 1321 := by omega
                                                                                                                                                                                                                                                                                  have h151div : (p + 5776) / 151 * 151 = p + 5776 := Nat.div_mul_cancel hdiv151a
                                                                                                                                                                                                                                                                                  omega
                                                                                                                                                                                                                                                                                · exact Nat.div_pos (by omega) (by norm_num)
                                                                                                                                                                                                                                                                                · set δ := (p + 5776) / 151 with hδ_def
                                                                                                                                                                                                                                                                                  set c₀ := (p + 38) / 151 with hc₀_def
                                                                                                                                                                                                                                                                                  have hδ_mul : δ * 151 = p + 5776 := Nat.div_mul_cancel hdiv151a
                                                                                                                                                                                                                                                                                  have hc₀_mul : c₀ * 151 = p + 38 := Nat.div_mul_cancel hdiv151b
                                                                                                                                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 151 = ↑p + 5776 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 151 = ↑p + 38 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                  push_cast
                                                                                                                                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                              · by_cases hp151_132 : p % 151 = 132
                                                                                                                                                                                                                                                                                · -- p ≡ 132 (mod 151): (α=2, r=1, s=19), M = 4·2·19·1 - 1 = 151
                                                                                                                                                                                                                                                                                  -- offset = (p+2888)/151, b = 38, c = 2·(p + 19)/151
                                                                                                                                                                                                                                                                                  have hdiv151a : 151 ∣ (p + 2888) := by omega
                                                                                                                                                                                                                                                                                  have hdiv151b : 151 ∣ (p + 19) := by omega
                                                                                                                                                                                                                                                                                  refine ⟨(p + 2888) / 151, 38, 2 * ((p + 19) / 151), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                  · have : p % 3624 = 3001 := by omega
                                                                                                                                                                                                                                                                                    have h151div : (p + 2888) / 151 * 151 = p + 2888 := Nat.div_mul_cancel hdiv151a
                                                                                                                                                                                                                                                                                    omega
                                                                                                                                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                  · set δ := (p + 2888) / 151 with hδ_def
                                                                                                                                                                                                                                                                                    set c₀ := (p + 19) / 151 with hc₀_def
                                                                                                                                                                                                                                                                                    have hδ_mul : δ * 151 = p + 2888 := Nat.div_mul_cancel hdiv151a
                                                                                                                                                                                                                                                                                    have hc₀_mul : c₀ * 151 = p + 19 := Nat.div_mul_cancel hdiv151b
                                                                                                                                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 151 = ↑p + 2888 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 151 = ↑p + 19 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                    push_cast
                                                                                                                                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                · by_cases hp151_135 : p % 151 = 135
                                                                                                                                                                                                                                                                                  · -- p ≡ 135 (mod 151): (α=1, r=19, s=2), M = 4·1·2·19 - 1 = 151
                                                                                                                                                                                                                                                                                    -- offset = (p+16)/151, b = 38, c = 19·(19 * p + 2)/151
                                                                                                                                                                                                                                                                                    have hdiv151a : 151 ∣ (p + 16) := by omega
                                                                                                                                                                                                                                                                                    have hdiv151b : 151 ∣ (19 * p + 2) := by omega
                                                                                                                                                                                                                                                                                    refine ⟨(p + 16) / 151, 38, 19 * ((19 * p + 2) / 151), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                    · have : p % 3624 = 3457 := by omega
                                                                                                                                                                                                                                                                                      have h151div : (p + 16) / 151 * 151 = p + 16 := Nat.div_mul_cancel hdiv151a
                                                                                                                                                                                                                                                                                      omega
                                                                                                                                                                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                    · set δ := (p + 16) / 151 with hδ_def
                                                                                                                                                                                                                                                                                      set c₀ := (19 * p + 2) / 151 with hc₀_def
                                                                                                                                                                                                                                                                                      have hδ_mul : δ * 151 = p + 16 := Nat.div_mul_cancel hdiv151a
                                                                                                                                                                                                                                                                                      have hc₀_mul : c₀ * 151 = 19 * p + 2 := Nat.div_mul_cancel hdiv151b
                                                                                                                                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 151 = ↑p + 16 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 151 = 19 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                      push_cast
                                                                                                                                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                  · by_cases hp151_143 : p % 151 = 143
                                                                                                                                                                                                                                                                                    · -- p ≡ 143 (mod 151): (α=2, r=19, s=1), M = 4·2·1·19 - 1 = 151
                                                                                                                                                                                                                                                                                      -- offset = (p+8)/151, b = 38, c = 38·(19 * p + 1)/151
                                                                                                                                                                                                                                                                                      have hdiv151a : 151 ∣ (p + 8) := by omega
                                                                                                                                                                                                                                                                                      have hdiv151b : 151 ∣ (19 * p + 1) := by omega
                                                                                                                                                                                                                                                                                      refine ⟨(p + 8) / 151, 38, 38 * ((19 * p + 1) / 151), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                      · have : p % 3624 = 2257 := by omega
                                                                                                                                                                                                                                                                                        have h151div : (p + 8) / 151 * 151 = p + 8 := Nat.div_mul_cancel hdiv151a
                                                                                                                                                                                                                                                                                        omega
                                                                                                                                                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                      · set δ := (p + 8) / 151 with hδ_def
                                                                                                                                                                                                                                                                                        set c₀ := (19 * p + 1) / 151 with hc₀_def
                                                                                                                                                                                                                                                                                        have hδ_mul : δ * 151 = p + 8 := Nat.div_mul_cancel hdiv151a
                                                                                                                                                                                                                                                                                        have hc₀_mul : c₀ * 151 = 19 * p + 1 := Nat.div_mul_cancel hdiv151b
                                                                                                                                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 151 = ↑p + 8 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 151 = 19 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                        push_cast
                                                                                                                                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                    · by_cases hp151_147 : p % 151 = 147
                                                                                                                                                                                                                                                                                      · -- p ≡ 147 (mod 151): (α=1, r=38, s=1), M = 4·1·1·38 - 1 = 151
                                                                                                                                                                                                                                                                                        -- offset = (p+4)/151, b = 38, c = 38·(38 * p + 1)/151
                                                                                                                                                                                                                                                                                        have hdiv151a : 151 ∣ (p + 4) := by omega
                                                                                                                                                                                                                                                                                        have hdiv151b : 151 ∣ (38 * p + 1) := by omega
                                                                                                                                                                                                                                                                                        refine ⟨(p + 4) / 151, 38, 38 * ((38 * p + 1) / 151), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                        · have : p % 3624 = 1657 := by omega
                                                                                                                                                                                                                                                                                          have h151div : (p + 4) / 151 * 151 = p + 4 := Nat.div_mul_cancel hdiv151a
                                                                                                                                                                                                                                                                                          omega
                                                                                                                                                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                        · set δ := (p + 4) / 151 with hδ_def
                                                                                                                                                                                                                                                                                          set c₀ := (38 * p + 1) / 151 with hc₀_def
                                                                                                                                                                                                                                                                                          have hδ_mul : δ * 151 = p + 4 := Nat.div_mul_cancel hdiv151a
                                                                                                                                                                                                                                                                                          have hc₀_mul : c₀ * 151 = 38 * p + 1 := Nat.div_mul_cancel hdiv151b
                                                                                                                                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 151 = ↑p + 4 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 151 = 38 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                          push_cast
                                                                                                                                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                      · by_cases hp151_149 : p % 151 = 149
                                                                                                                                                                                                                                                                                        · -- p ≡ 149 (mod 151): (α=19, r=1, s=2), M = 4·19·2·1 - 1 = 151
                                                                                                                                                                                                                                                                                          -- offset = (p+304)/151, b = 38, c = 19·(p + 2)/151
                                                                                                                                                                                                                                                                                          have hdiv151a : 151 ∣ (p + 304) := by omega
                                                                                                                                                                                                                                                                                          have hdiv151b : 151 ∣ (p + 2) := by omega
                                                                                                                                                                                                                                                                                          refine ⟨(p + 304) / 151, 38, 19 * ((p + 2) / 151), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                          · have : p % 3624 = 3169 := by omega
                                                                                                                                                                                                                                                                                            have h151div : (p + 304) / 151 * 151 = p + 304 := Nat.div_mul_cancel hdiv151a
                                                                                                                                                                                                                                                                                            omega
                                                                                                                                                                                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                          · set δ := (p + 304) / 151 with hδ_def
                                                                                                                                                                                                                                                                                            set c₀ := (p + 2) / 151 with hc₀_def
                                                                                                                                                                                                                                                                                            have hδ_mul : δ * 151 = p + 304 := Nat.div_mul_cancel hdiv151a
                                                                                                                                                                                                                                                                                            have hc₀_mul : c₀ * 151 = p + 2 := Nat.div_mul_cancel hdiv151b
                                                                                                                                                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 151 = ↑p + 304 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 151 = ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                            push_cast
                                                                                                                                                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                        · by_cases hp151_150 : p % 151 = 150
                                                                                                                                                                                                                                                                                          · -- p ≡ 150 (mod 151): (α=38, r=1, s=1), M = 4·38·1·1 - 1 = 151
                                                                                                                                                                                                                                                                                            -- offset = (p+152)/151, b = 38, c = 38·(p + 1)/151
                                                                                                                                                                                                                                                                                            have hdiv151a : 151 ∣ (p + 152) := by omega
                                                                                                                                                                                                                                                                                            have hdiv151b : 151 ∣ (p + 1) := by omega
                                                                                                                                                                                                                                                                                            refine ⟨(p + 152) / 151, 38, 38 * ((p + 1) / 151), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                            · have : p % 3624 = 2113 := by omega
                                                                                                                                                                                                                                                                                              have h151div : (p + 152) / 151 * 151 = p + 152 := Nat.div_mul_cancel hdiv151a
                                                                                                                                                                                                                                                                                              omega
                                                                                                                                                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                            · set δ := (p + 152) / 151 with hδ_def
                                                                                                                                                                                                                                                                                              set c₀ := (p + 1) / 151 with hc₀_def
                                                                                                                                                                                                                                                                                              have hδ_mul : δ * 151 = p + 152 := Nat.div_mul_cancel hdiv151a
                                                                                                                                                                                                                                                                                              have hc₀_mul : c₀ * 151 = p + 1 := Nat.div_mul_cancel hdiv151b
                                                                                                                                                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 151 = ↑p + 152 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 151 = ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                              push_cast
                                                                                                                                                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                          · -- M = 59 subcases via Lemma D.6
                                                                                                                                                                                                                                                                                            by_cases hp59_18 : p % 59 = 18
                                                                                                                                                                                                                                                                                            · -- p ≡ 18 (mod 59): (α=1, r=3, s=5), M = 4·1·5·3 - 1 = 59
                                                                                                                                                                                                                                                                                              -- offset = (p+100)/59, b = 15, c = 3·(3 * p + 5)/59
                                                                                                                                                                                                                                                                                              have hdiv59a : 59 ∣ (p + 100) := by omega
                                                                                                                                                                                                                                                                                              have hdiv59b : 59 ∣ (3 * p + 5) := by omega
                                                                                                                                                                                                                                                                                              refine ⟨(p + 100) / 59, 15, 3 * ((3 * p + 5) / 59), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                              · have : p % 1416 = 313 := by omega
                                                                                                                                                                                                                                                                                                have h59div : (p + 100) / 59 * 59 = p + 100 := Nat.div_mul_cancel hdiv59a
                                                                                                                                                                                                                                                                                                omega
                                                                                                                                                                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                              · set δ := (p + 100) / 59 with hδ_def
                                                                                                                                                                                                                                                                                                set c₀ := (3 * p + 5) / 59 with hc₀_def
                                                                                                                                                                                                                                                                                                have hδ_mul : δ * 59 = p + 100 := Nat.div_mul_cancel hdiv59a
                                                                                                                                                                                                                                                                                                have hc₀_mul : c₀ * 59 = 3 * p + 5 := Nat.div_mul_cancel hdiv59b
                                                                                                                                                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 59 = ↑p + 100 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 59 = 3 * ↑p + 5 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                push_cast
                                                                                                                                                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                            · by_cases hp59_23 : p % 59 = 23
                                                                                                                                                                                                                                                                                              · -- p ≡ 23 (mod 59): (α=1, r=5, s=3), M = 4·1·3·5 - 1 = 59
                                                                                                                                                                                                                                                                                                -- offset = (p+36)/59, b = 15, c = 5·(5 * p + 3)/59
                                                                                                                                                                                                                                                                                                have hdiv59a : 59 ∣ (p + 36) := by omega
                                                                                                                                                                                                                                                                                                have hdiv59b : 59 ∣ (5 * p + 3) := by omega
                                                                                                                                                                                                                                                                                                refine ⟨(p + 36) / 59, 15, 5 * ((5 * p + 3) / 59), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                · have : p % 1416 = 1321 := by omega
                                                                                                                                                                                                                                                                                                  have h59div : (p + 36) / 59 * 59 = p + 36 := Nat.div_mul_cancel hdiv59a
                                                                                                                                                                                                                                                                                                  omega
                                                                                                                                                                                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                · set δ := (p + 36) / 59 with hδ_def
                                                                                                                                                                                                                                                                                                  set c₀ := (5 * p + 3) / 59 with hc₀_def
                                                                                                                                                                                                                                                                                                  have hδ_mul : δ * 59 = p + 36 := Nat.div_mul_cancel hdiv59a
                                                                                                                                                                                                                                                                                                  have hc₀_mul : c₀ * 59 = 5 * p + 3 := Nat.div_mul_cancel hdiv59b
                                                                                                                                                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 59 = ↑p + 36 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 59 = 5 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                  push_cast
                                                                                                                                                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                              · by_cases hp59_39 : p % 59 = 39
                                                                                                                                                                                                                                                                                                · -- p ≡ 39 (mod 59): (α=5, r=3, s=1), M = 4·5·1·3 - 1 = 59
                                                                                                                                                                                                                                                                                                  -- offset = (p+20)/59, b = 15, c = 15·(3 * p + 1)/59
                                                                                                                                                                                                                                                                                                  have hdiv59a : 59 ∣ (p + 20) := by omega
                                                                                                                                                                                                                                                                                                  have hdiv59b : 59 ∣ (3 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                  refine ⟨(p + 20) / 59, 15, 15 * ((3 * p + 1) / 59), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                  · have : p % 1416 = 865 := by omega
                                                                                                                                                                                                                                                                                                    have h59div : (p + 20) / 59 * 59 = p + 20 := Nat.div_mul_cancel hdiv59a
                                                                                                                                                                                                                                                                                                    omega
                                                                                                                                                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                  · set δ := (p + 20) / 59 with hδ_def
                                                                                                                                                                                                                                                                                                    set c₀ := (3 * p + 1) / 59 with hc₀_def
                                                                                                                                                                                                                                                                                                    have hδ_mul : δ * 59 = p + 20 := Nat.div_mul_cancel hdiv59a
                                                                                                                                                                                                                                                                                                    have hc₀_mul : c₀ * 59 = 3 * p + 1 := Nat.div_mul_cancel hdiv59b
                                                                                                                                                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 59 = ↑p + 20 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 59 = 3 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                    push_cast
                                                                                                                                                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                · by_cases hp59_44 : p % 59 = 44
                                                                                                                                                                                                                                                                                                  · -- p ≡ 44 (mod 59): (α=1, r=1, s=15), M = 4·1·15·1 - 1 = 59
                                                                                                                                                                                                                                                                                                    -- offset = (p+900)/59, b = 15, c = (p + 15)/59
                                                                                                                                                                                                                                                                                                    have hdiv59a : 59 ∣ (p + 900) := by omega
                                                                                                                                                                                                                                                                                                    have hdiv59b : 59 ∣ (p + 15) := by omega
                                                                                                                                                                                                                                                                                                    refine ⟨(p + 900) / 59, 15, (p + 15) / 59, ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                    · have : p % 1416 = 457 := by omega
                                                                                                                                                                                                                                                                                                      have h59div : (p + 900) / 59 * 59 = p + 900 := Nat.div_mul_cancel hdiv59a
                                                                                                                                                                                                                                                                                                      omega
                                                                                                                                                                                                                                                                                                    · exact Nat.div_pos (by omega) (by norm_num)
                                                                                                                                                                                                                                                                                                    · set δ := (p + 900) / 59 with hδ_def
                                                                                                                                                                                                                                                                                                      set c₀ := (p + 15) / 59 with hc₀_def
                                                                                                                                                                                                                                                                                                      have hδ_mul : δ * 59 = p + 900 := Nat.div_mul_cancel hdiv59a
                                                                                                                                                                                                                                                                                                      have hc₀_mul : c₀ * 59 = p + 15 := Nat.div_mul_cancel hdiv59b
                                                                                                                                                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 59 = ↑p + 900 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 59 = ↑p + 15 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                      push_cast
                                                                                                                                                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                  · by_cases hp59_47 : p % 59 = 47
                                                                                                                                                                                                                                                                                                    · -- p ≡ 47 (mod 59): (α=3, r=5, s=1), M = 4·3·1·5 - 1 = 59
                                                                                                                                                                                                                                                                                                      -- offset = (p+12)/59, b = 15, c = 15·(5 * p + 1)/59
                                                                                                                                                                                                                                                                                                      have hdiv59a : 59 ∣ (p + 12) := by omega
                                                                                                                                                                                                                                                                                                      have hdiv59b : 59 ∣ (5 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                      refine ⟨(p + 12) / 59, 15, 15 * ((5 * p + 1) / 59), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                      · have : p % 1416 = 1345 := by omega
                                                                                                                                                                                                                                                                                                        have h59div : (p + 12) / 59 * 59 = p + 12 := Nat.div_mul_cancel hdiv59a
                                                                                                                                                                                                                                                                                                        omega
                                                                                                                                                                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                      · set δ := (p + 12) / 59 with hδ_def
                                                                                                                                                                                                                                                                                                        set c₀ := (5 * p + 1) / 59 with hc₀_def
                                                                                                                                                                                                                                                                                                        have hδ_mul : δ * 59 = p + 12 := Nat.div_mul_cancel hdiv59a
                                                                                                                                                                                                                                                                                                        have hc₀_mul : c₀ * 59 = 5 * p + 1 := Nat.div_mul_cancel hdiv59b
                                                                                                                                                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 59 = ↑p + 12 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 59 = 5 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                        push_cast
                                                                                                                                                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                    · by_cases hp59_54 : p % 59 = 54
                                                                                                                                                                                                                                                                                                      · -- p ≡ 54 (mod 59): (α=3, r=1, s=5), M = 4·3·5·1 - 1 = 59
                                                                                                                                                                                                                                                                                                        -- offset = (p+300)/59, b = 15, c = 3·(p + 5)/59
                                                                                                                                                                                                                                                                                                        have hdiv59a : 59 ∣ (p + 300) := by omega
                                                                                                                                                                                                                                                                                                        have hdiv59b : 59 ∣ (p + 5) := by omega
                                                                                                                                                                                                                                                                                                        refine ⟨(p + 300) / 59, 15, 3 * ((p + 5) / 59), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                        · have : p % 1416 = 1057 := by omega
                                                                                                                                                                                                                                                                                                          have h59div : (p + 300) / 59 * 59 = p + 300 := Nat.div_mul_cancel hdiv59a
                                                                                                                                                                                                                                                                                                          omega
                                                                                                                                                                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                        · set δ := (p + 300) / 59 with hδ_def
                                                                                                                                                                                                                                                                                                          set c₀ := (p + 5) / 59 with hc₀_def
                                                                                                                                                                                                                                                                                                          have hδ_mul : δ * 59 = p + 300 := Nat.div_mul_cancel hdiv59a
                                                                                                                                                                                                                                                                                                          have hc₀_mul : c₀ * 59 = p + 5 := Nat.div_mul_cancel hdiv59b
                                                                                                                                                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 59 = ↑p + 300 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 59 = ↑p + 5 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                          push_cast
                                                                                                                                                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                      · by_cases hp59_55 : p % 59 = 55
                                                                                                                                                                                                                                                                                                        · -- p ≡ 55 (mod 59): (α=1, r=15, s=1), M = 4·1·1·15 - 1 = 59
                                                                                                                                                                                                                                                                                                          -- offset = (p+4)/59, b = 15, c = 15·(15 * p + 1)/59
                                                                                                                                                                                                                                                                                                          have hdiv59a : 59 ∣ (p + 4) := by omega
                                                                                                                                                                                                                                                                                                          have hdiv59b : 59 ∣ (15 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                          refine ⟨(p + 4) / 59, 15, 15 * ((15 * p + 1) / 59), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                          · have : p % 1416 = 409 := by omega
                                                                                                                                                                                                                                                                                                            have h59div : (p + 4) / 59 * 59 = p + 4 := Nat.div_mul_cancel hdiv59a
                                                                                                                                                                                                                                                                                                            omega
                                                                                                                                                                                                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                          · set δ := (p + 4) / 59 with hδ_def
                                                                                                                                                                                                                                                                                                            set c₀ := (15 * p + 1) / 59 with hc₀_def
                                                                                                                                                                                                                                                                                                            have hδ_mul : δ * 59 = p + 4 := Nat.div_mul_cancel hdiv59a
                                                                                                                                                                                                                                                                                                            have hc₀_mul : c₀ * 59 = 15 * p + 1 := Nat.div_mul_cancel hdiv59b
                                                                                                                                                                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 59 = ↑p + 4 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 59 = 15 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                            push_cast
                                                                                                                                                                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                        · by_cases hp59_56 : p % 59 = 56
                                                                                                                                                                                                                                                                                                          · -- p ≡ 56 (mod 59): (α=5, r=1, s=3), M = 4·5·3·1 - 1 = 59
                                                                                                                                                                                                                                                                                                            -- offset = (p+180)/59, b = 15, c = 5·(p + 3)/59
                                                                                                                                                                                                                                                                                                            have hdiv59a : 59 ∣ (p + 180) := by omega
                                                                                                                                                                                                                                                                                                            have hdiv59b : 59 ∣ (p + 3) := by omega
                                                                                                                                                                                                                                                                                                            refine ⟨(p + 180) / 59, 15, 5 * ((p + 3) / 59), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                            · have : p % 1416 = 1177 := by omega
                                                                                                                                                                                                                                                                                                              have h59div : (p + 180) / 59 * 59 = p + 180 := Nat.div_mul_cancel hdiv59a
                                                                                                                                                                                                                                                                                                              omega
                                                                                                                                                                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                            · set δ := (p + 180) / 59 with hδ_def
                                                                                                                                                                                                                                                                                                              set c₀ := (p + 3) / 59 with hc₀_def
                                                                                                                                                                                                                                                                                                              have hδ_mul : δ * 59 = p + 180 := Nat.div_mul_cancel hdiv59a
                                                                                                                                                                                                                                                                                                              have hc₀_mul : c₀ * 59 = p + 3 := Nat.div_mul_cancel hdiv59b
                                                                                                                                                                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 59 = ↑p + 180 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 59 = ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                              push_cast
                                                                                                                                                                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                          · by_cases hp59_58 : p % 59 = 58
                                                                                                                                                                                                                                                                                                            · -- p ≡ 58 (mod 59): (α=15, r=1, s=1), M = 4·15·1·1 - 1 = 59
                                                                                                                                                                                                                                                                                                              -- offset = (p+60)/59, b = 15, c = 15·(p + 1)/59
                                                                                                                                                                                                                                                                                                              have hdiv59a : 59 ∣ (p + 60) := by omega
                                                                                                                                                                                                                                                                                                              have hdiv59b : 59 ∣ (p + 1) := by omega
                                                                                                                                                                                                                                                                                                              refine ⟨(p + 60) / 59, 15, 15 * ((p + 1) / 59), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                              · have : p % 1416 = 1297 := by omega
                                                                                                                                                                                                                                                                                                                have h59div : (p + 60) / 59 * 59 = p + 60 := Nat.div_mul_cancel hdiv59a
                                                                                                                                                                                                                                                                                                                omega
                                                                                                                                                                                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                              · set δ := (p + 60) / 59 with hδ_def
                                                                                                                                                                                                                                                                                                                set c₀ := (p + 1) / 59 with hc₀_def
                                                                                                                                                                                                                                                                                                                have hδ_mul : δ * 59 = p + 60 := Nat.div_mul_cancel hdiv59a
                                                                                                                                                                                                                                                                                                                have hc₀_mul : c₀ * 59 = p + 1 := Nat.div_mul_cancel hdiv59b
                                                                                                                                                                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 59 = ↑p + 60 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 59 = ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                push_cast
                                                                                                                                                                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                            · -- M = 191 subcases via Lemma D.6
                                                                                                                                                                                                                                                                                                              by_cases hp191_47 : p % 191 = 47
                                                                                                                                                                                                                                                                                                              · -- p ≡ 47 (mod 191): (α=1, r=8, s=6), M = 4·1·6·8 - 1 = 191
                                                                                                                                                                                                                                                                                                                -- offset = (p+144)/191, b = 48, c = 8·(8 * p + 6)/191
                                                                                                                                                                                                                                                                                                                have hdiv191a : 191 ∣ (p + 144) := by omega
                                                                                                                                                                                                                                                                                                                have hdiv191b : 191 ∣ (8 * p + 6) := by omega
                                                                                                                                                                                                                                                                                                                refine ⟨(p + 144) / 191, 48, 8 * ((8 * p + 6) / 191), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                · have : p % 4584 = 4249 := by omega
                                                                                                                                                                                                                                                                                                                  have h191div : (p + 144) / 191 * 191 = p + 144 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                  omega
                                                                                                                                                                                                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                · set δ := (p + 144) / 191 with hδ_def
                                                                                                                                                                                                                                                                                                                  set c₀ := (8 * p + 6) / 191 with hc₀_def
                                                                                                                                                                                                                                                                                                                  have hδ_mul : δ * 191 = p + 144 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                  have hc₀_mul : c₀ * 191 = 8 * p + 6 := Nat.div_mul_cancel hdiv191b
                                                                                                                                                                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 191 = ↑p + 144 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 191 = 8 * ↑p + 6 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                  push_cast
                                                                                                                                                                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                              · by_cases hp191_61 : p % 191 = 61
                                                                                                                                                                                                                                                                                                                · -- p ≡ 61 (mod 191): (α=2, r=3, s=8), M = 4·2·8·3 - 1 = 191
                                                                                                                                                                                                                                                                                                                  -- offset = (p+512)/191, b = 48, c = 6·(3 * p + 8)/191
                                                                                                                                                                                                                                                                                                                  have hdiv191a : 191 ∣ (p + 512) := by omega
                                                                                                                                                                                                                                                                                                                  have hdiv191b : 191 ∣ (3 * p + 8) := by omega
                                                                                                                                                                                                                                                                                                                  refine ⟨(p + 512) / 191, 48, 6 * ((3 * p + 8) / 191), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                  · have : p % 4584 = 2353 := by omega
                                                                                                                                                                                                                                                                                                                    have h191div : (p + 512) / 191 * 191 = p + 512 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                    omega
                                                                                                                                                                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                  · set δ := (p + 512) / 191 with hδ_def
                                                                                                                                                                                                                                                                                                                    set c₀ := (3 * p + 8) / 191 with hc₀_def
                                                                                                                                                                                                                                                                                                                    have hδ_mul : δ * 191 = p + 512 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                    have hc₀_mul : c₀ * 191 = 3 * p + 8 := Nat.div_mul_cancel hdiv191b
                                                                                                                                                                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 191 = ↑p + 512 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 191 = 3 * ↑p + 8 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                    push_cast
                                                                                                                                                                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                · by_cases hp191_63 : p % 191 = 63
                                                                                                                                                                                                                                                                                                                  · -- p ≡ 63 (mod 191): (α=2, r=6, s=4), M = 4·2·4·6 - 1 = 191
                                                                                                                                                                                                                                                                                                                    -- offset = (p+128)/191, b = 48, c = 12·(6 * p + 4)/191
                                                                                                                                                                                                                                                                                                                    have hdiv191a : 191 ∣ (p + 128) := by omega
                                                                                                                                                                                                                                                                                                                    have hdiv191b : 191 ∣ (6 * p + 4) := by omega
                                                                                                                                                                                                                                                                                                                    refine ⟨(p + 128) / 191, 48, 12 * ((6 * p + 4) / 191), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                    · have : p % 4584 = 2737 := by omega
                                                                                                                                                                                                                                                                                                                      have h191div : (p + 128) / 191 * 191 = p + 128 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                      omega
                                                                                                                                                                                                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                    · set δ := (p + 128) / 191 with hδ_def
                                                                                                                                                                                                                                                                                                                      set c₀ := (6 * p + 4) / 191 with hc₀_def
                                                                                                                                                                                                                                                                                                                      have hδ_mul : δ * 191 = p + 128 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                      have hc₀_mul : c₀ * 191 = 6 * p + 4 := Nat.div_mul_cancel hdiv191b
                                                                                                                                                                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 191 = ↑p + 128 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 191 = 6 * ↑p + 4 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                      push_cast
                                                                                                                                                                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                  · by_cases hp191_94 : p % 191 = 94
                                                                                                                                                                                                                                                                                                                    · -- p ≡ 94 (mod 191): (α=2, r=4, s=6), M = 4·2·6·4 - 1 = 191
                                                                                                                                                                                                                                                                                                                      -- offset = (p+288)/191, b = 48, c = 8·(4 * p + 6)/191
                                                                                                                                                                                                                                                                                                                      have hdiv191a : 191 ∣ (p + 288) := by omega
                                                                                                                                                                                                                                                                                                                      have hdiv191b : 191 ∣ (4 * p + 6) := by omega
                                                                                                                                                                                                                                                                                                                      refine ⟨(p + 288) / 191, 48, 8 * ((4 * p + 6) / 191), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                      · have : p % 4584 = 4105 := by omega
                                                                                                                                                                                                                                                                                                                        have h191div : (p + 288) / 191 * 191 = p + 288 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                        omega
                                                                                                                                                                                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                      · set δ := (p + 288) / 191 with hδ_def
                                                                                                                                                                                                                                                                                                                        set c₀ := (4 * p + 6) / 191 with hc₀_def
                                                                                                                                                                                                                                                                                                                        have hδ_mul : δ * 191 = p + 288 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                        have hc₀_mul : c₀ * 191 = 4 * p + 6 := Nat.div_mul_cancel hdiv191b
                                                                                                                                                                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 191 = ↑p + 288 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 191 = 4 * ↑p + 6 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                        push_cast
                                                                                                                                                                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                    · by_cases hp191_95 : p % 191 = 95
                                                                                                                                                                                                                                                                                                                      · -- p ≡ 95 (mod 191): (α=6, r=4, s=2), M = 4·6·2·4 - 1 = 191
                                                                                                                                                                                                                                                                                                                        -- offset = (p+96)/191, b = 48, c = 24·(4 * p + 2)/191
                                                                                                                                                                                                                                                                                                                        have hdiv191a : 191 ∣ (p + 96) := by omega
                                                                                                                                                                                                                                                                                                                        have hdiv191b : 191 ∣ (4 * p + 2) := by omega
                                                                                                                                                                                                                                                                                                                        refine ⟨(p + 96) / 191, 48, 24 * ((4 * p + 2) / 191), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                        · have : p % 4584 = 4297 := by omega
                                                                                                                                                                                                                                                                                                                          have h191div : (p + 96) / 191 * 191 = p + 96 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                          omega
                                                                                                                                                                                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                        · set δ := (p + 96) / 191 with hδ_def
                                                                                                                                                                                                                                                                                                                          set c₀ := (4 * p + 2) / 191 with hc₀_def
                                                                                                                                                                                                                                                                                                                          have hδ_mul : δ * 191 = p + 96 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                          have hc₀_mul : c₀ * 191 = 4 * p + 2 := Nat.div_mul_cancel hdiv191b
                                                                                                                                                                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 191 = ↑p + 96 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 191 = 4 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                          push_cast
                                                                                                                                                                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                      · by_cases hp191_119 : p % 191 = 119
                                                                                                                                                                                                                                                                                                                        · -- p ≡ 119 (mod 191): (α=2, r=8, s=3), M = 4·2·3·8 - 1 = 191
                                                                                                                                                                                                                                                                                                                          -- offset = (p+72)/191, b = 48, c = 16·(8 * p + 3)/191
                                                                                                                                                                                                                                                                                                                          have hdiv191a : 191 ∣ (p + 72) := by omega
                                                                                                                                                                                                                                                                                                                          have hdiv191b : 191 ∣ (8 * p + 3) := by omega
                                                                                                                                                                                                                                                                                                                          refine ⟨(p + 72) / 191, 48, 16 * ((8 * p + 3) / 191), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                          · have : p % 4584 = 4321 := by omega
                                                                                                                                                                                                                                                                                                                            have h191div : (p + 72) / 191 * 191 = p + 72 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                            omega
                                                                                                                                                                                                                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                          · set δ := (p + 72) / 191 with hδ_def
                                                                                                                                                                                                                                                                                                                            set c₀ := (8 * p + 3) / 191 with hc₀_def
                                                                                                                                                                                                                                                                                                                            have hδ_mul : δ * 191 = p + 72 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                            have hc₀_mul : c₀ * 191 = 8 * p + 3 := Nat.div_mul_cancel hdiv191b
                                                                                                                                                                                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 191 = ↑p + 72 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 191 = 8 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                            push_cast
                                                                                                                                                                                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                        · by_cases hp191_122 : p % 191 = 122
                                                                                                                                                                                                                                                                                                                          · -- p ≡ 122 (mod 191): (α=1, r=3, s=16), M = 4·1·16·3 - 1 = 191
                                                                                                                                                                                                                                                                                                                            -- offset = (p+1024)/191, b = 48, c = 3·(3 * p + 16)/191
                                                                                                                                                                                                                                                                                                                            have hdiv191a : 191 ∣ (p + 1024) := by omega
                                                                                                                                                                                                                                                                                                                            have hdiv191b : 191 ∣ (3 * p + 16) := by omega
                                                                                                                                                                                                                                                                                                                            refine ⟨(p + 1024) / 191, 48, 3 * ((3 * p + 16) / 191), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                            · have : p % 4584 = 313 := by omega
                                                                                                                                                                                                                                                                                                                              have h191div : (p + 1024) / 191 * 191 = p + 1024 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                              omega
                                                                                                                                                                                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                            · set δ := (p + 1024) / 191 with hδ_def
                                                                                                                                                                                                                                                                                                                              set c₀ := (3 * p + 16) / 191 with hc₀_def
                                                                                                                                                                                                                                                                                                                              have hδ_mul : δ * 191 = p + 1024 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                              have hc₀_mul : c₀ * 191 = 3 * p + 16 := Nat.div_mul_cancel hdiv191b
                                                                                                                                                                                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 191 = ↑p + 1024 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 191 = 3 * ↑p + 16 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                              push_cast
                                                                                                                                                                                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                          · by_cases hp191_126 : p % 191 = 126
                                                                                                                                                                                                                                                                                                                            · -- p ≡ 126 (mod 191): (α=1, r=6, s=8), M = 4·1·8·6 - 1 = 191
                                                                                                                                                                                                                                                                                                                              -- offset = (p+256)/191, b = 48, c = 6·(6 * p + 8)/191
                                                                                                                                                                                                                                                                                                                              have hdiv191a : 191 ∣ (p + 256) := by omega
                                                                                                                                                                                                                                                                                                                              have hdiv191b : 191 ∣ (6 * p + 8) := by omega
                                                                                                                                                                                                                                                                                                                              refine ⟨(p + 256) / 191, 48, 6 * ((6 * p + 8) / 191), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                              · have : p % 4584 = 1081 := by omega
                                                                                                                                                                                                                                                                                                                                have h191div : (p + 256) / 191 * 191 = p + 256 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                omega
                                                                                                                                                                                                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                              · set δ := (p + 256) / 191 with hδ_def
                                                                                                                                                                                                                                                                                                                                set c₀ := (6 * p + 8) / 191 with hc₀_def
                                                                                                                                                                                                                                                                                                                                have hδ_mul : δ * 191 = p + 256 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                have hc₀_mul : c₀ * 191 = 6 * p + 8 := Nat.div_mul_cancel hdiv191b
                                                                                                                                                                                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 191 = ↑p + 256 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 191 = 6 * ↑p + 8 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                push_cast
                                                                                                                                                                                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                            · by_cases hp191_127 : p % 191 = 127
                                                                                                                                                                                                                                                                                                                              · -- p ≡ 127 (mod 191): (α=1, r=12, s=4), M = 4·1·4·12 - 1 = 191
                                                                                                                                                                                                                                                                                                                                -- offset = (p+64)/191, b = 48, c = 12·(12 * p + 4)/191
                                                                                                                                                                                                                                                                                                                                have hdiv191a : 191 ∣ (p + 64) := by omega
                                                                                                                                                                                                                                                                                                                                have hdiv191b : 191 ∣ (12 * p + 4) := by omega
                                                                                                                                                                                                                                                                                                                                refine ⟨(p + 64) / 191, 48, 12 * ((12 * p + 4) / 191), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                · have : p % 4584 = 1273 := by omega
                                                                                                                                                                                                                                                                                                                                  have h191div : (p + 64) / 191 * 191 = p + 64 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                  omega
                                                                                                                                                                                                                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                · set δ := (p + 64) / 191 with hδ_def
                                                                                                                                                                                                                                                                                                                                  set c₀ := (12 * p + 4) / 191 with hc₀_def
                                                                                                                                                                                                                                                                                                                                  have hδ_mul : δ * 191 = p + 64 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                  have hc₀_mul : c₀ * 191 = 12 * p + 4 := Nat.div_mul_cancel hdiv191b
                                                                                                                                                                                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 191 = ↑p + 64 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 191 = 12 * ↑p + 4 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                  push_cast
                                                                                                                                                                                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                              · by_cases hp191_143 : p % 191 = 143
                                                                                                                                                                                                                                                                                                                                · -- p ≡ 143 (mod 191): (α=3, r=8, s=2), M = 4·3·2·8 - 1 = 191
                                                                                                                                                                                                                                                                                                                                  -- offset = (p+48)/191, b = 48, c = 24·(8 * p + 2)/191
                                                                                                                                                                                                                                                                                                                                  have hdiv191a : 191 ∣ (p + 48) := by omega
                                                                                                                                                                                                                                                                                                                                  have hdiv191b : 191 ∣ (8 * p + 2) := by omega
                                                                                                                                                                                                                                                                                                                                  refine ⟨(p + 48) / 191, 48, 24 * ((8 * p + 2) / 191), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                  · have : p % 4584 = 4345 := by omega
                                                                                                                                                                                                                                                                                                                                    have h191div : (p + 48) / 191 * 191 = p + 48 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                    omega
                                                                                                                                                                                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                  · set δ := (p + 48) / 191 with hδ_def
                                                                                                                                                                                                                                                                                                                                    set c₀ := (8 * p + 2) / 191 with hc₀_def
                                                                                                                                                                                                                                                                                                                                    have hδ_mul : δ * 191 = p + 48 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                    have hc₀_mul : c₀ * 191 = 8 * p + 2 := Nat.div_mul_cancel hdiv191b
                                                                                                                                                                                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 191 = ↑p + 48 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 191 = 8 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                    push_cast
                                                                                                                                                                                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                · by_cases hp191_155 : p % 191 = 155
                                                                                                                                                                                                                                                                                                                                  · -- p ≡ 155 (mod 191): (α=1, r=16, s=3), M = 4·1·3·16 - 1 = 191
                                                                                                                                                                                                                                                                                                                                    -- offset = (p+36)/191, b = 48, c = 16·(16 * p + 3)/191
                                                                                                                                                                                                                                                                                                                                    have hdiv191a : 191 ∣ (p + 36) := by omega
                                                                                                                                                                                                                                                                                                                                    have hdiv191b : 191 ∣ (16 * p + 3) := by omega
                                                                                                                                                                                                                                                                                                                                    refine ⟨(p + 36) / 191, 48, 16 * ((16 * p + 3) / 191), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                    · have : p % 4584 = 2065 := by omega
                                                                                                                                                                                                                                                                                                                                      have h191div : (p + 36) / 191 * 191 = p + 36 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                      omega
                                                                                                                                                                                                                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                    · set δ := (p + 36) / 191 with hδ_def
                                                                                                                                                                                                                                                                                                                                      set c₀ := (16 * p + 3) / 191 with hc₀_def
                                                                                                                                                                                                                                                                                                                                      have hδ_mul : δ * 191 = p + 36 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                      have hc₀_mul : c₀ * 191 = 16 * p + 3 := Nat.div_mul_cancel hdiv191b
                                                                                                                                                                                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 191 = ↑p + 36 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 191 = 16 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                      push_cast
                                                                                                                                                                                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                  · by_cases hp191_159 : p % 191 = 159
                                                                                                                                                                                                                                                                                                                                    · -- p ≡ 159 (mod 191): (α=2, r=12, s=2), M = 4·2·2·12 - 1 = 191
                                                                                                                                                                                                                                                                                                                                      -- offset = (p+32)/191, b = 48, c = 24·(12 * p + 2)/191
                                                                                                                                                                                                                                                                                                                                      have hdiv191a : 191 ∣ (p + 32) := by omega
                                                                                                                                                                                                                                                                                                                                      have hdiv191b : 191 ∣ (12 * p + 2) := by omega
                                                                                                                                                                                                                                                                                                                                      refine ⟨(p + 32) / 191, 48, 24 * ((12 * p + 2) / 191), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                      · have : p % 4584 = 2833 := by omega
                                                                                                                                                                                                                                                                                                                                        have h191div : (p + 32) / 191 * 191 = p + 32 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                        omega
                                                                                                                                                                                                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                      · set δ := (p + 32) / 191 with hδ_def
                                                                                                                                                                                                                                                                                                                                        set c₀ := (12 * p + 2) / 191 with hc₀_def
                                                                                                                                                                                                                                                                                                                                        have hδ_mul : δ * 191 = p + 32 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                        have hc₀_mul : c₀ * 191 = 12 * p + 2 := Nat.div_mul_cancel hdiv191b
                                                                                                                                                                                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 191 = ↑p + 32 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 191 = 12 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                        push_cast
                                                                                                                                                                                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                    · by_cases hp191_167 : p % 191 = 167
                                                                                                                                                                                                                                                                                                                                      · -- p ≡ 167 (mod 191): (α=6, r=8, s=1), M = 4·6·1·8 - 1 = 191
                                                                                                                                                                                                                                                                                                                                        -- offset = (p+24)/191, b = 48, c = 48·(8 * p + 1)/191
                                                                                                                                                                                                                                                                                                                                        have hdiv191a : 191 ∣ (p + 24) := by omega
                                                                                                                                                                                                                                                                                                                                        have hdiv191b : 191 ∣ (8 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                        refine ⟨(p + 24) / 191, 48, 48 * ((8 * p + 1) / 191), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                        · have : p % 4584 = 4369 := by omega
                                                                                                                                                                                                                                                                                                                                          have h191div : (p + 24) / 191 * 191 = p + 24 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                          omega
                                                                                                                                                                                                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                        · set δ := (p + 24) / 191 with hδ_def
                                                                                                                                                                                                                                                                                                                                          set c₀ := (8 * p + 1) / 191 with hc₀_def
                                                                                                                                                                                                                                                                                                                                          have hδ_mul : δ * 191 = p + 24 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                          have hc₀_mul : c₀ * 191 = 8 * p + 1 := Nat.div_mul_cancel hdiv191b
                                                                                                                                                                                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 191 = ↑p + 24 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 191 = 8 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                          push_cast
                                                                                                                                                                                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                      · by_cases hp191_175 : p % 191 = 175
                                                                                                                                                                                                                                                                                                                                        · -- p ≡ 175 (mod 191): (α=1, r=24, s=2), M = 4·1·2·24 - 1 = 191
                                                                                                                                                                                                                                                                                                                                          -- offset = (p+16)/191, b = 48, c = 24·(24 * p + 2)/191
                                                                                                                                                                                                                                                                                                                                          have hdiv191a : 191 ∣ (p + 16) := by omega
                                                                                                                                                                                                                                                                                                                                          have hdiv191b : 191 ∣ (24 * p + 2) := by omega
                                                                                                                                                                                                                                                                                                                                          refine ⟨(p + 16) / 191, 48, 24 * ((24 * p + 2) / 191), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                          · have : p % 4584 = 1321 := by omega
                                                                                                                                                                                                                                                                                                                                            have h191div : (p + 16) / 191 * 191 = p + 16 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                            omega
                                                                                                                                                                                                                                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                          · set δ := (p + 16) / 191 with hδ_def
                                                                                                                                                                                                                                                                                                                                            set c₀ := (24 * p + 2) / 191 with hc₀_def
                                                                                                                                                                                                                                                                                                                                            have hδ_mul : δ * 191 = p + 16 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                            have hc₀_mul : c₀ * 191 = 24 * p + 2 := Nat.div_mul_cancel hdiv191b
                                                                                                                                                                                                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 191 = ↑p + 16 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 191 = 24 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                            push_cast
                                                                                                                                                                                                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                        · by_cases hp191_179 : p % 191 = 179
                                                                                                                                                                                                                                                                                                                                          · -- p ≡ 179 (mod 191): (α=3, r=16, s=1), M = 4·3·1·16 - 1 = 191
                                                                                                                                                                                                                                                                                                                                            -- offset = (p+12)/191, b = 48, c = 48·(16 * p + 1)/191
                                                                                                                                                                                                                                                                                                                                            have hdiv191a : 191 ∣ (p + 12) := by omega
                                                                                                                                                                                                                                                                                                                                            have hdiv191b : 191 ∣ (16 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                            refine ⟨(p + 12) / 191, 48, 48 * ((16 * p + 1) / 191), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                            · have : p % 4584 = 2089 := by omega
                                                                                                                                                                                                                                                                                                                                              have h191div : (p + 12) / 191 * 191 = p + 12 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                              omega
                                                                                                                                                                                                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                            · set δ := (p + 12) / 191 with hδ_def
                                                                                                                                                                                                                                                                                                                                              set c₀ := (16 * p + 1) / 191 with hc₀_def
                                                                                                                                                                                                                                                                                                                                              have hδ_mul : δ * 191 = p + 12 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                              have hc₀_mul : c₀ * 191 = 16 * p + 1 := Nat.div_mul_cancel hdiv191b
                                                                                                                                                                                                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 191 = ↑p + 12 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 191 = 16 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                              push_cast
                                                                                                                                                                                                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                          · by_cases hp191_183 : p % 191 = 183
                                                                                                                                                                                                                                                                                                                                            · -- p ≡ 183 (mod 191): (α=2, r=24, s=1), M = 4·2·1·24 - 1 = 191
                                                                                                                                                                                                                                                                                                                                              -- offset = (p+8)/191, b = 48, c = 48·(24 * p + 1)/191
                                                                                                                                                                                                                                                                                                                                              have hdiv191a : 191 ∣ (p + 8) := by omega
                                                                                                                                                                                                                                                                                                                                              have hdiv191b : 191 ∣ (24 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                              refine ⟨(p + 8) / 191, 48, 48 * ((24 * p + 1) / 191), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                              · have : p % 4584 = 2857 := by omega
                                                                                                                                                                                                                                                                                                                                                have h191div : (p + 8) / 191 * 191 = p + 8 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                                omega
                                                                                                                                                                                                                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                              · set δ := (p + 8) / 191 with hδ_def
                                                                                                                                                                                                                                                                                                                                                set c₀ := (24 * p + 1) / 191 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                have hδ_mul : δ * 191 = p + 8 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                                have hc₀_mul : c₀ * 191 = 24 * p + 1 := Nat.div_mul_cancel hdiv191b
                                                                                                                                                                                                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 191 = ↑p + 8 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 191 = 24 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                push_cast
                                                                                                                                                                                                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                            · by_cases hp191_185 : p % 191 = 185
                                                                                                                                                                                                                                                                                                                                              · -- p ≡ 185 (mod 191): (α=2, r=2, s=12), M = 4·2·12·2 - 1 = 191
                                                                                                                                                                                                                                                                                                                                                -- offset = (p+1152)/191, b = 48, c = 4·(2 * p + 12)/191
                                                                                                                                                                                                                                                                                                                                                have hdiv191a : 191 ∣ (p + 1152) := by omega
                                                                                                                                                                                                                                                                                                                                                have hdiv191b : 191 ∣ (2 * p + 12) := by omega
                                                                                                                                                                                                                                                                                                                                                refine ⟨(p + 1152) / 191, 48, 4 * ((2 * p + 12) / 191), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                · have : p % 4584 = 3241 := by omega
                                                                                                                                                                                                                                                                                                                                                  have h191div : (p + 1152) / 191 * 191 = p + 1152 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                                  omega
                                                                                                                                                                                                                                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                · set δ := (p + 1152) / 191 with hδ_def
                                                                                                                                                                                                                                                                                                                                                  set c₀ := (2 * p + 12) / 191 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                  have hδ_mul : δ * 191 = p + 1152 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                                  have hc₀_mul : c₀ * 191 = 2 * p + 12 := Nat.div_mul_cancel hdiv191b
                                                                                                                                                                                                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 191 = ↑p + 1152 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 191 = 2 * ↑p + 12 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                  push_cast
                                                                                                                                                                                                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                              · by_cases hp191_187 : p % 191 = 187
                                                                                                                                                                                                                                                                                                                                                · -- p ≡ 187 (mod 191): (α=1, r=48, s=1), M = 4·1·1·48 - 1 = 191
                                                                                                                                                                                                                                                                                                                                                  -- offset = (p+4)/191, b = 48, c = 48·(48 * p + 1)/191
                                                                                                                                                                                                                                                                                                                                                  have hdiv191a : 191 ∣ (p + 4) := by omega
                                                                                                                                                                                                                                                                                                                                                  have hdiv191b : 191 ∣ (48 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                  refine ⟨(p + 4) / 191, 48, 48 * ((48 * p + 1) / 191), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                  · have : p % 4584 = 3625 := by omega
                                                                                                                                                                                                                                                                                                                                                    have h191div : (p + 4) / 191 * 191 = p + 4 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                                    omega
                                                                                                                                                                                                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                  · set δ := (p + 4) / 191 with hδ_def
                                                                                                                                                                                                                                                                                                                                                    set c₀ := (48 * p + 1) / 191 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                    have hδ_mul : δ * 191 = p + 4 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                                    have hc₀_mul : c₀ * 191 = 48 * p + 1 := Nat.div_mul_cancel hdiv191b
                                                                                                                                                                                                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 191 = ↑p + 4 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 191 = 48 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                    push_cast
                                                                                                                                                                                                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                · by_cases hp191_188 : p % 191 = 188
                                                                                                                                                                                                                                                                                                                                                  · -- p ≡ 188 (mod 191): (α=1, r=4, s=12), M = 4·1·12·4 - 1 = 191
                                                                                                                                                                                                                                                                                                                                                    -- offset = (p+576)/191, b = 48, c = 4·(4 * p + 12)/191
                                                                                                                                                                                                                                                                                                                                                    have hdiv191a : 191 ∣ (p + 576) := by omega
                                                                                                                                                                                                                                                                                                                                                    have hdiv191b : 191 ∣ (4 * p + 12) := by omega
                                                                                                                                                                                                                                                                                                                                                    refine ⟨(p + 576) / 191, 48, 4 * ((4 * p + 12) / 191), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                    · have : p % 4584 = 3817 := by omega
                                                                                                                                                                                                                                                                                                                                                      have h191div : (p + 576) / 191 * 191 = p + 576 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                                      omega
                                                                                                                                                                                                                                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                    · set δ := (p + 576) / 191 with hδ_def
                                                                                                                                                                                                                                                                                                                                                      set c₀ := (4 * p + 12) / 191 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                      have hδ_mul : δ * 191 = p + 576 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                                      have hc₀_mul : c₀ * 191 = 4 * p + 12 := Nat.div_mul_cancel hdiv191b
                                                                                                                                                                                                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 191 = ↑p + 576 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 191 = 4 * ↑p + 12 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                      push_cast
                                                                                                                                                                                                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                  · by_cases hp191_189 : p % 191 = 189
                                                                                                                                                                                                                                                                                                                                                    · -- p ≡ 189 (mod 191): (α=6, r=2, s=4), M = 4·6·4·2 - 1 = 191
                                                                                                                                                                                                                                                                                                                                                      -- offset = (p+384)/191, b = 48, c = 12·(2 * p + 4)/191
                                                                                                                                                                                                                                                                                                                                                      have hdiv191a : 191 ∣ (p + 384) := by omega
                                                                                                                                                                                                                                                                                                                                                      have hdiv191b : 191 ∣ (2 * p + 4) := by omega
                                                                                                                                                                                                                                                                                                                                                      refine ⟨(p + 384) / 191, 48, 12 * ((2 * p + 4) / 191), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                      · have : p % 4584 = 4009 := by omega
                                                                                                                                                                                                                                                                                                                                                        have h191div : (p + 384) / 191 * 191 = p + 384 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                                        omega
                                                                                                                                                                                                                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                      · set δ := (p + 384) / 191 with hδ_def
                                                                                                                                                                                                                                                                                                                                                        set c₀ := (2 * p + 4) / 191 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                        have hδ_mul : δ * 191 = p + 384 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                                        have hc₀_mul : c₀ * 191 = 2 * p + 4 := Nat.div_mul_cancel hdiv191b
                                                                                                                                                                                                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 191 = ↑p + 384 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 191 = 2 * ↑p + 4 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                        push_cast
                                                                                                                                                                                                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                    · by_cases hp191_190 : p % 191 = 190
                                                                                                                                                                                                                                                                                                                                                      · -- p ≡ 190 (mod 191): (α=3, r=4, s=4), M = 4·3·4·4 - 1 = 191
                                                                                                                                                                                                                                                                                                                                                        -- offset = (p+192)/191, b = 48, c = 12·(4 * p + 4)/191
                                                                                                                                                                                                                                                                                                                                                        have hdiv191a : 191 ∣ (p + 192) := by omega
                                                                                                                                                                                                                                                                                                                                                        have hdiv191b : 191 ∣ (4 * p + 4) := by omega
                                                                                                                                                                                                                                                                                                                                                        refine ⟨(p + 192) / 191, 48, 12 * ((4 * p + 4) / 191), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                        · have : p % 4584 = 4201 := by omega
                                                                                                                                                                                                                                                                                                                                                          have h191div : (p + 192) / 191 * 191 = p + 192 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                                          omega
                                                                                                                                                                                                                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                        · set δ := (p + 192) / 191 with hδ_def
                                                                                                                                                                                                                                                                                                                                                          set c₀ := (4 * p + 4) / 191 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                          have hδ_mul : δ * 191 = p + 192 := Nat.div_mul_cancel hdiv191a
                                                                                                                                                                                                                                                                                                                                                          have hc₀_mul : c₀ * 191 = 4 * p + 4 := Nat.div_mul_cancel hdiv191b
                                                                                                                                                                                                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 191 = ↑p + 192 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 191 = 4 * ↑p + 4 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                          push_cast
                                                                                                                                                                                                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                      · -- M = 155 subcases via Lemma D.6
                                                                                                                                                                                                                                                                                                                                                        by_cases hp155_99 : p % 155 = 99
                                                                                                                                                                                                                                                                                                                                                        · -- p ≡ 99 (mod 155): (α=1, r=3, s=13), M = 4·1·13·3 - 1 = 155
                                                                                                                                                                                                                                                                                                                                                          -- offset = (p+676)/155, b = 39, c = 3·(3 * p + 13)/155
                                                                                                                                                                                                                                                                                                                                                          have hdiv155a : 155 ∣ (p + 676) := by omega
                                                                                                                                                                                                                                                                                                                                                          have hdiv155b : 155 ∣ (3 * p + 13) := by omega
                                                                                                                                                                                                                                                                                                                                                          refine ⟨(p + 676) / 155, 39, 3 * ((3 * p + 13) / 155), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                          · have : p % 3720 = 409 := by omega
                                                                                                                                                                                                                                                                                                                                                            have h155div : (p + 676) / 155 * 155 = p + 676 := Nat.div_mul_cancel hdiv155a
                                                                                                                                                                                                                                                                                                                                                            omega
                                                                                                                                                                                                                                                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                          · set δ := (p + 676) / 155 with hδ_def
                                                                                                                                                                                                                                                                                                                                                            set c₀ := (3 * p + 13) / 155 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                            have hδ_mul : δ * 155 = p + 676 := Nat.div_mul_cancel hdiv155a
                                                                                                                                                                                                                                                                                                                                                            have hc₀_mul : c₀ * 155 = 3 * p + 13 := Nat.div_mul_cancel hdiv155b
                                                                                                                                                                                                                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 155 = ↑p + 676 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 155 = 3 * ↑p + 13 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                            push_cast
                                                                                                                                                                                                                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                        · by_cases hp155_103 : p % 155 = 103
                                                                                                                                                                                                                                                                                                                                                          · -- p ≡ 103 (mod 155): (α=13, r=3, s=1), M = 4·13·1·3 - 1 = 155
                                                                                                                                                                                                                                                                                                                                                            -- offset = (p+52)/155, b = 39, c = 39·(3 * p + 1)/155
                                                                                                                                                                                                                                                                                                                                                            have hdiv155a : 155 ∣ (p + 52) := by omega
                                                                                                                                                                                                                                                                                                                                                            have hdiv155b : 155 ∣ (3 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                            refine ⟨(p + 52) / 155, 39, 39 * ((3 * p + 1) / 155), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                            · have : p % 3720 = 1033 := by omega
                                                                                                                                                                                                                                                                                                                                                              have h155div : (p + 52) / 155 * 155 = p + 52 := Nat.div_mul_cancel hdiv155a
                                                                                                                                                                                                                                                                                                                                                              omega
                                                                                                                                                                                                                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                            · set δ := (p + 52) / 155 with hδ_def
                                                                                                                                                                                                                                                                                                                                                              set c₀ := (3 * p + 1) / 155 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                              have hδ_mul : δ * 155 = p + 52 := Nat.div_mul_cancel hdiv155a
                                                                                                                                                                                                                                                                                                                                                              have hc₀_mul : c₀ * 155 = 3 * p + 1 := Nat.div_mul_cancel hdiv155b
                                                                                                                                                                                                                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 155 = ↑p + 52 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 155 = 3 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                              push_cast
                                                                                                                                                                                                                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                          · by_cases hp155_116 : p % 155 = 116
                                                                                                                                                                                                                                                                                                                                                            · -- p ≡ 116 (mod 155): (α=1, r=1, s=39), M = 4·1·39·1 - 1 = 155
                                                                                                                                                                                                                                                                                                                                                              -- offset = (p+6084)/155, b = 39, c = (p + 39)/155
                                                                                                                                                                                                                                                                                                                                                              have hdiv155a : 155 ∣ (p + 6084) := by omega
                                                                                                                                                                                                                                                                                                                                                              have hdiv155b : 155 ∣ (p + 39) := by omega
                                                                                                                                                                                                                                                                                                                                                              refine ⟨(p + 6084) / 155, 39, (p + 39) / 155, ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                              · have : p % 3720 = 1201 := by omega
                                                                                                                                                                                                                                                                                                                                                                have h155div : (p + 6084) / 155 * 155 = p + 6084 := Nat.div_mul_cancel hdiv155a
                                                                                                                                                                                                                                                                                                                                                                omega
                                                                                                                                                                                                                                                                                                                                                              · exact Nat.div_pos (by omega) (by norm_num)
                                                                                                                                                                                                                                                                                                                                                              · set δ := (p + 6084) / 155 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                set c₀ := (p + 39) / 155 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                have hδ_mul : δ * 155 = p + 6084 := Nat.div_mul_cancel hdiv155a
                                                                                                                                                                                                                                                                                                                                                                have hc₀_mul : c₀ * 155 = p + 39 := Nat.div_mul_cancel hdiv155b
                                                                                                                                                                                                                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 155 = ↑p + 6084 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 155 = ↑p + 39 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                push_cast
                                                                                                                                                                                                                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                            · by_cases hp155_119 : p % 155 = 119
                                                                                                                                                                                                                                                                                                                                                              · -- p ≡ 119 (mod 155): (α=1, r=13, s=3), M = 4·1·3·13 - 1 = 155
                                                                                                                                                                                                                                                                                                                                                                -- offset = (p+36)/155, b = 39, c = 13·(13 * p + 3)/155
                                                                                                                                                                                                                                                                                                                                                                have hdiv155a : 155 ∣ (p + 36) := by omega
                                                                                                                                                                                                                                                                                                                                                                have hdiv155b : 155 ∣ (13 * p + 3) := by omega
                                                                                                                                                                                                                                                                                                                                                                refine ⟨(p + 36) / 155, 39, 13 * ((13 * p + 3) / 155), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                · have : p % 3720 = 3529 := by omega
                                                                                                                                                                                                                                                                                                                                                                  have h155div : (p + 36) / 155 * 155 = p + 36 := Nat.div_mul_cancel hdiv155a
                                                                                                                                                                                                                                                                                                                                                                  omega
                                                                                                                                                                                                                                                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                · set δ := (p + 36) / 155 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                  set c₀ := (13 * p + 3) / 155 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                  have hδ_mul : δ * 155 = p + 36 := Nat.div_mul_cancel hdiv155a
                                                                                                                                                                                                                                                                                                                                                                  have hc₀_mul : c₀ * 155 = 13 * p + 3 := Nat.div_mul_cancel hdiv155b
                                                                                                                                                                                                                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 155 = ↑p + 36 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 155 = 13 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                  push_cast
                                                                                                                                                                                                                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                              · by_cases hp155_142 : p % 155 = 142
                                                                                                                                                                                                                                                                                                                                                                · -- p ≡ 142 (mod 155): (α=3, r=1, s=13), M = 4·3·13·1 - 1 = 155
                                                                                                                                                                                                                                                                                                                                                                  -- offset = (p+2028)/155, b = 39, c = 3·(p + 13)/155
                                                                                                                                                                                                                                                                                                                                                                  have hdiv155a : 155 ∣ (p + 2028) := by omega
                                                                                                                                                                                                                                                                                                                                                                  have hdiv155b : 155 ∣ (p + 13) := by omega
                                                                                                                                                                                                                                                                                                                                                                  refine ⟨(p + 2028) / 155, 39, 3 * ((p + 13) / 155), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                  · have : p % 3720 = 1537 := by omega
                                                                                                                                                                                                                                                                                                                                                                    have h155div : (p + 2028) / 155 * 155 = p + 2028 := Nat.div_mul_cancel hdiv155a
                                                                                                                                                                                                                                                                                                                                                                    omega
                                                                                                                                                                                                                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                  · set δ := (p + 2028) / 155 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                    set c₀ := (p + 13) / 155 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                    have hδ_mul : δ * 155 = p + 2028 := Nat.div_mul_cancel hdiv155a
                                                                                                                                                                                                                                                                                                                                                                    have hc₀_mul : c₀ * 155 = p + 13 := Nat.div_mul_cancel hdiv155b
                                                                                                                                                                                                                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 155 = ↑p + 2028 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 155 = ↑p + 13 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                    push_cast
                                                                                                                                                                                                                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                · by_cases hp155_143 : p % 155 = 143
                                                                                                                                                                                                                                                                                                                                                                  · -- p ≡ 143 (mod 155): (α=3, r=13, s=1), M = 4·3·1·13 - 1 = 155
                                                                                                                                                                                                                                                                                                                                                                    -- offset = (p+12)/155, b = 39, c = 39·(13 * p + 1)/155
                                                                                                                                                                                                                                                                                                                                                                    have hdiv155a : 155 ∣ (p + 12) := by omega
                                                                                                                                                                                                                                                                                                                                                                    have hdiv155b : 155 ∣ (13 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                    refine ⟨(p + 12) / 155, 39, 39 * ((13 * p + 1) / 155), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                    · have : p % 3720 = 3553 := by omega
                                                                                                                                                                                                                                                                                                                                                                      have h155div : (p + 12) / 155 * 155 = p + 12 := Nat.div_mul_cancel hdiv155a
                                                                                                                                                                                                                                                                                                                                                                      omega
                                                                                                                                                                                                                                                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                    · set δ := (p + 12) / 155 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                      set c₀ := (13 * p + 1) / 155 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                      have hδ_mul : δ * 155 = p + 12 := Nat.div_mul_cancel hdiv155a
                                                                                                                                                                                                                                                                                                                                                                      have hc₀_mul : c₀ * 155 = 13 * p + 1 := Nat.div_mul_cancel hdiv155b
                                                                                                                                                                                                                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 155 = ↑p + 12 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 155 = 13 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                      push_cast
                                                                                                                                                                                                                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                  · by_cases hp155_151 : p % 155 = 151
                                                                                                                                                                                                                                                                                                                                                                    · -- p ≡ 151 (mod 155): (α=1, r=39, s=1), M = 4·1·1·39 - 1 = 155
                                                                                                                                                                                                                                                                                                                                                                      -- offset = (p+4)/155, b = 39, c = 39·(39 * p + 1)/155
                                                                                                                                                                                                                                                                                                                                                                      have hdiv155a : 155 ∣ (p + 4) := by omega
                                                                                                                                                                                                                                                                                                                                                                      have hdiv155b : 155 ∣ (39 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                      refine ⟨(p + 4) / 155, 39, 39 * ((39 * p + 1) / 155), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                      · have : p % 3720 = 1081 := by omega
                                                                                                                                                                                                                                                                                                                                                                        have h155div : (p + 4) / 155 * 155 = p + 4 := Nat.div_mul_cancel hdiv155a
                                                                                                                                                                                                                                                                                                                                                                        omega
                                                                                                                                                                                                                                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                      · set δ := (p + 4) / 155 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                        set c₀ := (39 * p + 1) / 155 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                        have hδ_mul : δ * 155 = p + 4 := Nat.div_mul_cancel hdiv155a
                                                                                                                                                                                                                                                                                                                                                                        have hc₀_mul : c₀ * 155 = 39 * p + 1 := Nat.div_mul_cancel hdiv155b
                                                                                                                                                                                                                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 155 = ↑p + 4 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 155 = 39 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                        push_cast
                                                                                                                                                                                                                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                    · by_cases hp155_152 : p % 155 = 152
                                                                                                                                                                                                                                                                                                                                                                      · -- p ≡ 152 (mod 155): (α=13, r=1, s=3), M = 4·13·3·1 - 1 = 155
                                                                                                                                                                                                                                                                                                                                                                        -- offset = (p+468)/155, b = 39, c = 13·(p + 3)/155
                                                                                                                                                                                                                                                                                                                                                                        have hdiv155a : 155 ∣ (p + 468) := by omega
                                                                                                                                                                                                                                                                                                                                                                        have hdiv155b : 155 ∣ (p + 3) := by omega
                                                                                                                                                                                                                                                                                                                                                                        refine ⟨(p + 468) / 155, 39, 13 * ((p + 3) / 155), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                        · have : p % 3720 = 3097 := by omega
                                                                                                                                                                                                                                                                                                                                                                          have h155div : (p + 468) / 155 * 155 = p + 468 := Nat.div_mul_cancel hdiv155a
                                                                                                                                                                                                                                                                                                                                                                          omega
                                                                                                                                                                                                                                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                        · set δ := (p + 468) / 155 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                          set c₀ := (p + 3) / 155 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                          have hδ_mul : δ * 155 = p + 468 := Nat.div_mul_cancel hdiv155a
                                                                                                                                                                                                                                                                                                                                                                          have hc₀_mul : c₀ * 155 = p + 3 := Nat.div_mul_cancel hdiv155b
                                                                                                                                                                                                                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 155 = ↑p + 468 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 155 = ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                          push_cast
                                                                                                                                                                                                                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                      · by_cases hp155_154 : p % 155 = 154
                                                                                                                                                                                                                                                                                                                                                                        · -- p ≡ 154 (mod 155): (α=39, r=1, s=1), M = 4·39·1·1 - 1 = 155
                                                                                                                                                                                                                                                                                                                                                                          -- offset = (p+156)/155, b = 39, c = 39·(p + 1)/155
                                                                                                                                                                                                                                                                                                                                                                          have hdiv155a : 155 ∣ (p + 156) := by omega
                                                                                                                                                                                                                                                                                                                                                                          have hdiv155b : 155 ∣ (p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                          refine ⟨(p + 156) / 155, 39, 39 * ((p + 1) / 155), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                          · have : p % 3720 = 3409 := by omega
                                                                                                                                                                                                                                                                                                                                                                            have h155div : (p + 156) / 155 * 155 = p + 156 := Nat.div_mul_cancel hdiv155a
                                                                                                                                                                                                                                                                                                                                                                            omega
                                                                                                                                                                                                                                                                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                          · set δ := (p + 156) / 155 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                            set c₀ := (p + 1) / 155 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                            have hδ_mul : δ * 155 = p + 156 := Nat.div_mul_cancel hdiv155a
                                                                                                                                                                                                                                                                                                                                                                            have hc₀_mul : c₀ * 155 = p + 1 := Nat.div_mul_cancel hdiv155b
                                                                                                                                                                                                                                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 155 = ↑p + 156 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 155 = ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                            push_cast
                                                                                                                                                                                                                                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                        · -- M = 199 subcases via Lemma D.6
                                                                                                                                                                                                                                                                                                                                                                          by_cases hp199_87 : p % 199 = 87
                                                                                                                                                                                                                                                                                                                                                                          · -- p ≡ 87 (mod 199): (α=1, r=2, s=25), M = 4·1·25·2 - 1 = 199
                                                                                                                                                                                                                                                                                                                                                                            -- offset = (p+2500)/199, b = 50, c = 2·(2 * p + 25)/199
                                                                                                                                                                                                                                                                                                                                                                            have hdiv199a : 199 ∣ (p + 2500) := by omega
                                                                                                                                                                                                                                                                                                                                                                            have hdiv199b : 199 ∣ (2 * p + 25) := by omega
                                                                                                                                                                                                                                                                                                                                                                            refine ⟨(p + 2500) / 199, 50, 2 * ((2 * p + 25) / 199), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                            · have : p % 4776 = 4465 := by omega
                                                                                                                                                                                                                                                                                                                                                                              have h199div : (p + 2500) / 199 * 199 = p + 2500 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                              omega
                                                                                                                                                                                                                                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                            · set δ := (p + 2500) / 199 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                              set c₀ := (2 * p + 25) / 199 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                              have hδ_mul : δ * 199 = p + 2500 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                              have hc₀_mul : c₀ * 199 = 2 * p + 25 := Nat.div_mul_cancel hdiv199b
                                                                                                                                                                                                                                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 199 = ↑p + 2500 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 199 = 2 * ↑p + 25 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                              push_cast
                                                                                                                                                                                                                                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                          · by_cases hp199_97 : p % 199 = 97
                                                                                                                                                                                                                                                                                                                                                                            · -- p ≡ 97 (mod 199): (α=5, r=2, s=5), M = 4·5·5·2 - 1 = 199
                                                                                                                                                                                                                                                                                                                                                                              -- offset = (p+500)/199, b = 50, c = 10·(2 * p + 5)/199
                                                                                                                                                                                                                                                                                                                                                                              have hdiv199a : 199 ∣ (p + 500) := by omega
                                                                                                                                                                                                                                                                                                                                                                              have hdiv199b : 199 ∣ (2 * p + 5) := by omega
                                                                                                                                                                                                                                                                                                                                                                              refine ⟨(p + 500) / 199, 50, 10 * ((2 * p + 5) / 199), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                              · have : p % 4776 = 97 := by omega
                                                                                                                                                                                                                                                                                                                                                                                have h199div : (p + 500) / 199 * 199 = p + 500 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                omega
                                                                                                                                                                                                                                                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                              · set δ := (p + 500) / 199 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                set c₀ := (2 * p + 5) / 199 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                have hδ_mul : δ * 199 = p + 500 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                have hc₀_mul : c₀ * 199 = 2 * p + 5 := Nat.div_mul_cancel hdiv199b
                                                                                                                                                                                                                                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 199 = ↑p + 500 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 199 = 2 * ↑p + 5 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                push_cast
                                                                                                                                                                                                                                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                            · by_cases hp199_99 : p % 199 = 99
                                                                                                                                                                                                                                                                                                                                                                              · -- p ≡ 99 (mod 199): (α=1, r=10, s=5), M = 4·1·5·10 - 1 = 199
                                                                                                                                                                                                                                                                                                                                                                                -- offset = (p+100)/199, b = 50, c = 10·(10 * p + 5)/199
                                                                                                                                                                                                                                                                                                                                                                                have hdiv199a : 199 ∣ (p + 100) := by omega
                                                                                                                                                                                                                                                                                                                                                                                have hdiv199b : 199 ∣ (10 * p + 5) := by omega
                                                                                                                                                                                                                                                                                                                                                                                refine ⟨(p + 100) / 199, 50, 10 * ((10 * p + 5) / 199), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                · have : p % 4776 = 2089 := by omega
                                                                                                                                                                                                                                                                                                                                                                                  have h199div : (p + 100) / 199 * 199 = p + 100 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                  omega
                                                                                                                                                                                                                                                                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                · set δ := (p + 100) / 199 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                  set c₀ := (10 * p + 5) / 199 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                  have hδ_mul : δ * 199 = p + 100 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                  have hc₀_mul : c₀ * 199 = 10 * p + 5 := Nat.div_mul_cancel hdiv199b
                                                                                                                                                                                                                                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 199 = ↑p + 100 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 199 = 10 * ↑p + 5 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                  push_cast
                                                                                                                                                                                                                                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                              · by_cases hp199_119 : p % 199 = 119
                                                                                                                                                                                                                                                                                                                                                                                · -- p ≡ 119 (mod 199): (α=5, r=5, s=2), M = 4·5·2·5 - 1 = 199
                                                                                                                                                                                                                                                                                                                                                                                  -- offset = (p+80)/199, b = 50, c = 25·(5 * p + 2)/199
                                                                                                                                                                                                                                                                                                                                                                                  have hdiv199a : 199 ∣ (p + 80) := by omega
                                                                                                                                                                                                                                                                                                                                                                                  have hdiv199b : 199 ∣ (5 * p + 2) := by omega
                                                                                                                                                                                                                                                                                                                                                                                  refine ⟨(p + 80) / 199, 50, 25 * ((5 * p + 2) / 199), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                  · have : p % 4776 = 2905 := by omega
                                                                                                                                                                                                                                                                                                                                                                                    have h199div : (p + 80) / 199 * 199 = p + 80 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                    omega
                                                                                                                                                                                                                                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                  · set δ := (p + 80) / 199 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                    set c₀ := (5 * p + 2) / 199 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                    have hδ_mul : δ * 199 = p + 80 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                    have hc₀_mul : c₀ * 199 = 5 * p + 2 := Nat.div_mul_cancel hdiv199b
                                                                                                                                                                                                                                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 199 = ↑p + 80 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 199 = 5 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                    push_cast
                                                                                                                                                                                                                                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                · by_cases hp199_149 : p % 199 = 149
                                                                                                                                                                                                                                                                                                                                                                                  · -- p ≡ 149 (mod 199): (α=1, r=1, s=50), M = 4·1·50·1 - 1 = 199
                                                                                                                                                                                                                                                                                                                                                                                    -- offset = (p+10000)/199, b = 50, c = (p + 50)/199
                                                                                                                                                                                                                                                                                                                                                                                    have hdiv199a : 199 ∣ (p + 10000) := by omega
                                                                                                                                                                                                                                                                                                                                                                                    have hdiv199b : 199 ∣ (p + 50) := by omega
                                                                                                                                                                                                                                                                                                                                                                                    refine ⟨(p + 10000) / 199, 50, (p + 50) / 199, ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                    · have : p % 4776 = 4129 := by omega
                                                                                                                                                                                                                                                                                                                                                                                      have h199div : (p + 10000) / 199 * 199 = p + 10000 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                      omega
                                                                                                                                                                                                                                                                                                                                                                                    · exact Nat.div_pos (by omega) (by norm_num)
                                                                                                                                                                                                                                                                                                                                                                                    · set δ := (p + 10000) / 199 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                      set c₀ := (p + 50) / 199 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                      have hδ_mul : δ * 199 = p + 10000 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                      have hc₀_mul : c₀ * 199 = p + 50 := Nat.div_mul_cancel hdiv199b
                                                                                                                                                                                                                                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 199 = ↑p + 10000 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 199 = ↑p + 50 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                      push_cast
                                                                                                                                                                                                                                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                  · by_cases hp199_159 : p % 199 = 159
                                                                                                                                                                                                                                                                                                                                                                                    · -- p ≡ 159 (mod 199): (α=10, r=5, s=1), M = 4·10·1·5 - 1 = 199
                                                                                                                                                                                                                                                                                                                                                                                      -- offset = (p+40)/199, b = 50, c = 50·(5 * p + 1)/199
                                                                                                                                                                                                                                                                                                                                                                                      have hdiv199a : 199 ∣ (p + 40) := by omega
                                                                                                                                                                                                                                                                                                                                                                                      have hdiv199b : 199 ∣ (5 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                      refine ⟨(p + 40) / 199, 50, 50 * ((5 * p + 1) / 199), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                      · have : p % 4776 = 4537 := by omega
                                                                                                                                                                                                                                                                                                                                                                                        have h199div : (p + 40) / 199 * 199 = p + 40 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                        omega
                                                                                                                                                                                                                                                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                      · set δ := (p + 40) / 199 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                        set c₀ := (5 * p + 1) / 199 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                        have hδ_mul : δ * 199 = p + 40 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                        have hc₀_mul : c₀ * 199 = 5 * p + 1 := Nat.div_mul_cancel hdiv199b
                                                                                                                                                                                                                                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 199 = ↑p + 40 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 199 = 5 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                        push_cast
                                                                                                                                                                                                                                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                    · by_cases hp199_174 : p % 199 = 174
                                                                                                                                                                                                                                                                                                                                                                                      · -- p ≡ 174 (mod 199): (α=2, r=1, s=25), M = 4·2·25·1 - 1 = 199
                                                                                                                                                                                                                                                                                                                                                                                        -- offset = (p+5000)/199, b = 50, c = 2·(p + 25)/199
                                                                                                                                                                                                                                                                                                                                                                                        have hdiv199a : 199 ∣ (p + 5000) := by omega
                                                                                                                                                                                                                                                                                                                                                                                        have hdiv199b : 199 ∣ (p + 25) := by omega
                                                                                                                                                                                                                                                                                                                                                                                        refine ⟨(p + 5000) / 199, 50, 2 * ((p + 25) / 199), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                        · have : p % 4776 = 2761 := by omega
                                                                                                                                                                                                                                                                                                                                                                                          have h199div : (p + 5000) / 199 * 199 = p + 5000 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                          omega
                                                                                                                                                                                                                                                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                        · set δ := (p + 5000) / 199 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                          set c₀ := (p + 25) / 199 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                          have hδ_mul : δ * 199 = p + 5000 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                          have hc₀_mul : c₀ * 199 = p + 25 := Nat.div_mul_cancel hdiv199b
                                                                                                                                                                                                                                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 199 = ↑p + 5000 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 199 = ↑p + 25 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                          push_cast
                                                                                                                                                                                                                                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                      · by_cases hp199_179 : p % 199 = 179
                                                                                                                                                                                                                                                                                                                                                                                        · -- p ≡ 179 (mod 199): (α=5, r=10, s=1), M = 4·5·1·10 - 1 = 199
                                                                                                                                                                                                                                                                                                                                                                                          -- offset = (p+20)/199, b = 50, c = 50·(10 * p + 1)/199
                                                                                                                                                                                                                                                                                                                                                                                          have hdiv199a : 199 ∣ (p + 20) := by omega
                                                                                                                                                                                                                                                                                                                                                                                          have hdiv199b : 199 ∣ (10 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                          refine ⟨(p + 20) / 199, 50, 50 * ((10 * p + 1) / 199), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                          · have : p % 4776 = 577 := by omega
                                                                                                                                                                                                                                                                                                                                                                                            have h199div : (p + 20) / 199 * 199 = p + 20 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                            omega
                                                                                                                                                                                                                                                                                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                          · set δ := (p + 20) / 199 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                            set c₀ := (10 * p + 1) / 199 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                            have hδ_mul : δ * 199 = p + 20 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                            have hc₀_mul : c₀ * 199 = 10 * p + 1 := Nat.div_mul_cancel hdiv199b
                                                                                                                                                                                                                                                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 199 = ↑p + 20 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 199 = 10 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                            push_cast
                                                                                                                                                                                                                                                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                        · by_cases hp199_183 : p % 199 = 183
                                                                                                                                                                                                                                                                                                                                                                                          · -- p ≡ 183 (mod 199): (α=1, r=25, s=2), M = 4·1·2·25 - 1 = 199
                                                                                                                                                                                                                                                                                                                                                                                            -- offset = (p+16)/199, b = 50, c = 25·(25 * p + 2)/199
                                                                                                                                                                                                                                                                                                                                                                                            have hdiv199a : 199 ∣ (p + 16) := by omega
                                                                                                                                                                                                                                                                                                                                                                                            have hdiv199b : 199 ∣ (25 * p + 2) := by omega
                                                                                                                                                                                                                                                                                                                                                                                            refine ⟨(p + 16) / 199, 50, 25 * ((25 * p + 2) / 199), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                            · have : p % 4776 = 4561 := by omega
                                                                                                                                                                                                                                                                                                                                                                                              have h199div : (p + 16) / 199 * 199 = p + 16 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                              omega
                                                                                                                                                                                                                                                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                            · set δ := (p + 16) / 199 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                              set c₀ := (25 * p + 2) / 199 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                              have hδ_mul : δ * 199 = p + 16 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                              have hc₀_mul : c₀ * 199 = 25 * p + 2 := Nat.div_mul_cancel hdiv199b
                                                                                                                                                                                                                                                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 199 = ↑p + 16 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 199 = 25 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                              push_cast
                                                                                                                                                                                                                                                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                          · by_cases hp199_189 : p % 199 = 189
                                                                                                                                                                                                                                                                                                                                                                                            · -- p ≡ 189 (mod 199): (α=5, r=1, s=10), M = 4·5·10·1 - 1 = 199
                                                                                                                                                                                                                                                                                                                                                                                              -- offset = (p+2000)/199, b = 50, c = 5·(p + 10)/199
                                                                                                                                                                                                                                                                                                                                                                                              have hdiv199a : 199 ∣ (p + 2000) := by omega
                                                                                                                                                                                                                                                                                                                                                                                              have hdiv199b : 199 ∣ (p + 10) := by omega
                                                                                                                                                                                                                                                                                                                                                                                              refine ⟨(p + 2000) / 199, 50, 5 * ((p + 10) / 199), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                              · have : p % 4776 = 985 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                have h199div : (p + 2000) / 199 * 199 = p + 2000 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                                omega
                                                                                                                                                                                                                                                                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                              · set δ := (p + 2000) / 199 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                set c₀ := (p + 10) / 199 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                have hδ_mul : δ * 199 = p + 2000 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                                have hc₀_mul : c₀ * 199 = p + 10 := Nat.div_mul_cancel hdiv199b
                                                                                                                                                                                                                                                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 199 = ↑p + 2000 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 199 = ↑p + 10 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                push_cast
                                                                                                                                                                                                                                                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                            · by_cases hp199_191 : p % 199 = 191
                                                                                                                                                                                                                                                                                                                                                                                              · -- p ≡ 191 (mod 199): (α=2, r=25, s=1), M = 4·2·1·25 - 1 = 199
                                                                                                                                                                                                                                                                                                                                                                                                -- offset = (p+8)/199, b = 50, c = 50·(25 * p + 1)/199
                                                                                                                                                                                                                                                                                                                                                                                                have hdiv199a : 199 ∣ (p + 8) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                have hdiv199b : 199 ∣ (25 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                refine ⟨(p + 8) / 199, 50, 50 * ((25 * p + 1) / 199), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                · have : p % 4776 = 2977 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                  have h199div : (p + 8) / 199 * 199 = p + 8 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                                  omega
                                                                                                                                                                                                                                                                                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                · set δ := (p + 8) / 199 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                  set c₀ := (25 * p + 1) / 199 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                  have hδ_mul : δ * 199 = p + 8 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                                  have hc₀_mul : c₀ * 199 = 25 * p + 1 := Nat.div_mul_cancel hdiv199b
                                                                                                                                                                                                                                                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 199 = ↑p + 8 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 199 = 25 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                  push_cast
                                                                                                                                                                                                                                                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                              · by_cases hp199_194 : p % 199 = 194
                                                                                                                                                                                                                                                                                                                                                                                                · -- p ≡ 194 (mod 199): (α=10, r=1, s=5), M = 4·10·5·1 - 1 = 199
                                                                                                                                                                                                                                                                                                                                                                                                  -- offset = (p+1000)/199, b = 50, c = 10·(p + 5)/199
                                                                                                                                                                                                                                                                                                                                                                                                  have hdiv199a : 199 ∣ (p + 1000) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                  have hdiv199b : 199 ∣ (p + 5) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                  refine ⟨(p + 1000) / 199, 50, 10 * ((p + 5) / 199), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                  · have : p % 4776 = 3577 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                    have h199div : (p + 1000) / 199 * 199 = p + 1000 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                                    omega
                                                                                                                                                                                                                                                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                  · set δ := (p + 1000) / 199 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                    set c₀ := (p + 5) / 199 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                    have hδ_mul : δ * 199 = p + 1000 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                                    have hc₀_mul : c₀ * 199 = p + 5 := Nat.div_mul_cancel hdiv199b
                                                                                                                                                                                                                                                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 199 = ↑p + 1000 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 199 = ↑p + 5 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                    push_cast
                                                                                                                                                                                                                                                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                · by_cases hp199_195 : p % 199 = 195
                                                                                                                                                                                                                                                                                                                                                                                                  · -- p ≡ 195 (mod 199): (α=1, r=50, s=1), M = 4·1·1·50 - 1 = 199
                                                                                                                                                                                                                                                                                                                                                                                                    -- offset = (p+4)/199, b = 50, c = 50·(50 * p + 1)/199
                                                                                                                                                                                                                                                                                                                                                                                                    have hdiv199a : 199 ∣ (p + 4) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                    have hdiv199b : 199 ∣ (50 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                    refine ⟨(p + 4) / 199, 50, 50 * ((50 * p + 1) / 199), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                    · have : p % 4776 = 2185 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                      have h199div : (p + 4) / 199 * 199 = p + 4 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                                      omega
                                                                                                                                                                                                                                                                                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                    · set δ := (p + 4) / 199 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                      set c₀ := (50 * p + 1) / 199 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                      have hδ_mul : δ * 199 = p + 4 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                                      have hc₀_mul : c₀ * 199 = 50 * p + 1 := Nat.div_mul_cancel hdiv199b
                                                                                                                                                                                                                                                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 199 = ↑p + 4 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 199 = 50 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                      push_cast
                                                                                                                                                                                                                                                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                  · by_cases hp199_197 : p % 199 = 197
                                                                                                                                                                                                                                                                                                                                                                                                    · -- p ≡ 197 (mod 199): (α=1, r=5, s=10), M = 4·1·10·5 - 1 = 199
                                                                                                                                                                                                                                                                                                                                                                                                      -- offset = (p+400)/199, b = 50, c = 5·(5 * p + 10)/199
                                                                                                                                                                                                                                                                                                                                                                                                      have hdiv199a : 199 ∣ (p + 400) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                      have hdiv199b : 199 ∣ (5 * p + 10) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                      refine ⟨(p + 400) / 199, 50, 5 * ((5 * p + 10) / 199), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                      · have : p % 4776 = 4177 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                        have h199div : (p + 400) / 199 * 199 = p + 400 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                                        omega
                                                                                                                                                                                                                                                                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                      · set δ := (p + 400) / 199 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                        set c₀ := (5 * p + 10) / 199 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                        have hδ_mul : δ * 199 = p + 400 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                                        have hc₀_mul : c₀ * 199 = 5 * p + 10 := Nat.div_mul_cancel hdiv199b
                                                                                                                                                                                                                                                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 199 = ↑p + 400 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 199 = 5 * ↑p + 10 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                        push_cast
                                                                                                                                                                                                                                                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                    · by_cases hp199_198 : p % 199 = 198
                                                                                                                                                                                                                                                                                                                                                                                                      · -- p ≡ 198 (mod 199): (α=2, r=5, s=5), M = 4·2·5·5 - 1 = 199
                                                                                                                                                                                                                                                                                                                                                                                                        -- offset = (p+200)/199, b = 50, c = 10·(5 * p + 5)/199
                                                                                                                                                                                                                                                                                                                                                                                                        have hdiv199a : 199 ∣ (p + 200) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                        have hdiv199b : 199 ∣ (5 * p + 5) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                        refine ⟨(p + 200) / 199, 50, 10 * ((5 * p + 5) / 199), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                        · have : p % 4776 = 2785 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                          have h199div : (p + 200) / 199 * 199 = p + 200 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                                          omega
                                                                                                                                                                                                                                                                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                        · set δ := (p + 200) / 199 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                          set c₀ := (5 * p + 5) / 199 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                          have hδ_mul : δ * 199 = p + 200 := Nat.div_mul_cancel hdiv199a
                                                                                                                                                                                                                                                                                                                                                                                                          have hc₀_mul : c₀ * 199 = 5 * p + 5 := Nat.div_mul_cancel hdiv199b
                                                                                                                                                                                                                                                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 199 = ↑p + 200 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 199 = 5 * ↑p + 5 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                          push_cast
                                                                                                                                                                                                                                                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                      · -- M = 83 subcases via Lemma D.6
                                                                                                                                                                                                                                                                                                                                                                                                        by_cases hp83_47 : p % 83 = 47
                                                                                                                                                                                                                                                                                                                                                                                                        · -- p ≡ 47 (mod 83): (α=1, r=7, s=3), M = 4·1·3·7 - 1 = 83
                                                                                                                                                                                                                                                                                                                                                                                                          -- offset = (p+36)/83, b = 21, c = 7·(7 * p + 3)/83
                                                                                                                                                                                                                                                                                                                                                                                                          have hdiv83a : 83 ∣ (p + 36) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                          have hdiv83b : 83 ∣ (7 * p + 3) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                          refine ⟨(p + 36) / 83, 21, 7 * ((7 * p + 3) / 83), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                          · have : p % 1992 = 1873 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                            have h83div : (p + 36) / 83 * 83 = p + 36 := Nat.div_mul_cancel hdiv83a
                                                                                                                                                                                                                                                                                                                                                                                                            omega
                                                                                                                                                                                                                                                                                                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                          · set δ := (p + 36) / 83 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                            set c₀ := (7 * p + 3) / 83 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                            have hδ_mul : δ * 83 = p + 36 := Nat.div_mul_cancel hdiv83a
                                                                                                                                                                                                                                                                                                                                                                                                            have hc₀_mul : c₀ * 83 = 7 * p + 3 := Nat.div_mul_cancel hdiv83b
                                                                                                                                                                                                                                                                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 83 = ↑p + 36 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 83 = 7 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                            push_cast
                                                                                                                                                                                                                                                                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                        · by_cases hp83_53 : p % 83 = 53
                                                                                                                                                                                                                                                                                                                                                                                                          · -- p ≡ 53 (mod 83): (α=1, r=3, s=7), M = 4·1·7·3 - 1 = 83
                                                                                                                                                                                                                                                                                                                                                                                                            -- offset = (p+196)/83, b = 21, c = 3·(3 * p + 7)/83
                                                                                                                                                                                                                                                                                                                                                                                                            have hdiv83a : 83 ∣ (p + 196) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                            have hdiv83b : 83 ∣ (3 * p + 7) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                            refine ⟨(p + 196) / 83, 21, 3 * ((3 * p + 7) / 83), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                            · have : p % 1992 = 385 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                              have h83div : (p + 196) / 83 * 83 = p + 196 := Nat.div_mul_cancel hdiv83a
                                                                                                                                                                                                                                                                                                                                                                                                              omega
                                                                                                                                                                                                                                                                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                            · set δ := (p + 196) / 83 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                              set c₀ := (3 * p + 7) / 83 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                              have hδ_mul : δ * 83 = p + 196 := Nat.div_mul_cancel hdiv83a
                                                                                                                                                                                                                                                                                                                                                                                                              have hc₀_mul : c₀ * 83 = 3 * p + 7 := Nat.div_mul_cancel hdiv83b
                                                                                                                                                                                                                                                                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 83 = ↑p + 196 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 83 = 3 * ↑p + 7 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                              push_cast
                                                                                                                                                                                                                                                                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                          · by_cases hp83_55 : p % 83 = 55
                                                                                                                                                                                                                                                                                                                                                                                                            · -- p ≡ 55 (mod 83): (α=7, r=3, s=1), M = 4·7·1·3 - 1 = 83
                                                                                                                                                                                                                                                                                                                                                                                                              -- offset = (p+28)/83, b = 21, c = 21·(3 * p + 1)/83
                                                                                                                                                                                                                                                                                                                                                                                                              have hdiv83a : 83 ∣ (p + 28) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                              have hdiv83b : 83 ∣ (3 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                              refine ⟨(p + 28) / 83, 21, 21 * ((3 * p + 1) / 83), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                              · have : p % 1992 = 553 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                have h83div : (p + 28) / 83 * 83 = p + 28 := Nat.div_mul_cancel hdiv83a
                                                                                                                                                                                                                                                                                                                                                                                                                omega
                                                                                                                                                                                                                                                                                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                              · set δ := (p + 28) / 83 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                set c₀ := (3 * p + 1) / 83 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                have hδ_mul : δ * 83 = p + 28 := Nat.div_mul_cancel hdiv83a
                                                                                                                                                                                                                                                                                                                                                                                                                have hc₀_mul : c₀ * 83 = 3 * p + 1 := Nat.div_mul_cancel hdiv83b
                                                                                                                                                                                                                                                                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 83 = ↑p + 28 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 83 = 3 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                            · by_cases hp83_62 : p % 83 = 62
                                                                                                                                                                                                                                                                                                                                                                                                              · -- p ≡ 62 (mod 83): (α=1, r=1, s=21), M = 4·1·21·1 - 1 = 83
                                                                                                                                                                                                                                                                                                                                                                                                                -- offset = (p+1764)/83, b = 21, c = (p + 21)/83
                                                                                                                                                                                                                                                                                                                                                                                                                have hdiv83a : 83 ∣ (p + 1764) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                have hdiv83b : 83 ∣ (p + 21) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                refine ⟨(p + 1764) / 83, 21, (p + 21) / 83, ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                · have : p % 1992 = 145 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                  have h83div : (p + 1764) / 83 * 83 = p + 1764 := Nat.div_mul_cancel hdiv83a
                                                                                                                                                                                                                                                                                                                                                                                                                  omega
                                                                                                                                                                                                                                                                                                                                                                                                                · exact Nat.div_pos (by omega) (by norm_num)
                                                                                                                                                                                                                                                                                                                                                                                                                · set δ := (p + 1764) / 83 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                  set c₀ := (p + 21) / 83 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                  have hδ_mul : δ * 83 = p + 1764 := Nat.div_mul_cancel hdiv83a
                                                                                                                                                                                                                                                                                                                                                                                                                  have hc₀_mul : c₀ * 83 = p + 21 := Nat.div_mul_cancel hdiv83b
                                                                                                                                                                                                                                                                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 83 = ↑p + 1764 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 83 = ↑p + 21 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                  push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                              · by_cases hp83_71 : p % 83 = 71
                                                                                                                                                                                                                                                                                                                                                                                                                · -- p ≡ 71 (mod 83): (α=3, r=7, s=1), M = 4·3·1·7 - 1 = 83
                                                                                                                                                                                                                                                                                                                                                                                                                  -- offset = (p+12)/83, b = 21, c = 21·(7 * p + 1)/83
                                                                                                                                                                                                                                                                                                                                                                                                                  have hdiv83a : 83 ∣ (p + 12) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                  have hdiv83b : 83 ∣ (7 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                  refine ⟨(p + 12) / 83, 21, 21 * ((7 * p + 1) / 83), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                  · have : p % 1992 = 1897 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                    have h83div : (p + 12) / 83 * 83 = p + 12 := Nat.div_mul_cancel hdiv83a
                                                                                                                                                                                                                                                                                                                                                                                                                    omega
                                                                                                                                                                                                                                                                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                  · set δ := (p + 12) / 83 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                    set c₀ := (7 * p + 1) / 83 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                    have hδ_mul : δ * 83 = p + 12 := Nat.div_mul_cancel hdiv83a
                                                                                                                                                                                                                                                                                                                                                                                                                    have hc₀_mul : c₀ * 83 = 7 * p + 1 := Nat.div_mul_cancel hdiv83b
                                                                                                                                                                                                                                                                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 83 = ↑p + 12 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 83 = 7 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                    push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                · by_cases hp83_76 : p % 83 = 76
                                                                                                                                                                                                                                                                                                                                                                                                                  · -- p ≡ 76 (mod 83): (α=3, r=1, s=7), M = 4·3·7·1 - 1 = 83
                                                                                                                                                                                                                                                                                                                                                                                                                    -- offset = (p+588)/83, b = 21, c = 3·(p + 7)/83
                                                                                                                                                                                                                                                                                                                                                                                                                    have hdiv83a : 83 ∣ (p + 588) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                    have hdiv83b : 83 ∣ (p + 7) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                    refine ⟨(p + 588) / 83, 21, 3 * ((p + 7) / 83), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                    · have : p % 1992 = 1321 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                      have h83div : (p + 588) / 83 * 83 = p + 588 := Nat.div_mul_cancel hdiv83a
                                                                                                                                                                                                                                                                                                                                                                                                                      omega
                                                                                                                                                                                                                                                                                                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                    · set δ := (p + 588) / 83 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                      set c₀ := (p + 7) / 83 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                      have hδ_mul : δ * 83 = p + 588 := Nat.div_mul_cancel hdiv83a
                                                                                                                                                                                                                                                                                                                                                                                                                      have hc₀_mul : c₀ * 83 = p + 7 := Nat.div_mul_cancel hdiv83b
                                                                                                                                                                                                                                                                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 83 = ↑p + 588 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 83 = ↑p + 7 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                      push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                  · by_cases hp83_79 : p % 83 = 79
                                                                                                                                                                                                                                                                                                                                                                                                                    · -- p ≡ 79 (mod 83): (α=1, r=21, s=1), M = 4·1·1·21 - 1 = 83
                                                                                                                                                                                                                                                                                                                                                                                                                      -- offset = (p+4)/83, b = 21, c = 21·(21 * p + 1)/83
                                                                                                                                                                                                                                                                                                                                                                                                                      have hdiv83a : 83 ∣ (p + 4) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                      have hdiv83b : 83 ∣ (21 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                      refine ⟨(p + 4) / 83, 21, 21 * ((21 * p + 1) / 83), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                      · have : p % 1992 = 577 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                        have h83div : (p + 4) / 83 * 83 = p + 4 := Nat.div_mul_cancel hdiv83a
                                                                                                                                                                                                                                                                                                                                                                                                                        omega
                                                                                                                                                                                                                                                                                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                      · set δ := (p + 4) / 83 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                        set c₀ := (21 * p + 1) / 83 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                        have hδ_mul : δ * 83 = p + 4 := Nat.div_mul_cancel hdiv83a
                                                                                                                                                                                                                                                                                                                                                                                                                        have hc₀_mul : c₀ * 83 = 21 * p + 1 := Nat.div_mul_cancel hdiv83b
                                                                                                                                                                                                                                                                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 83 = ↑p + 4 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 83 = 21 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                        push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                    · by_cases hp83_80 : p % 83 = 80
                                                                                                                                                                                                                                                                                                                                                                                                                      · -- p ≡ 80 (mod 83): (α=7, r=1, s=3), M = 4·7·3·1 - 1 = 83
                                                                                                                                                                                                                                                                                                                                                                                                                        -- offset = (p+252)/83, b = 21, c = 7·(p + 3)/83
                                                                                                                                                                                                                                                                                                                                                                                                                        have hdiv83a : 83 ∣ (p + 252) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                        have hdiv83b : 83 ∣ (p + 3) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                        refine ⟨(p + 252) / 83, 21, 7 * ((p + 3) / 83), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                        · have : p % 1992 = 1657 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                          have h83div : (p + 252) / 83 * 83 = p + 252 := Nat.div_mul_cancel hdiv83a
                                                                                                                                                                                                                                                                                                                                                                                                                          omega
                                                                                                                                                                                                                                                                                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                        · set δ := (p + 252) / 83 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                          set c₀ := (p + 3) / 83 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                          have hδ_mul : δ * 83 = p + 252 := Nat.div_mul_cancel hdiv83a
                                                                                                                                                                                                                                                                                                                                                                                                                          have hc₀_mul : c₀ * 83 = p + 3 := Nat.div_mul_cancel hdiv83b
                                                                                                                                                                                                                                                                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 83 = ↑p + 252 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 83 = ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                          push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                      · by_cases hp83_82 : p % 83 = 82
                                                                                                                                                                                                                                                                                                                                                                                                                        · -- p ≡ 82 (mod 83): (α=21, r=1, s=1), M = 4·21·1·1 - 1 = 83
                                                                                                                                                                                                                                                                                                                                                                                                                          -- offset = (p+84)/83, b = 21, c = 21·(p + 1)/83
                                                                                                                                                                                                                                                                                                                                                                                                                          have hdiv83a : 83 ∣ (p + 84) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                          have hdiv83b : 83 ∣ (p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                          refine ⟨(p + 84) / 83, 21, 21 * ((p + 1) / 83), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                          · have : p % 1992 = 1825 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                            have h83div : (p + 84) / 83 * 83 = p + 84 := Nat.div_mul_cancel hdiv83a
                                                                                                                                                                                                                                                                                                                                                                                                                            omega
                                                                                                                                                                                                                                                                                                                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                          · set δ := (p + 84) / 83 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                            set c₀ := (p + 1) / 83 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                            have hδ_mul : δ * 83 = p + 84 := Nat.div_mul_cancel hdiv83a
                                                                                                                                                                                                                                                                                                                                                                                                                            have hc₀_mul : c₀ * 83 = p + 1 := Nat.div_mul_cancel hdiv83b
                                                                                                                                                                                                                                                                                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 83 = ↑p + 84 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 83 = ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                            push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                        · -- M = 127 subcases via Lemma D.6
                                                                                                                                                                                                                                                                                                                                                                                                                          by_cases hp127_63 : p % 127 = 63
                                                                                                                                                                                                                                                                                                                                                                                                                          · -- p ≡ 63 (mod 127): (α=1, r=8, s=4), M = 4·1·4·8 - 1 = 127
                                                                                                                                                                                                                                                                                                                                                                                                                            -- offset = (p+64)/127, b = 32, c = 8·(8 * p + 4)/127
                                                                                                                                                                                                                                                                                                                                                                                                                            have hdiv127a : 127 ∣ (p + 64) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                            have hdiv127b : 127 ∣ (8 * p + 4) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                            refine ⟨(p + 64) / 127, 32, 8 * ((8 * p + 4) / 127), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                            · have : p % 3048 = 2857 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                              have h127div : (p + 64) / 127 * 127 = p + 64 := Nat.div_mul_cancel hdiv127a
                                                                                                                                                                                                                                                                                                                                                                                                                              omega
                                                                                                                                                                                                                                                                                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                            · set δ := (p + 64) / 127 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                              set c₀ := (8 * p + 4) / 127 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                              have hδ_mul : δ * 127 = p + 64 := Nat.div_mul_cancel hdiv127a
                                                                                                                                                                                                                                                                                                                                                                                                                              have hc₀_mul : c₀ * 127 = 8 * p + 4 := Nat.div_mul_cancel hdiv127b
                                                                                                                                                                                                                                                                                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 127 = ↑p + 64 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 127 = 8 * ↑p + 4 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                              push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                          · by_cases hp127_95 : p % 127 = 95
                                                                                                                                                                                                                                                                                                                                                                                                                            · -- p ≡ 95 (mod 127): (α=2, r=8, s=2), M = 4·2·2·8 - 1 = 127
                                                                                                                                                                                                                                                                                                                                                                                                                              -- offset = (p+32)/127, b = 32, c = 16·(8 * p + 2)/127
                                                                                                                                                                                                                                                                                                                                                                                                                              have hdiv127a : 127 ∣ (p + 32) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                              have hdiv127b : 127 ∣ (8 * p + 2) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                              refine ⟨(p + 32) / 127, 32, 16 * ((8 * p + 2) / 127), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                              · have : p % 3048 = 1873 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                have h127div : (p + 32) / 127 * 127 = p + 32 := Nat.div_mul_cancel hdiv127a
                                                                                                                                                                                                                                                                                                                                                                                                                                omega
                                                                                                                                                                                                                                                                                                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                              · set δ := (p + 32) / 127 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                set c₀ := (8 * p + 2) / 127 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                have hδ_mul : δ * 127 = p + 32 := Nat.div_mul_cancel hdiv127a
                                                                                                                                                                                                                                                                                                                                                                                                                                have hc₀_mul : c₀ * 127 = 8 * p + 2 := Nat.div_mul_cancel hdiv127b
                                                                                                                                                                                                                                                                                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 127 = ↑p + 32 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 127 = 8 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                            · by_cases hp127_111 : p % 127 = 111
                                                                                                                                                                                                                                                                                                                                                                                                                              · -- p ≡ 111 (mod 127): (α=1, r=16, s=2), M = 4·1·2·16 - 1 = 127
                                                                                                                                                                                                                                                                                                                                                                                                                                -- offset = (p+16)/127, b = 32, c = 16·(16 * p + 2)/127
                                                                                                                                                                                                                                                                                                                                                                                                                                have hdiv127a : 127 ∣ (p + 16) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                have hdiv127b : 127 ∣ (16 * p + 2) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                refine ⟨(p + 16) / 127, 32, 16 * ((16 * p + 2) / 127), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                · have : p % 3048 = 2905 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                  have h127div : (p + 16) / 127 * 127 = p + 16 := Nat.div_mul_cancel hdiv127a
                                                                                                                                                                                                                                                                                                                                                                                                                                  omega
                                                                                                                                                                                                                                                                                                                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                · set δ := (p + 16) / 127 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                  set c₀ := (16 * p + 2) / 127 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                  have hδ_mul : δ * 127 = p + 16 := Nat.div_mul_cancel hdiv127a
                                                                                                                                                                                                                                                                                                                                                                                                                                  have hc₀_mul : c₀ * 127 = 16 * p + 2 := Nat.div_mul_cancel hdiv127b
                                                                                                                                                                                                                                                                                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 127 = ↑p + 16 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 127 = 16 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                  push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                              · by_cases hp127_119 : p % 127 = 119
                                                                                                                                                                                                                                                                                                                                                                                                                                · -- p ≡ 119 (mod 127): (α=2, r=16, s=1), M = 4·2·1·16 - 1 = 127
                                                                                                                                                                                                                                                                                                                                                                                                                                  -- offset = (p+8)/127, b = 32, c = 32·(16 * p + 1)/127
                                                                                                                                                                                                                                                                                                                                                                                                                                  have hdiv127a : 127 ∣ (p + 8) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                  have hdiv127b : 127 ∣ (16 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                  refine ⟨(p + 8) / 127, 32, 32 * ((16 * p + 1) / 127), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                  · have : p % 3048 = 1897 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                    have h127div : (p + 8) / 127 * 127 = p + 8 := Nat.div_mul_cancel hdiv127a
                                                                                                                                                                                                                                                                                                                                                                                                                                    omega
                                                                                                                                                                                                                                                                                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                  · set δ := (p + 8) / 127 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                    set c₀ := (16 * p + 1) / 127 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                    have hδ_mul : δ * 127 = p + 8 := Nat.div_mul_cancel hdiv127a
                                                                                                                                                                                                                                                                                                                                                                                                                                    have hc₀_mul : c₀ * 127 = 16 * p + 1 := Nat.div_mul_cancel hdiv127b
                                                                                                                                                                                                                                                                                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 127 = ↑p + 8 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 127 = 16 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                    push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                · by_cases hp127_123 : p % 127 = 123
                                                                                                                                                                                                                                                                                                                                                                                                                                  · -- p ≡ 123 (mod 127): (α=1, r=32, s=1), M = 4·1·1·32 - 1 = 127
                                                                                                                                                                                                                                                                                                                                                                                                                                    -- offset = (p+4)/127, b = 32, c = 32·(32 * p + 1)/127
                                                                                                                                                                                                                                                                                                                                                                                                                                    have hdiv127a : 127 ∣ (p + 4) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                    have hdiv127b : 127 ∣ (32 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                    refine ⟨(p + 4) / 127, 32, 32 * ((32 * p + 1) / 127), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                    · have : p % 3048 = 1393 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                      have h127div : (p + 4) / 127 * 127 = p + 4 := Nat.div_mul_cancel hdiv127a
                                                                                                                                                                                                                                                                                                                                                                                                                                      omega
                                                                                                                                                                                                                                                                                                                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                    · set δ := (p + 4) / 127 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                      set c₀ := (32 * p + 1) / 127 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                      have hδ_mul : δ * 127 = p + 4 := Nat.div_mul_cancel hdiv127a
                                                                                                                                                                                                                                                                                                                                                                                                                                      have hc₀_mul : c₀ * 127 = 32 * p + 1 := Nat.div_mul_cancel hdiv127b
                                                                                                                                                                                                                                                                                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 127 = ↑p + 4 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 127 = 32 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                      push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                  · by_cases hp127_125 : p % 127 = 125
                                                                                                                                                                                                                                                                                                                                                                                                                                    · -- p ≡ 125 (mod 127): (α=1, r=4, s=8), M = 4·1·8·4 - 1 = 127
                                                                                                                                                                                                                                                                                                                                                                                                                                      -- offset = (p+256)/127, b = 32, c = 4·(4 * p + 8)/127
                                                                                                                                                                                                                                                                                                                                                                                                                                      have hdiv127a : 127 ∣ (p + 256) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                      have hdiv127b : 127 ∣ (4 * p + 8) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                      refine ⟨(p + 256) / 127, 32, 4 * ((4 * p + 8) / 127), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                      · have : p % 3048 = 2665 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                        have h127div : (p + 256) / 127 * 127 = p + 256 := Nat.div_mul_cancel hdiv127a
                                                                                                                                                                                                                                                                                                                                                                                                                                        omega
                                                                                                                                                                                                                                                                                                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                      · set δ := (p + 256) / 127 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                        set c₀ := (4 * p + 8) / 127 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                        have hδ_mul : δ * 127 = p + 256 := Nat.div_mul_cancel hdiv127a
                                                                                                                                                                                                                                                                                                                                                                                                                                        have hc₀_mul : c₀ * 127 = 4 * p + 8 := Nat.div_mul_cancel hdiv127b
                                                                                                                                                                                                                                                                                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 127 = ↑p + 256 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 127 = 4 * ↑p + 8 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                        push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                    · by_cases hp127_126 : p % 127 = 126
                                                                                                                                                                                                                                                                                                                                                                                                                                      · -- p ≡ 126 (mod 127): (α=2, r=4, s=4), M = 4·2·4·4 - 1 = 127
                                                                                                                                                                                                                                                                                                                                                                                                                                        -- offset = (p+128)/127, b = 32, c = 8·(4 * p + 4)/127
                                                                                                                                                                                                                                                                                                                                                                                                                                        have hdiv127a : 127 ∣ (p + 128) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                        have hdiv127b : 127 ∣ (4 * p + 4) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                        refine ⟨(p + 128) / 127, 32, 8 * ((4 * p + 4) / 127), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                        · have : p % 3048 = 1777 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                          have h127div : (p + 128) / 127 * 127 = p + 128 := Nat.div_mul_cancel hdiv127a
                                                                                                                                                                                                                                                                                                                                                                                                                                          omega
                                                                                                                                                                                                                                                                                                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                        · set δ := (p + 128) / 127 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                          set c₀ := (4 * p + 4) / 127 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                          have hδ_mul : δ * 127 = p + 128 := Nat.div_mul_cancel hdiv127a
                                                                                                                                                                                                                                                                                                                                                                                                                                          have hc₀_mul : c₀ * 127 = 4 * p + 4 := Nat.div_mul_cancel hdiv127b
                                                                                                                                                                                                                                                                                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 127 = ↑p + 128 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 127 = 4 * ↑p + 4 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                          push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                      · -- M = 43 subcases via Lemma D.6
                                                                                                                                                                                                                                                                                                                                                                                                                                        by_cases hp43_32 : p % 43 = 32
                                                                                                                                                                                                                                                                                                                                                                                                                                        · -- p ≡ 32 (mod 43): (α=1, r=1, s=11), M = 4·1·11·1 - 1 = 43
                                                                                                                                                                                                                                                                                                                                                                                                                                          -- offset = (p+484)/43, b = 11, c = (p + 11)/43
                                                                                                                                                                                                                                                                                                                                                                                                                                          have hdiv43a : 43 ∣ (p + 484) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                          have hdiv43b : 43 ∣ (p + 11) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                          refine ⟨(p + 484) / 43, 11, (p + 11) / 43, ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                          · have : p % 1032 = 505 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                            have h43div : (p + 484) / 43 * 43 = p + 484 := Nat.div_mul_cancel hdiv43a
                                                                                                                                                                                                                                                                                                                                                                                                                                            omega
                                                                                                                                                                                                                                                                                                                                                                                                                                          · exact Nat.div_pos (by omega) (by norm_num)
                                                                                                                                                                                                                                                                                                                                                                                                                                          · set δ := (p + 484) / 43 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                            set c₀ := (p + 11) / 43 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                            have hδ_mul : δ * 43 = p + 484 := Nat.div_mul_cancel hdiv43a
                                                                                                                                                                                                                                                                                                                                                                                                                                            have hc₀_mul : c₀ * 43 = p + 11 := Nat.div_mul_cancel hdiv43b
                                                                                                                                                                                                                                                                                                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 43 = ↑p + 484 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 43 = ↑p + 11 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                            push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                        · by_cases hp43_39 : p % 43 = 39
                                                                                                                                                                                                                                                                                                                                                                                                                                          · -- p ≡ 39 (mod 43): (α=1, r=11, s=1), M = 4·1·1·11 - 1 = 43
                                                                                                                                                                                                                                                                                                                                                                                                                                            -- offset = (p+4)/43, b = 11, c = 11·(11 * p + 1)/43
                                                                                                                                                                                                                                                                                                                                                                                                                                            have hdiv43a : 43 ∣ (p + 4) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                            have hdiv43b : 43 ∣ (11 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                            refine ⟨(p + 4) / 43, 11, 11 * ((11 * p + 1) / 43), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                            · have : p % 1032 = 985 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                              have h43div : (p + 4) / 43 * 43 = p + 4 := Nat.div_mul_cancel hdiv43a
                                                                                                                                                                                                                                                                                                                                                                                                                                              omega
                                                                                                                                                                                                                                                                                                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                            · set δ := (p + 4) / 43 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                              set c₀ := (11 * p + 1) / 43 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                              have hδ_mul : δ * 43 = p + 4 := Nat.div_mul_cancel hdiv43a
                                                                                                                                                                                                                                                                                                                                                                                                                                              have hc₀_mul : c₀ * 43 = 11 * p + 1 := Nat.div_mul_cancel hdiv43b
                                                                                                                                                                                                                                                                                                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 43 = ↑p + 4 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 43 = 11 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                              push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                          · by_cases hp43_42 : p % 43 = 42
                                                                                                                                                                                                                                                                                                                                                                                                                                            · -- p ≡ 42 (mod 43): (α=11, r=1, s=1), M = 4·11·1·1 - 1 = 43
                                                                                                                                                                                                                                                                                                                                                                                                                                              -- offset = (p+44)/43, b = 11, c = 11·(p + 1)/43
                                                                                                                                                                                                                                                                                                                                                                                                                                              have hdiv43a : 43 ∣ (p + 44) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                              have hdiv43b : 43 ∣ (p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                              refine ⟨(p + 44) / 43, 11, 11 * ((p + 1) / 43), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                              · have : p % 1032 = 601 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                have h43div : (p + 44) / 43 * 43 = p + 44 := Nat.div_mul_cancel hdiv43a
                                                                                                                                                                                                                                                                                                                                                                                                                                                omega
                                                                                                                                                                                                                                                                                                                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                              · set δ := (p + 44) / 43 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                set c₀ := (p + 1) / 43 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                have hδ_mul : δ * 43 = p + 44 := Nat.div_mul_cancel hdiv43a
                                                                                                                                                                                                                                                                                                                                                                                                                                                have hc₀_mul : c₀ * 43 = p + 1 := Nat.div_mul_cancel hdiv43b
                                                                                                                                                                                                                                                                                                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 43 = ↑p + 44 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 43 = ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                            · -- M = 99 subcases via Lemma D.6
                                                                                                                                                                                                                                                                                                                                                                                                                                              by_cases hp99_79 : p % 99 = 79
                                                                                                                                                                                                                                                                                                                                                                                                                                              · -- p ≡ 79 (mod 99): (α=5, r=5, s=1), M = 4·5·1·5 - 1 = 99
                                                                                                                                                                                                                                                                                                                                                                                                                                                -- offset = (p+20)/99, b = 25, c = 25·(5 * p + 1)/99
                                                                                                                                                                                                                                                                                                                                                                                                                                                have hdiv99a : 99 ∣ (p + 20) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                have hdiv99b : 99 ∣ (5 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                refine ⟨(p + 20) / 99, 25, 25 * ((5 * p + 1) / 99), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                · have : p % 792 = 673 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                  have h99div : (p + 20) / 99 * 99 = p + 20 := Nat.div_mul_cancel hdiv99a
                                                                                                                                                                                                                                                                                                                                                                                                                                                  omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                · set δ := (p + 20) / 99 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                  set c₀ := (5 * p + 1) / 99 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hδ_mul : δ * 99 = p + 20 := Nat.div_mul_cancel hdiv99a
                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hc₀_mul : c₀ * 99 = 5 * p + 1 := Nat.div_mul_cancel hdiv99b
                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 99 = ↑p + 20 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 99 = 5 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                  push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                              · by_cases hp99_94 : p % 99 = 94
                                                                                                                                                                                                                                                                                                                                                                                                                                                · -- p ≡ 94 (mod 99): (α=5, r=1, s=5), M = 4·5·5·1 - 1 = 99
                                                                                                                                                                                                                                                                                                                                                                                                                                                  -- offset = (p+500)/99, b = 25, c = 5·(p + 5)/99
                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hdiv99a : 99 ∣ (p + 500) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hdiv99b : 99 ∣ (p + 5) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                  refine ⟨(p + 500) / 99, 25, 5 * ((p + 5) / 99), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                  · have : p % 792 = 193 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                    have h99div : (p + 500) / 99 * 99 = p + 500 := Nat.div_mul_cancel hdiv99a
                                                                                                                                                                                                                                                                                                                                                                                                                                                    omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                  · set δ := (p + 500) / 99 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                    set c₀ := (p + 5) / 99 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hδ_mul : δ * 99 = p + 500 := Nat.div_mul_cancel hdiv99a
                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hc₀_mul : c₀ * 99 = p + 5 := Nat.div_mul_cancel hdiv99b
                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 99 = ↑p + 500 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 99 = ↑p + 5 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                    push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                · -- M = 107 subcases via Lemma D.6
                                                                                                                                                                                                                                                                                                                                                                                                                                                  by_cases hp107_71 : p % 107 = 71
                                                                                                                                                                                                                                                                                                                                                                                                                                                  · -- p ≡ 71 (mod 107): (α=1, r=9, s=3), M = 4·1·3·9 - 1 = 107
                                                                                                                                                                                                                                                                                                                                                                                                                                                    -- offset = (p+36)/107, b = 27, c = 9·(9 * p + 3)/107
                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hdiv107a : 107 ∣ (p + 36) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hdiv107b : 107 ∣ (9 * p + 3) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                    refine ⟨(p + 36) / 107, 27, 9 * ((9 * p + 3) / 107), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                    · have : p % 2568 = 2425 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                      have h107div : (p + 36) / 107 * 107 = p + 36 := Nat.div_mul_cancel hdiv107a
                                                                                                                                                                                                                                                                                                                                                                                                                                                      omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                    · set δ := (p + 36) / 107 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                      set c₀ := (9 * p + 3) / 107 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hδ_mul : δ * 107 = p + 36 := Nat.div_mul_cancel hdiv107a
                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hc₀_mul : c₀ * 107 = 9 * p + 3 := Nat.div_mul_cancel hdiv107b
                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 107 = ↑p + 36 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 107 = 9 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                      push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                  · by_cases hp107_80 : p % 107 = 80
                                                                                                                                                                                                                                                                                                                                                                                                                                                    · -- p ≡ 80 (mod 107): (α=1, r=1, s=27), M = 4·1·27·1 - 1 = 107
                                                                                                                                                                                                                                                                                                                                                                                                                                                      -- offset = (p+2916)/107, b = 27, c = (p + 27)/107
                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hdiv107a : 107 ∣ (p + 2916) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hdiv107b : 107 ∣ (p + 27) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                      refine ⟨(p + 2916) / 107, 27, (p + 27) / 107, ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                      · have : p % 2568 = 2113 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                        have h107div : (p + 2916) / 107 * 107 = p + 2916 := Nat.div_mul_cancel hdiv107a
                                                                                                                                                                                                                                                                                                                                                                                                                                                        omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                      · exact Nat.div_pos (by omega) (by norm_num)
                                                                                                                                                                                                                                                                                                                                                                                                                                                      · set δ := (p + 2916) / 107 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                        set c₀ := (p + 27) / 107 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hδ_mul : δ * 107 = p + 2916 := Nat.div_mul_cancel hdiv107a
                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hc₀_mul : c₀ * 107 = p + 27 := Nat.div_mul_cancel hdiv107b
                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 107 = ↑p + 2916 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 107 = ↑p + 27 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                        push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                    · by_cases hp107_95 : p % 107 = 95
                                                                                                                                                                                                                                                                                                                                                                                                                                                      · -- p ≡ 95 (mod 107): (α=3, r=9, s=1), M = 4·3·1·9 - 1 = 107
                                                                                                                                                                                                                                                                                                                                                                                                                                                        -- offset = (p+12)/107, b = 27, c = 27·(9 * p + 1)/107
                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hdiv107a : 107 ∣ (p + 12) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hdiv107b : 107 ∣ (9 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                        refine ⟨(p + 12) / 107, 27, 27 * ((9 * p + 1) / 107), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                        · have : p % 2568 = 2449 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                          have h107div : (p + 12) / 107 * 107 = p + 12 := Nat.div_mul_cancel hdiv107a
                                                                                                                                                                                                                                                                                                                                                                                                                                                          omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                        · set δ := (p + 12) / 107 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                          set c₀ := (9 * p + 1) / 107 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hδ_mul : δ * 107 = p + 12 := Nat.div_mul_cancel hdiv107a
                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hc₀_mul : c₀ * 107 = 9 * p + 1 := Nat.div_mul_cancel hdiv107b
                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 107 = ↑p + 12 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 107 = 9 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                          push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                      · by_cases hp107_98 : p % 107 = 98
                                                                                                                                                                                                                                                                                                                                                                                                                                                        · -- p ≡ 98 (mod 107): (α=3, r=1, s=9), M = 4·3·9·1 - 1 = 107
                                                                                                                                                                                                                                                                                                                                                                                                                                                          -- offset = (p+972)/107, b = 27, c = 3·(p + 9)/107
                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hdiv107a : 107 ∣ (p + 972) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hdiv107b : 107 ∣ (p + 9) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                          refine ⟨(p + 972) / 107, 27, 3 * ((p + 9) / 107), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                          · have : p % 2568 = 1489 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                            have h107div : (p + 972) / 107 * 107 = p + 972 := Nat.div_mul_cancel hdiv107a
                                                                                                                                                                                                                                                                                                                                                                                                                                                            omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                          · set δ := (p + 972) / 107 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                            set c₀ := (p + 9) / 107 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hδ_mul : δ * 107 = p + 972 := Nat.div_mul_cancel hdiv107a
                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hc₀_mul : c₀ * 107 = p + 9 := Nat.div_mul_cancel hdiv107b
                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 107 = ↑p + 972 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 107 = ↑p + 9 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                            push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                        · by_cases hp107_103 : p % 107 = 103
                                                                                                                                                                                                                                                                                                                                                                                                                                                          · -- p ≡ 103 (mod 107): (α=1, r=27, s=1), M = 4·1·1·27 - 1 = 107
                                                                                                                                                                                                                                                                                                                                                                                                                                                            -- offset = (p+4)/107, b = 27, c = 27·(27 * p + 1)/107
                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hdiv107a : 107 ∣ (p + 4) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hdiv107b : 107 ∣ (27 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                            refine ⟨(p + 4) / 107, 27, 27 * ((27 * p + 1) / 107), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                            · have : p % 2568 = 745 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                              have h107div : (p + 4) / 107 * 107 = p + 4 := Nat.div_mul_cancel hdiv107a
                                                                                                                                                                                                                                                                                                                                                                                                                                                              omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                            · set δ := (p + 4) / 107 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                              set c₀ := (27 * p + 1) / 107 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hδ_mul : δ * 107 = p + 4 := Nat.div_mul_cancel hdiv107a
                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hc₀_mul : c₀ * 107 = 27 * p + 1 := Nat.div_mul_cancel hdiv107b
                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 107 = ↑p + 4 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 107 = 27 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                              push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                          · by_cases hp107_104 : p % 107 = 104
                                                                                                                                                                                                                                                                                                                                                                                                                                                            · -- p ≡ 104 (mod 107): (α=1, r=3, s=9), M = 4·1·9·3 - 1 = 107
                                                                                                                                                                                                                                                                                                                                                                                                                                                              -- offset = (p+324)/107, b = 27, c = 3·(3 * p + 9)/107
                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hdiv107a : 107 ∣ (p + 324) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hdiv107b : 107 ∣ (3 * p + 9) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                              refine ⟨(p + 324) / 107, 27, 3 * ((3 * p + 9) / 107), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                              · have : p % 2568 = 2137 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                have h107div : (p + 324) / 107 * 107 = p + 324 := Nat.div_mul_cancel hdiv107a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                              · set δ := (p + 324) / 107 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                set c₀ := (3 * p + 9) / 107 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hδ_mul : δ * 107 = p + 324 := Nat.div_mul_cancel hdiv107a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hc₀_mul : c₀ * 107 = 3 * p + 9 := Nat.div_mul_cancel hdiv107b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 107 = ↑p + 324 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 107 = 3 * ↑p + 9 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                            · by_cases hp107_106 : p % 107 = 106
                                                                                                                                                                                                                                                                                                                                                                                                                                                              · -- p ≡ 106 (mod 107): (α=3, r=3, s=3), M = 4·3·3·3 - 1 = 107
                                                                                                                                                                                                                                                                                                                                                                                                                                                                -- offset = (p+108)/107, b = 27, c = 9·(3 * p + 3)/107
                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hdiv107a : 107 ∣ (p + 108) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hdiv107b : 107 ∣ (3 * p + 3) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                refine ⟨(p + 108) / 107, 27, 9 * ((3 * p + 3) / 107), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                · have : p % 2568 = 2353 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have h107div : (p + 108) / 107 * 107 = p + 108 := Nat.div_mul_cancel hdiv107a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                · set δ := (p + 108) / 107 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  set c₀ := (3 * p + 3) / 107 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hδ_mul : δ * 107 = p + 108 := Nat.div_mul_cancel hdiv107a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hc₀_mul : c₀ * 107 = 3 * p + 3 := Nat.div_mul_cancel hdiv107b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 107 = ↑p + 108 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 107 = 3 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                              · -- M = 131 subcases via Lemma D.6
                                                                                                                                                                                                                                                                                                                                                                                                                                                                by_cases hp131_40 : p % 131 = 40
                                                                                                                                                                                                                                                                                                                                                                                                                                                                · -- p ≡ 40 (mod 131): (α=1, r=3, s=11), M = 4·1·11·3 - 1 = 131
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  -- offset = (p+484)/131, b = 33, c = 3·(3 * p + 11)/131
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hdiv131a : 131 ∣ (p + 484) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hdiv131b : 131 ∣ (3 * p + 11) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  refine ⟨(p + 484) / 131, 33, 3 * ((3 * p + 11) / 131), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · have : p % 3144 = 433 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have h131div : (p + 484) / 131 * 131 = p + 484 := Nat.div_mul_cancel hdiv131a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · set δ := (p + 484) / 131 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    set c₀ := (3 * p + 11) / 131 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hδ_mul : δ * 131 = p + 484 := Nat.div_mul_cancel hdiv131a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hc₀_mul : c₀ * 131 = 3 * p + 11 := Nat.div_mul_cancel hdiv131b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 131 = ↑p + 484 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 131 = 3 * ↑p + 11 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                · by_cases hp131_87 : p % 131 = 87
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · -- p ≡ 87 (mod 131): (α=11, r=3, s=1), M = 4·11·1·3 - 1 = 131
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    -- offset = (p+44)/131, b = 33, c = 33·(3 * p + 1)/131
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hdiv131a : 131 ∣ (p + 44) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hdiv131b : 131 ∣ (3 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    refine ⟨(p + 44) / 131, 33, 33 * ((3 * p + 1) / 131), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · have : p % 3144 = 1921 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have h131div : (p + 44) / 131 * 131 = p + 44 := Nat.div_mul_cancel hdiv131a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · set δ := (p + 44) / 131 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      set c₀ := (3 * p + 1) / 131 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hδ_mul : δ * 131 = p + 44 := Nat.div_mul_cancel hdiv131a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hc₀_mul : c₀ * 131 = 3 * p + 1 := Nat.div_mul_cancel hdiv131b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 131 = ↑p + 44 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 131 = 3 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · by_cases hp131_95 : p % 131 = 95
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · -- p ≡ 95 (mod 131): (α=1, r=11, s=3), M = 4·1·3·11 - 1 = 131
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      -- offset = (p+36)/131, b = 33, c = 11·(11 * p + 3)/131
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hdiv131a : 131 ∣ (p + 36) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hdiv131b : 131 ∣ (11 * p + 3) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      refine ⟨(p + 36) / 131, 33, 11 * ((11 * p + 3) / 131), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · have : p % 3144 = 2977 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have h131div : (p + 36) / 131 * 131 = p + 36 := Nat.div_mul_cancel hdiv131a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · set δ := (p + 36) / 131 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        set c₀ := (11 * p + 3) / 131 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hδ_mul : δ * 131 = p + 36 := Nat.div_mul_cancel hdiv131a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hc₀_mul : c₀ * 131 = 11 * p + 3 := Nat.div_mul_cancel hdiv131b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 131 = ↑p + 36 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 131 = 11 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · by_cases hp131_98 : p % 131 = 98
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · -- p ≡ 98 (mod 131): (α=1, r=1, s=33), M = 4·1·33·1 - 1 = 131
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        -- offset = (p+4356)/131, b = 33, c = (p + 33)/131
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hdiv131a : 131 ∣ (p + 4356) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hdiv131b : 131 ∣ (p + 33) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        refine ⟨(p + 4356) / 131, 33, (p + 33) / 131, ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · have : p % 3144 = 1801 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have h131div : (p + 4356) / 131 * 131 = p + 4356 := Nat.div_mul_cancel hdiv131a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · exact Nat.div_pos (by omega) (by norm_num)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · set δ := (p + 4356) / 131 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          set c₀ := (p + 33) / 131 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hδ_mul : δ * 131 = p + 4356 := Nat.div_mul_cancel hdiv131a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hc₀_mul : c₀ * 131 = p + 33 := Nat.div_mul_cancel hdiv131b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 131 = ↑p + 4356 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 131 = ↑p + 33 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · by_cases hp131_119 : p % 131 = 119
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · -- p ≡ 119 (mod 131): (α=3, r=11, s=1), M = 4·3·1·11 - 1 = 131
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          -- offset = (p+12)/131, b = 33, c = 33·(11 * p + 1)/131
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hdiv131a : 131 ∣ (p + 12) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hdiv131b : 131 ∣ (11 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          refine ⟨(p + 12) / 131, 33, 33 * ((11 * p + 1) / 131), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          · have : p % 3144 = 3001 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have h131div : (p + 12) / 131 * 131 = p + 12 := Nat.div_mul_cancel hdiv131a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          · set δ := (p + 12) / 131 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            set c₀ := (11 * p + 1) / 131 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hδ_mul : δ * 131 = p + 12 := Nat.div_mul_cancel hdiv131a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hc₀_mul : c₀ * 131 = 11 * p + 1 := Nat.div_mul_cancel hdiv131b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 131 = ↑p + 12 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 131 = 11 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · by_cases hp131_120 : p % 131 = 120
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          · -- p ≡ 120 (mod 131): (α=3, r=1, s=11), M = 4·3·11·1 - 1 = 131
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            -- offset = (p+1452)/131, b = 33, c = 3·(p + 11)/131
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hdiv131a : 131 ∣ (p + 1452) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hdiv131b : 131 ∣ (p + 11) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            refine ⟨(p + 1452) / 131, 33, 3 * ((p + 11) / 131), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            · have : p % 3144 = 1561 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have h131div : (p + 1452) / 131 * 131 = p + 1452 := Nat.div_mul_cancel hdiv131a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            · set δ := (p + 1452) / 131 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              set c₀ := (p + 11) / 131 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hδ_mul : δ * 131 = p + 1452 := Nat.div_mul_cancel hdiv131a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hc₀_mul : c₀ * 131 = p + 11 := Nat.div_mul_cancel hdiv131b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 131 = ↑p + 1452 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 131 = ↑p + 11 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          · by_cases hp131_127 : p % 131 = 127
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            · -- p ≡ 127 (mod 131): (α=1, r=33, s=1), M = 4·1·1·33 - 1 = 131
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              -- offset = (p+4)/131, b = 33, c = 33·(33 * p + 1)/131
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hdiv131a : 131 ∣ (p + 4) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hdiv131b : 131 ∣ (33 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              refine ⟨(p + 4) / 131, 33, 33 * ((33 * p + 1) / 131), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              · have : p % 3144 = 913 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have h131div : (p + 4) / 131 * 131 = p + 4 := Nat.div_mul_cancel hdiv131a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              · set δ := (p + 4) / 131 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                set c₀ := (33 * p + 1) / 131 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hδ_mul : δ * 131 = p + 4 := Nat.div_mul_cancel hdiv131a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hc₀_mul : c₀ * 131 = 33 * p + 1 := Nat.div_mul_cancel hdiv131b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 131 = ↑p + 4 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 131 = 33 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            · by_cases hp131_128 : p % 131 = 128
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              · -- p ≡ 128 (mod 131): (α=11, r=1, s=3), M = 4·11·3·1 - 1 = 131
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                -- offset = (p+396)/131, b = 33, c = 11·(p + 3)/131
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hdiv131a : 131 ∣ (p + 396) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hdiv131b : 131 ∣ (p + 3) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                refine ⟨(p + 396) / 131, 33, 11 * ((p + 3) / 131), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                · have : p % 3144 = 2617 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have h131div : (p + 396) / 131 * 131 = p + 396 := Nat.div_mul_cancel hdiv131a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                · set δ := (p + 396) / 131 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  set c₀ := (p + 3) / 131 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hδ_mul : δ * 131 = p + 396 := Nat.div_mul_cancel hdiv131a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hc₀_mul : c₀ * 131 = p + 3 := Nat.div_mul_cancel hdiv131b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 131 = ↑p + 396 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 131 = ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              · by_cases hp131_130 : p % 131 = 130
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                · -- p ≡ 130 (mod 131): (α=33, r=1, s=1), M = 4·33·1·1 - 1 = 131
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  -- offset = (p+132)/131, b = 33, c = 33·(p + 1)/131
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hdiv131a : 131 ∣ (p + 132) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hdiv131b : 131 ∣ (p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  refine ⟨(p + 132) / 131, 33, 33 * ((p + 1) / 131), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · have : p % 3144 = 2881 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have h131div : (p + 132) / 131 * 131 = p + 132 := Nat.div_mul_cancel hdiv131a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · set δ := (p + 132) / 131 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    set c₀ := (p + 1) / 131 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hδ_mul : δ * 131 = p + 132 := Nat.div_mul_cancel hdiv131a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hc₀_mul : c₀ * 131 = p + 1 := Nat.div_mul_cancel hdiv131b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 131 = ↑p + 132 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 131 = ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                · -- M = 167 subcases via Lemma D.6
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  by_cases hp167_23 : p % 167 = 23
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · -- p ≡ 23 (mod 167): (α=1, r=7, s=6), M = 4·1·6·7 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    -- offset = (p+144)/167, b = 42, c = 7·(7 * p + 6)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hdiv167a : 167 ∣ (p + 144) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hdiv167b : 167 ∣ (7 * p + 6) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    refine ⟨(p + 144) / 167, 42, 7 * ((7 * p + 6) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · have : p % 4008 = 3697 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have h167div : (p + 144) / 167 * 167 = p + 144 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · set δ := (p + 144) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      set c₀ := (7 * p + 6) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hδ_mul : δ * 167 = p + 144 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hc₀_mul : c₀ * 167 = 7 * p + 6 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 167 = ↑p + 144 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 167 = 7 * ↑p + 6 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · by_cases hp167_51 : p % 167 = 51
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · -- p ≡ 51 (mod 167): (α=1, r=3, s=14), M = 4·1·14·3 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      -- offset = (p+784)/167, b = 42, c = 3·(3 * p + 14)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hdiv167a : 167 ∣ (p + 784) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hdiv167b : 167 ∣ (3 * p + 14) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      refine ⟨(p + 784) / 167, 42, 3 * ((3 * p + 14) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · have : p % 4008 = 385 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have h167div : (p + 784) / 167 * 167 = p + 784 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · set δ := (p + 784) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        set c₀ := (3 * p + 14) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hδ_mul : δ * 167 = p + 784 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hc₀_mul : c₀ * 167 = 3 * p + 14 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 167 = ↑p + 784 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 167 = 3 * ↑p + 14 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · by_cases hp167_55 : p % 167 = 55
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · -- p ≡ 55 (mod 167): (α=7, r=3, s=2), M = 4·7·2·3 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        -- offset = (p+112)/167, b = 42, c = 21·(3 * p + 2)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hdiv167a : 167 ∣ (p + 112) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hdiv167b : 167 ∣ (3 * p + 2) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        refine ⟨(p + 112) / 167, 42, 21 * ((3 * p + 2) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · have : p % 4008 = 1057 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have h167div : (p + 112) / 167 * 167 = p + 112 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · set δ := (p + 112) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          set c₀ := (3 * p + 2) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hδ_mul : δ * 167 = p + 112 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hc₀_mul : c₀ * 167 = 3 * p + 2 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 167 = ↑p + 112 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 167 = 3 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · by_cases hp167_73 : p % 167 = 73
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · -- p ≡ 73 (mod 167): (α=1, r=2, s=21), M = 4·1·21·2 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          -- offset = (p+1764)/167, b = 42, c = 2·(2 * p + 21)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hdiv167a : 167 ∣ (p + 1764) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hdiv167b : 167 ∣ (2 * p + 21) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          refine ⟨(p + 1764) / 167, 42, 2 * ((2 * p + 21) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          · have : p % 4008 = 73 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have h167div : (p + 1764) / 167 * 167 = p + 1764 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          · set δ := (p + 1764) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            set c₀ := (2 * p + 21) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hδ_mul : δ * 167 = p + 1764 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hc₀_mul : c₀ * 167 = 2 * p + 21 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 167 = ↑p + 1764 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 167 = 2 * ↑p + 21 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · by_cases hp167_80 : p % 167 = 80
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          · -- p ≡ 80 (mod 167): (α=3, r=2, s=7), M = 4·3·7·2 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            -- offset = (p+588)/167, b = 42, c = 6·(2 * p + 7)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hdiv167a : 167 ∣ (p + 588) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hdiv167b : 167 ∣ (2 * p + 7) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            refine ⟨(p + 588) / 167, 42, 6 * ((2 * p + 7) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            · have : p % 4008 = 1249 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have h167div : (p + 588) / 167 * 167 = p + 588 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            · set δ := (p + 588) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              set c₀ := (2 * p + 7) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hδ_mul : δ * 167 = p + 588 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hc₀_mul : c₀ * 167 = 2 * p + 7 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 167 = ↑p + 588 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 167 = 2 * ↑p + 7 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          · by_cases hp167_82 : p % 167 = 82
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            · -- p ≡ 82 (mod 167): (α=7, r=2, s=3), M = 4·7·3·2 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              -- offset = (p+252)/167, b = 42, c = 14·(2 * p + 3)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hdiv167a : 167 ∣ (p + 252) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hdiv167b : 167 ∣ (2 * p + 3) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              refine ⟨(p + 252) / 167, 42, 14 * ((2 * p + 3) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              · have : p % 4008 = 1585 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have h167div : (p + 252) / 167 * 167 = p + 252 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              · set δ := (p + 252) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                set c₀ := (2 * p + 3) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hδ_mul : δ * 167 = p + 252 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hc₀_mul : c₀ * 167 = 2 * p + 3 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 167 = ↑p + 252 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 167 = 2 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            · by_cases hp167_83 : p % 167 = 83
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              · -- p ≡ 83 (mod 167): (α=21, r=2, s=1), M = 4·21·1·2 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                -- offset = (p+84)/167, b = 42, c = 42·(2 * p + 1)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hdiv167a : 167 ∣ (p + 84) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hdiv167b : 167 ∣ (2 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                refine ⟨(p + 84) / 167, 42, 42 * ((2 * p + 1) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                · have : p % 4008 = 1753 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have h167div : (p + 84) / 167 * 167 = p + 84 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                · set δ := (p + 84) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  set c₀ := (2 * p + 1) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hδ_mul : δ * 167 = p + 84 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hc₀_mul : c₀ * 167 = 2 * p + 1 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 167 = ↑p + 84 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 167 = 2 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              · by_cases hp167_95 : p % 167 = 95
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                · -- p ≡ 95 (mod 167): (α=2, r=7, s=3), M = 4·2·3·7 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  -- offset = (p+72)/167, b = 42, c = 14·(7 * p + 3)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hdiv167a : 167 ∣ (p + 72) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hdiv167b : 167 ∣ (7 * p + 3) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  refine ⟨(p + 72) / 167, 42, 14 * ((7 * p + 3) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · have : p % 4008 = 3769 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have h167div : (p + 72) / 167 * 167 = p + 72 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · set δ := (p + 72) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    set c₀ := (7 * p + 3) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hδ_mul : δ * 167 = p + 72 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hc₀_mul : c₀ * 167 = 7 * p + 3 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 167 = ↑p + 72 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 167 = 7 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                · by_cases hp167_109 : p % 167 = 109
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · -- p ≡ 109 (mod 167): (α=2, r=3, s=7), M = 4·2·7·3 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    -- offset = (p+392)/167, b = 42, c = 6·(3 * p + 7)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hdiv167a : 167 ∣ (p + 392) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hdiv167b : 167 ∣ (3 * p + 7) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    refine ⟨(p + 392) / 167, 42, 6 * ((3 * p + 7) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · have : p % 4008 = 2113 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have h167div : (p + 392) / 167 * 167 = p + 392 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · set δ := (p + 392) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      set c₀ := (3 * p + 7) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hδ_mul : δ * 167 = p + 392 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hc₀_mul : c₀ * 167 = 3 * p + 7 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 167 = ↑p + 392 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 167 = 3 * ↑p + 7 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · by_cases hp167_111 : p % 167 = 111
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · -- p ≡ 111 (mod 167): (α=14, r=3, s=1), M = 4·14·1·3 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      -- offset = (p+56)/167, b = 42, c = 42·(3 * p + 1)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hdiv167a : 167 ∣ (p + 56) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hdiv167b : 167 ∣ (3 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      refine ⟨(p + 56) / 167, 42, 42 * ((3 * p + 1) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · have : p % 4008 = 2449 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have h167div : (p + 56) / 167 * 167 = p + 56 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · set δ := (p + 56) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        set c₀ := (3 * p + 1) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hδ_mul : δ * 167 = p + 56 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hc₀_mul : c₀ * 167 = 3 * p + 1 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 167 = ↑p + 56 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 167 = 3 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · by_cases hp167_119 : p % 167 = 119
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · -- p ≡ 119 (mod 167): (α=3, r=7, s=2), M = 4·3·2·7 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        -- offset = (p+48)/167, b = 42, c = 21·(7 * p + 2)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hdiv167a : 167 ∣ (p + 48) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hdiv167b : 167 ∣ (7 * p + 2) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        refine ⟨(p + 48) / 167, 42, 21 * ((7 * p + 2) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · have : p % 4008 = 3793 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have h167div : (p + 48) / 167 * 167 = p + 48 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · set δ := (p + 48) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          set c₀ := (7 * p + 2) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hδ_mul : δ * 167 = p + 48 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hc₀_mul : c₀ * 167 = 7 * p + 2 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 167 = ↑p + 48 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 167 = 7 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · by_cases hp167_125 : p % 167 = 125
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · -- p ≡ 125 (mod 167): (α=1, r=1, s=42), M = 4·1·42·1 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          -- offset = (p+7056)/167, b = 42, c = (p + 42)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hdiv167a : 167 ∣ (p + 7056) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hdiv167b : 167 ∣ (p + 42) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          refine ⟨(p + 7056) / 167, 42, (p + 42) / 167, ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          · have : p % 4008 = 793 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have h167div : (p + 7056) / 167 * 167 = p + 7056 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          · exact Nat.div_pos (by omega) (by norm_num)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          · set δ := (p + 7056) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            set c₀ := (p + 42) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hδ_mul : δ * 167 = p + 7056 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hc₀_mul : c₀ * 167 = p + 42 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 167 = ↑p + 7056 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 167 = ↑p + 42 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · by_cases hp167_131 : p % 167 = 131
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          · -- p ≡ 131 (mod 167): (α=1, r=14, s=3), M = 4·1·3·14 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            -- offset = (p+36)/167, b = 42, c = 14·(14 * p + 3)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hdiv167a : 167 ∣ (p + 36) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hdiv167b : 167 ∣ (14 * p + 3) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            refine ⟨(p + 36) / 167, 42, 14 * ((14 * p + 3) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            · have : p % 4008 = 1801 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have h167div : (p + 36) / 167 * 167 = p + 36 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            · set δ := (p + 36) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              set c₀ := (14 * p + 3) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hδ_mul : δ * 167 = p + 36 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hc₀_mul : c₀ * 167 = 14 * p + 3 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 167 = ↑p + 36 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 167 = 14 * ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          · by_cases hp167_138 : p % 167 = 138
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            · -- p ≡ 138 (mod 167): (α=1, r=6, s=7), M = 4·1·7·6 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              -- offset = (p+196)/167, b = 42, c = 6·(6 * p + 7)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hdiv167a : 167 ∣ (p + 196) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hdiv167b : 167 ∣ (6 * p + 7) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              refine ⟨(p + 196) / 167, 42, 6 * ((6 * p + 7) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              · have : p % 4008 = 2977 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have h167div : (p + 196) / 167 * 167 = p + 196 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              · set δ := (p + 196) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                set c₀ := (6 * p + 7) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hδ_mul : δ * 167 = p + 196 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hc₀_mul : c₀ * 167 = 6 * p + 7 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 167 = ↑p + 196 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 167 = 6 * ↑p + 7 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            · by_cases hp167_139 : p % 167 = 139
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              · -- p ≡ 139 (mod 167): (α=7, r=6, s=1), M = 4·7·1·6 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                -- offset = (p+28)/167, b = 42, c = 42·(6 * p + 1)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hdiv167a : 167 ∣ (p + 28) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hdiv167b : 167 ∣ (6 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                refine ⟨(p + 28) / 167, 42, 42 * ((6 * p + 1) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                · have : p % 4008 = 3145 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have h167div : (p + 28) / 167 * 167 = p + 28 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                · set δ := (p + 28) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  set c₀ := (6 * p + 1) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hδ_mul : δ * 167 = p + 28 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hc₀_mul : c₀ * 167 = 6 * p + 1 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 167 = ↑p + 28 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 167 = 6 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              · by_cases hp167_143 : p % 167 = 143
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                · -- p ≡ 143 (mod 167): (α=6, r=7, s=1), M = 4·6·1·7 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  -- offset = (p+24)/167, b = 42, c = 42·(7 * p + 1)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hdiv167a : 167 ∣ (p + 24) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hdiv167b : 167 ∣ (7 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  refine ⟨(p + 24) / 167, 42, 42 * ((7 * p + 1) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · have : p % 4008 = 3817 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have h167div : (p + 24) / 167 * 167 = p + 24 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · set δ := (p + 24) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    set c₀ := (7 * p + 1) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hδ_mul : δ * 167 = p + 24 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hc₀_mul : c₀ * 167 = 7 * p + 1 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 167 = ↑p + 24 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 167 = 7 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                · by_cases hp167_146 : p % 167 = 146
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · -- p ≡ 146 (mod 167): (α=2, r=1, s=21), M = 4·2·21·1 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    -- offset = (p+3528)/167, b = 42, c = 2·(p + 21)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hdiv167a : 167 ∣ (p + 3528) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hdiv167b : 167 ∣ (p + 21) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    refine ⟨(p + 3528) / 167, 42, 2 * ((p + 21) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · have : p % 4008 = 313 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have h167div : (p + 3528) / 167 * 167 = p + 3528 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · set δ := (p + 3528) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      set c₀ := (p + 21) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hδ_mul : δ * 167 = p + 3528 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hc₀_mul : c₀ * 167 = p + 21 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 167 = ↑p + 3528 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 167 = ↑p + 21 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · by_cases hp167_151 : p % 167 = 151
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · -- p ≡ 151 (mod 167): (α=1, r=21, s=2), M = 4·1·2·21 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      -- offset = (p+16)/167, b = 42, c = 21·(21 * p + 2)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hdiv167a : 167 ∣ (p + 16) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hdiv167b : 167 ∣ (21 * p + 2) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      refine ⟨(p + 16) / 167, 42, 21 * ((21 * p + 2) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · have : p % 4008 = 1153 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have h167div : (p + 16) / 167 * 167 = p + 16 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · set δ := (p + 16) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        set c₀ := (21 * p + 2) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hδ_mul : δ * 167 = p + 16 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hc₀_mul : c₀ * 167 = 21 * p + 2 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 167 = ↑p + 16 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 167 = 21 * ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · by_cases hp167_153 : p % 167 = 153
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · -- p ≡ 153 (mod 167): (α=3, r=1, s=14), M = 4·3·14·1 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        -- offset = (p+2352)/167, b = 42, c = 3·(p + 14)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hdiv167a : 167 ∣ (p + 2352) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hdiv167b : 167 ∣ (p + 14) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        refine ⟨(p + 2352) / 167, 42, 3 * ((p + 14) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · have : p % 4008 = 1489 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have h167div : (p + 2352) / 167 * 167 = p + 2352 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · set δ := (p + 2352) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          set c₀ := (p + 14) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hδ_mul : δ * 167 = p + 2352 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hc₀_mul : c₀ * 167 = p + 14 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 167 = ↑p + 2352 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 167 = ↑p + 14 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · by_cases hp167_155 : p % 167 = 155
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · -- p ≡ 155 (mod 167): (α=3, r=14, s=1), M = 4·3·1·14 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          -- offset = (p+12)/167, b = 42, c = 42·(14 * p + 1)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hdiv167a : 167 ∣ (p + 12) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hdiv167b : 167 ∣ (14 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          refine ⟨(p + 12) / 167, 42, 42 * ((14 * p + 1) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          · have : p % 4008 = 1825 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have h167div : (p + 12) / 167 * 167 = p + 12 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          · set δ := (p + 12) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            set c₀ := (14 * p + 1) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hδ_mul : δ * 167 = p + 12 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hc₀_mul : c₀ * 167 = 14 * p + 1 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hδ_int : (↑δ : ℤ) * 167 = ↑p + 12 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hc₀_int : (↑c₀ : ℤ) * 167 = 14 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · by_cases hp167_159 : p % 167 = 159
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          · -- p ≡ 159 (mod 167): (α=2, r=21, s=1), M = 4·2·1·21 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            -- offset = (p+8)/167, b = 42, c = 42·(21 * p + 1)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hdiv167a : 167 ∣ (p + 8) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            have hdiv167b : 167 ∣ (21 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            refine ⟨(p + 8) / 167, 42, 42 * ((21 * p + 1) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            · have : p % 4008 = 2497 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have h167div : (p + 8) / 167 * 167 = p + 8 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            · set δ := (p + 8) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              set c₀ := (21 * p + 1) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hδ_mul : δ * 167 = p + 8 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hc₀_mul : c₀ * 167 = 21 * p + 1 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hδ_int : (↑δ : ℤ) * 167 = ↑p + 8 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hc₀_int : (↑c₀ : ℤ) * 167 = 21 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          · by_cases hp167_160 : p % 167 = 160
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            · -- p ≡ 160 (mod 167): (α=6, r=1, s=7), M = 4·6·7·1 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              -- offset = (p+1176)/167, b = 42, c = 6·(p + 7)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hdiv167a : 167 ∣ (p + 1176) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              have hdiv167b : 167 ∣ (p + 7) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              refine ⟨(p + 1176) / 167, 42, 6 * ((p + 7) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              · have : p % 4008 = 2665 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have h167div : (p + 1176) / 167 * 167 = p + 1176 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              · set δ := (p + 1176) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                set c₀ := (p + 7) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hδ_mul : δ * 167 = p + 1176 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hc₀_mul : c₀ * 167 = p + 7 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hδ_int : (↑δ : ℤ) * 167 = ↑p + 1176 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hc₀_int : (↑c₀ : ℤ) * 167 = ↑p + 7 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            · by_cases hp167_161 : p % 167 = 161
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              · -- p ≡ 161 (mod 167): (α=7, r=1, s=6), M = 4·7·6·1 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                -- offset = (p+1008)/167, b = 42, c = 7·(p + 6)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hdiv167a : 167 ∣ (p + 1008) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                have hdiv167b : 167 ∣ (p + 6) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                refine ⟨(p + 1008) / 167, 42, 7 * ((p + 6) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                · have : p % 4008 = 2833 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have h167div : (p + 1008) / 167 * 167 = p + 1008 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                · set δ := (p + 1008) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  set c₀ := (p + 6) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hδ_mul : δ * 167 = p + 1008 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hc₀_mul : c₀ * 167 = p + 6 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hδ_int : (↑δ : ℤ) * 167 = ↑p + 1008 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hc₀_int : (↑c₀ : ℤ) * 167 = ↑p + 6 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              · by_cases hp167_163 : p % 167 = 163
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                · -- p ≡ 163 (mod 167): (α=1, r=42, s=1), M = 4·1·1·42 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  -- offset = (p+4)/167, b = 42, c = 42·(42 * p + 1)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hdiv167a : 167 ∣ (p + 4) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  have hdiv167b : 167 ∣ (42 * p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  refine ⟨(p + 4) / 167, 42, 42 * ((42 * p + 1) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · have : p % 4008 = 3169 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have h167div : (p + 4) / 167 * 167 = p + 4 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · set δ := (p + 4) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    set c₀ := (42 * p + 1) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hδ_mul : δ * 167 = p + 4 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hc₀_mul : c₀ * 167 = 42 * p + 1 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hδ_int : (↑δ : ℤ) * 167 = ↑p + 4 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hc₀_int : (↑c₀ : ℤ) * 167 = 42 * ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                · by_cases hp167_164 : p % 167 = 164
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · -- p ≡ 164 (mod 167): (α=14, r=1, s=3), M = 4·14·3·1 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    -- offset = (p+504)/167, b = 42, c = 14·(p + 3)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hdiv167a : 167 ∣ (p + 504) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    have hdiv167b : 167 ∣ (p + 3) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    refine ⟨(p + 504) / 167, 42, 14 * ((p + 3) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · have : p % 4008 = 3337 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have h167div : (p + 504) / 167 * 167 = p + 504 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · set δ := (p + 504) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      set c₀ := (p + 3) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hδ_mul : δ * 167 = p + 504 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hc₀_mul : c₀ * 167 = p + 3 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hδ_int : (↑δ : ℤ) * 167 = ↑p + 504 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hc₀_int : (↑c₀ : ℤ) * 167 = ↑p + 3 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  · by_cases hp167_165 : p % 167 = 165
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · -- p ≡ 165 (mod 167): (α=21, r=1, s=2), M = 4·21·2·1 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      -- offset = (p+336)/167, b = 42, c = 21·(p + 2)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hdiv167a : 167 ∣ (p + 336) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      have hdiv167b : 167 ∣ (p + 2) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      refine ⟨(p + 336) / 167, 42, 21 * ((p + 2) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · have : p % 4008 = 3505 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have h167div : (p + 336) / 167 * 167 = p + 336 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · set δ := (p + 336) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        set c₀ := (p + 2) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hδ_mul : δ * 167 = p + 336 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hc₀_mul : c₀ * 167 = p + 2 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hδ_int : (↑δ : ℤ) * 167 = ↑p + 336 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hc₀_int : (↑c₀ : ℤ) * 167 = ↑p + 2 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    · by_cases hp167_166 : p % 167 = 166
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · -- p ≡ 166 (mod 167): (α=42, r=1, s=1), M = 4·42·1·1 - 1 = 167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        -- offset = (p+168)/167, b = 42, c = 42·(p + 1)/167
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hdiv167a : 167 ∣ (p + 168) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        have hdiv167b : 167 ∣ (p + 1) := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        refine ⟨(p + 168) / 167, 42, 42 * ((p + 1) / 167), ?_, by norm_num, ?_, ?_⟩
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · have : p % 4008 = 3673 := by omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have h167div : (p + 168) / 167 * 167 = p + 168 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          omega
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · exact Nat.mul_pos (by norm_num) (Nat.div_pos (by omega) (by norm_num))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · set δ := (p + 168) / 167 with hδ_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          set c₀ := (p + 1) / 167 with hc₀_def
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hδ_mul : δ * 167 = p + 168 := Nat.div_mul_cancel hdiv167a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hc₀_mul : c₀ * 167 = p + 1 := Nat.div_mul_cancel hdiv167b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hδ_int : (↑δ : ℤ) * 167 = ↑p + 168 := by exact_mod_cast hδ_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          have hc₀_int : (↑c₀ : ℤ) * 167 = ↑p + 1 := by exact_mod_cast hc₀_mul
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          push_cast
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          nlinarith [hδ_int, hc₀_int]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      · sorry