# TASK: Write Lean 4 Code for k=1 Exact Characterization

## Context

For the Erdős-Straus conjecture on Mordell-hard primes:
- k=1 means m₁ = 7
- x₁ = (p + 7) / 4 = r + 1
- For Mordell-hard primes, p ≡ 1, 2, or 4 (mod 7)
- This forces x₁ ≡ 1, 2, or 4 (mod 7) - always a quadratic residue (QR)
- Target -x₁ is always a non-quadratic residue (NQR) mod 7

## Quadratic Residues mod 7

- QR mod 7: {1, 2, 4}
- NQR mod 7: {3, 5, 6}
- -1 ≡ 6 (mod 7) is NQR, so negation swaps QR ↔ NQR

## The Exact Characterization

**Theorem:** For Mordell-hard prime p, k=1 provides a Type II witness if and only if x₁ has a prime factor q that is NQR mod 7 (i.e., q ≡ 3, 5, or 6 mod 7).

**Equivalently:** k=1 fails ⟺ all prime factors of x₁ are QR mod 7 (≡ 1, 2, or 4 mod 7).

**Proof idea:**
- Divisors of x₁² generate residues in the subgroup of (Z/7Z)* generated by prime factors
- QR subgroup has index 2
- To reach NQR target, need at least one NQR prime factor

## Your Task

Write Lean 4 code:

```lean
/-- Quadratic residues mod 7 -/
def QR7 : Finset ℕ := {1, 2, 4}

/-- Non-quadratic residues mod 7 -/
def NQR7 : Finset ℕ := {3, 5, 6}

/-- Product of QRs is QR mod 7 -/
lemma qr7_mul_closed (a b : ℕ) (ha : a % 7 ∈ QR7) (hb : b % 7 ∈ QR7) :
    (a * b) % 7 ∈ QR7 := by
  sorry

/-- All divisors of n² are QR mod 7 if all prime factors of n are QR mod 7 -/
lemma divisors_qr7_of_primes_qr7 (n : ℕ) (hn : 0 < n)
    (h : ∀ p, Nat.Prime p → p ∣ n → p % 7 ∈ QR7) :
    ∀ d, d ∣ n^2 → d % 7 ∈ QR7 ∪ {0} := by
  sorry

/-- If n has an NQR prime factor mod 7, then n² has a divisor that is NQR mod 7 -/
lemma exists_nqr7_divisor (n : ℕ) (hn : 0 < n)
    (h : ∃ p, Nat.Prime p ∧ p ∣ n ∧ p % 7 ∈ NQR7) :
    ∃ d, d ∣ n^2 ∧ d % 7 ∈ NQR7 := by
  sorry

/-- For x₁ ≡ 1, 2, or 4 (mod 7), the target -x₁ is NQR -/
lemma target_is_nqr7 (x : ℕ) (hx : x % 7 ∈ QR7) :
    (7 - x % 7) % 7 ∈ NQR7 := by
  sorry

/-- k=1 witness exists iff x₁ has NQR prime factor mod 7 -/
theorem k1_witness_iff (x₁ : ℕ) (hx : 0 < x₁) (hx_qr : x₁ % 7 ∈ QR7) :
    (∃ d, d ∣ x₁^2 ∧ d ≤ x₁ ∧ (x₁ + d) % 7 = 0) ↔
    (∃ p, Nat.Prime p ∧ p ∣ x₁ ∧ p % 7 ∈ NQR7) := by
  sorry
```

## Imports

```lean
import Mathlib.Data.Nat.Prime.Basic
import Mathlib.Data.Finset.Basic
import Mathlib.NumberTheory.LegendreSymbol.QuadraticReciprocity
import Mathlib.Tactic
```

## Output Format

Provide complete, compilable Lean 4 code with all proofs filled in.
